(setglobal Btype!
  (let
    (TypeSet =
       (module-defn(TypeSet) typing/btype.ml(23):1191-1225
         (apply
           (let (let = (field 0 (global Stdlib__set!)))
             (field 0 (global Stdlib__set!)))
           (let (let = (field 0 (global Types!)))
             (makeblock 0 (field 0 let)))))
     TypeMap =
       (module-defn(TypeMap) typing/btype.ml(24):1226-1261
         (apply
           (let (let = (field 0 (global Stdlib__map!)))
             (field 0 (global Stdlib__map!)))
           (let (let = (field 0 (global Types!)))
             (makeblock 0 (field 0 let)))))
     TypeHash =
       (module-defn(TypeHash) typing/btype.ml(25):1262-1301
         (apply
           (let (let = (field 24 (global Stdlib__hashtbl!)))
             (field 24 (global Stdlib__hashtbl!)))
           (let (let = (field 0 (global Types!)))
             (makeblock 0 (field 1 let) (field 2 let)))))
     print_raw =
       (makemutable 0
         (function param
           (funct-body typing/btype.ml(30):1360-1381
             (before typing/btype.ml(30):1369-1381
               (raise
                 (after typing/btype.ml(30):1369-1381
                   (makeblock 0 (global Assert_failure!)
                     [0: "typing/btype.ml" 30 16])))))))
     generic_level =[int] (field 24 (global Ident!))
     lowest_level =[int] (field 23 (global Ident!))
     pivot_level =[int] (- (* 2 lowest_level) 1)
     new_id = (makemutable 0 (int) -1)
     newty2 =
       (function level[int] desc
         (funct-body typing/btype.ml(45)<ghost>:1742-1822
           (before typing/btype.ml(46):1758-1822
             (seq (+:=1 new_id)
               (before typing/btype.ml(46):1771-1822
                 (makemutable 0 (*,int,int,int) desc level lowest_level
                   (field 0 new_id)))))))
     newgenty =
       (function desc
         (funct-body typing/btype.ml(47)<ghost>:1836-1873
           (before typing/btype.ml(47):1848-1873
             (after typing/btype.ml(47):1848-1873
               (apply newty2 generic_level desc)))))
     newgenvar =
       (function name param
         (funct-body typing/btype.ml(48)<ghost>:1888-1919
           (before typing/btype.ml(48):1899-1919
             (after typing/btype.ml(48):1899-1919
               (apply newgenty (makeblock 0 name))))))
     is_Tvar =
       (function param
         (funct-body typing/btype.ml(59):2179-2222
           (let (*match* =o (field 0 param))
             (catch
               (switch *match*
                case tag 0: (before typing/btype.ml(59):2205-2209 1a)
                default: (exit 1))
              with (1) (before typing/btype.ml(59):2217-2222 0a)))))
     is_Tunivar =
       (function param
         (funct-body typing/btype.ml(60):2240-2286
           (let (*match* =o (field 0 param))
             (catch
               (switch *match*
                case tag 9: (before typing/btype.ml(60):2269-2273 1a)
                default: (exit 2))
              with (2) (before typing/btype.ml(60):2281-2286 0a)))))
     is_Tconstr =
       (function param
         (funct-body typing/btype.ml(61):2304-2350
           (let (*match* =o (field 0 param))
             (catch
               (switch *match*
                case tag 3: (before typing/btype.ml(61):2333-2337 1a)
                default: (exit 3))
              with (3) (before typing/btype.ml(61):2345-2350 0a)))))
     dummy_method = "*dummy method*"
     default_mty =
       (function param
         (funct-body typing/btype.ml(64):2406-2463
           (if param
             (let (mty =a (field 0 param))
               (before typing/btype.ml(65):2431-2434 mty))
             (before typing/btype.ml(66):2447-2463 [1: 0a]))))
     trail =
       (after typing/btype.ml(88):3092-3105
         (apply (field 0 (global Stdlib__weak!)) 1))
     log_change =
       (function ch
         (funct-body typing/btype.ml(90)<ghost>:3122-3274
           (before typing/btype.ml(91):3129-3274
             (let
               (*match* =
                  (after typing/btype.ml(91):3135-3151
                    (apply (field 3 (global Stdlib__weak!)) trail 0)))
               (if *match*
                 (let (r =a (field 0 *match*))
                   (before typing/btype.ml(93):3188-3274
                     (let (r' = (makemutable 0 0a))
                       (before typing/btype.ml(94):3220-3274
                         (seq (setfield_ptr 0 r (makeblock 0 ch r'))
                           (before typing/btype.ml(95):3248-3274
                             (after typing/btype.ml(95):3248-3274
                               (apply (field 2 (global Stdlib__weak!)) trail
                                 0 (makeblock 0 r')))))))))
                 (before typing/btype.ml(91):3165-3167 0a)))))))
    (letrec
      (field_kind_repr
         (function kind
           (funct-body typing/btype.ml(100):3342-3446
             (catch
               (if (isint kind) (exit 4)
                 (let
                   (*match* =a (field 0 kind) *match* =o (field 0 *match*))
                   (if *match*
                     (let (kind =a (field 0 *match*))
                       (before typing/btype.ml(101):3386-3406
                         (after typing/btype.ml(101):3386-3406
                           (apply field_kind_repr kind))))
                     (exit 4))))
              with (4) (before typing/btype.ml(102):3442-3446 kind)))))
      (letrec
        (repr_link
           (function compress t d t'
             (funct-body typing/btype.ml(104)<ghost>:3466-3764
               (let (d' =o (field 0 t'))
                 (catch
                   (switch d'
                    case tag 5:
                     (let (t' =a (field 3 d') k =a (field 1 d') d' =a d')
                       (before typing/btype.ml(108):3593-3620
                         (if
                           (==
                             (after typing/btype.ml(108):3593-3610
                               (apply field_kind_repr k))
                             1a)
                           (before typing/btype.ml(109):3629-3651
                             (after typing/btype.ml(109):3629-3651
                               (apply repr_link 1a t d' t')))
                           (exit 6))))
                    case tag 6:
                     (let (t' =a (field 0 d'))
                       (before typing/btype.ml(107):3526-3548
                         (after typing/btype.ml(107):3526-3548
                           (apply repr_link 1a t d' t'))))
                    default: (exit 6))
                  with (6)
                   (before typing/btype.ml(111):3666-3764
                     (seq
                       (if compress
                         (before typing/btype.ml(111):3683-3755
                           (seq
                             (after typing/btype.ml(112):3696-3733
                               (apply log_change
                                 (makeblock 1 t (field 0 t) d)))
                             (before typing/btype.ml(112):3735-3746
                               (setfield_ptr 0 t d))))
                         0a)
                       (before typing/btype.ml(114):3762-3764 t'))))))))
        (let
          (repr =
             (function t
               (funct-body typing/btype.ml(116)<ghost>:3775-3949
                 (before typing/btype.ml(117):3781-3949
                   (let (d = (field 0 t))
                     (catch
                       (switch d
                        case tag 5:
                         (let (d =a d t' =a (field 3 d) k =a (field 1 d))
                           (before typing/btype.ml(120):3881-3908
                             (if
                               (==
                                 (after typing/btype.ml(120):3881-3898
                                   (apply field_kind_repr k))
                                 1a)
                               (before typing/btype.ml(121):3917-3939
                                 (after typing/btype.ml(121):3917-3939
                                   (apply repr_link 0a t d t')))
                               (exit 7))))
                        case tag 6:
                         (let (t' =a (field 0 d))
                           (before typing/btype.ml(119):3824-3846
                             (after typing/btype.ml(119):3824-3846
                               (apply repr_link 0a t d t'))))
                        default: (exit 7))
                      with (7) (before typing/btype.ml(122):3948-3949 t)))))))
          (letrec
            (commu_repr
               (function c
                 (funct-body typing/btype.ml(124):3972-4040
                   (catch
                     (if (isint c) (exit 8)
                       (let (r =a (field 0 c))
                         (before typing/btype.ml(125):3998-4012
                           (if (!= (field 0 r) 1a)
                             (before typing/btype.ml(125):4016-4029
                               (after typing/btype.ml(125):4016-4029
                                 (apply commu_repr (field 0 r))))
                             (exit 8)))))
                    with (8) (before typing/btype.ml(126):4039-4040 c)))))
            (letrec
              (row_field_repr_aux
                 (function tl fi
                   (funct-body typing/btype.ml(128)<ghost>:4069-4314
                     (catch
                       (switch* fi
                        case int 0: (exit 9)
                        case tag 0:
                         (let (*match* =a (field 0 fi))
                           (if *match*
                             (before typing/btype.ml(133):4255-4263
                               (if (!= tl 0a)
                                 (before typing/btype.ml(134):4273-4301
                                   (makeblock 0
                                     (makeblock 0
                                       (after typing/btype.ml(134):4288-4300
                                         (apply
                                           (field 4 (global Stdlib__list!))
                                           tl)))))
                                 (exit 9)))
                             (exit 9)))
                        case tag 1:
                         (let
                           (r =a (field 3 fi)
                            m =a (field 2 fi)
                            tl' =a (field 1 fi)
                            c =a (field 0 fi)
                            *match* =o (field 0 r))
                           (if *match*
                             (let (fi =a (field 0 *match*))
                               (before typing/btype.ml(130):4137-4167
                                 (after typing/btype.ml(130):4137-4167
                                   (apply row_field_repr_aux
                                     (after typing/btype.ml(130):4156-4164
                                       (apply (field 36 (global Stdlib!)) tl
                                         tl'))
                                     fi))))
                             (let (tl' =a tl')
                               (before typing/btype.ml(132):4203-4227
                                 (makeblock 1 c
                                   (after typing/btype.ml(132):4214-4220
                                     (apply (field 36 (global Stdlib!)) tl
                                       tl'))
                                   m r))))))
                      with (9) (before typing/btype.ml(135):4312-4314 fi)))))
              (let
                (row_field_repr =
                   (function fi
                     (funct-body typing/btype.ml(137)<ghost>:4335-4364
                       (before typing/btype.ml(137):4340-4364
                         (after typing/btype.ml(137):4340-4364
                           (apply row_field_repr_aux 0a fi))))))
                (letrec
                  (rev_concat
                     (function l ll
                       (funct-body typing/btype.ml(139)<ghost>:4385-4454
                         (before typing/btype.ml(140):4394-4454
                           (if ll
                             (let (ll =a (field 1 ll) l' =a (field 0 ll))
                               (before typing/btype.ml(142):4434-4454
                                 (after typing/btype.ml(142):4434-4454
                                   (apply rev_concat
                                     (after typing/btype.ml(142):4445-4451
                                       (apply (field 36 (global Stdlib!)) l'
                                         l))
                                     ll))))
                             (before typing/btype.ml(141):4418-4419 l))))))
                  (letrec
                    (row_repr_aux
                       (function ll row
                         (funct-body typing/btype.ml(144)<ghost>:4477-4730
                           (before typing/btype.ml(145):4488-4730
                             (let
                               (*match* =
                                  (field 0
                                    (after typing/btype.ml(145):4494-4513
                                      (apply repr (field 1 row)))))
                               (catch
                                 (switch *match*
                                  case tag 8:
                                   (let (row' =a (field 0 *match*))
                                     (before typing/btype.ml(147):4551-4631
                                       (let (f = (field 0 row))
                                         (before typing/btype.ml(148):4583-4631
                                           (after typing/btype.ml(148):4583-4631
                                             (apply row_repr_aux
                                               (if (== f 0a)
                                                 (before typing/btype.ml(148):4612-4614
                                                   ll)
                                                 (before typing/btype.ml(148):4620-4625
                                                   (makeblock 0 f ll)))
                                               row'))))))
                                  default: (exit 11))
                                with (11)
                                 (before typing/btype.ml(150):4647-4730
                                   (if (== ll 0a)
                                     (before typing/btype.ml(150):4663-4666
                                       row)
                                     (before typing/btype.ml(151):4678-4730
                                       (let (init = row)
                                         (makeblock 0
                                           (after typing/btype.ml(151):4701-4729
                                             (apply rev_concat (field 0 row)
                                               ll))
                                           (field 1 init) (field 2 init)
                                           (field 3 init) (field 4 init)
                                           (field 5 init))))))))))))
                    (let
                      (row_repr =
                         (function row
                           (funct-body typing/btype.ml(153)<ghost>:4745-4770
                             (before typing/btype.ml(153):4751-4770
                               (after typing/btype.ml(153):4751-4770
                                 (apply row_repr_aux 0a row))))))
                      (letrec
                        (row_field
                           (function tag row
                             (funct-body typing/btype.ml(155)<ghost>:4790-5064
                               (before typing/btype.ml(156):4802-5064
                                 (letrec
                                   (find
                                      (function param
                                        (funct-body typing/btype.ml(156):4817-5039
                                          (if param
                                            (let
                                              (fields =a (field 1 param)
                                               *match* =a (field 0 param)
                                               f =a (field 1 *match*)
                                               tag' =a (field 0 *match*))
                                              (before typing/btype.ml(158):4862-4914
                                                (if
                                                  (after typing/btype.ml(158):4865-4875
                                                    (caml_string_equal tag
                                                      tag'))
                                                  (before typing/btype.ml(158):4881-4897
                                                    (after typing/btype.ml(158):4881-4897
                                                      (apply row_field_repr
                                                        f)))
                                                  (before typing/btype.ml(158):4903-4914
                                                    (after typing/btype.ml(158):4903-4914
                                                      (apply find fields))))))
                                            (before typing/btype.ml(160):4935-5039
                                              (let
                                                (*match* =
                                                   (after typing/btype.ml(160):4941-4958
                                                     (apply repr
                                                       (field 1 row)))
                                                 *match* =o (field 0 *match*))
                                                (catch
                                                  (switch *match*
                                                   case tag 8:
                                                    (let
                                                      (row' =a
                                                         (field 0 *match*))
                                                      (before typing/btype.ml(161):4998-5016
                                                        (after typing/btype.ml(161):4998-5016
                                                          (apply row_field
                                                            tag row'))))
                                                   default: (exit 12))
                                                 with (12)
                                                  (before typing/btype.ml(162):5032-5039
                                                    0a))))))))
                                   (before typing/btype.ml(163):5045-5064
                                     (after typing/btype.ml(163):5045-5064
                                       (apply find (field 0 row)))))))))
                        (letrec
                          (row_more
                             (function row
                               (funct-body typing/btype.ml(165)<ghost>:5083-5174
                                 (before typing/btype.ml(166):5091-5174
                                   (let
                                     (ty =
                                        (after typing/btype.ml(166):5097-5114
                                          (apply repr (field 1 row)))
                                      *match* =o (field 0 ty))
                                     (catch
                                       (switch *match*
                                        case tag 8:
                                         (let (row' =a (field 0 *match*))
                                           (before typing/btype.ml(167):5148-5161
                                             (after typing/btype.ml(167):5148-5161
                                               (apply row_more row'))))
                                        default: (exit 13))
                                      with (13)
                                       (before typing/btype.ml(168):5172-5174
                                         ty)))))))
                          (let
                            (row_fixed =
                               (function row
                                 (funct-body typing/btype.ml(170)<ghost>:5190-5363
                                   (before typing/btype.ml(171):5198-5363
                                     (let
                                       (row =
                                          (after typing/btype.ml(171):5208-5220
                                            (apply row_repr row)))
                                       (before typing/btype.ml(172):5226-5363
                                         (|| (field 4 row)
                                           (let
                                             (*match* =
                                                (field 0
                                                  (after typing/btype.ml(173):5251-5270
                                                    (apply repr
                                                      (field 1 row)))))
                                             (catch
                                               (catch
                                                 (switch *match*
                                                  case int 0: (exit 14)
                                                  case tag 0: (exit 14)
                                                  case tag 3: (exit 15)
                                                  case tag 9: (exit 15)
                                                  default:
                                                   (before typing/btype.ml(176):5351-5363
                                                     (raise
                                                       (after typing/btype.ml(176):5351-5363
                                                         (makeblock 0
                                                           (global Assert_failure!)
                                                           [0:
                                                            "typing/btype.ml"
                                                            176 9])))))
                                                with (14)
                                                 (before typing/btype.ml(174):5302-5307
                                                   0a))
                                              with (15)
                                               (before typing/btype.ml(175):5337-5341
                                                 1a)))))))))
                             static_row =
                               (function row
                                 (funct-body typing/btype.ml(178)<ghost>:5380-5545
                                   (before typing/btype.ml(179):5388-5545
                                     (let
                                       (row =
                                          (after typing/btype.ml(179):5398-5410
                                            (apply row_repr row)))
                                       (before typing/btype.ml(180):5416-5545
                                         (&& (field 3 row)
                                           (after typing/btype.ml(181):5436-5545
                                             (apply
                                               (field 27
                                                 (global Stdlib__list!))
                                               (function param
                                                 (funct-body typing/btype.ml(182):5453-5526
                                                   (let
                                                     (f =a (field 1 param))
                                                     (before typing/btype.ml(182):5467-5525
                                                       (let
                                                         (*match* =
                                                            (after typing/btype.ml(182):5473-5489
                                                              (apply
                                                                row_field_repr
                                                                f)))
                                                         (catch
                                                           (switch* *match*
                                                            case int 0:
                                                             (exit 17)
                                                            case tag 0:
                                                             (exit 17)
                                                            case tag 1:
                                                             (before typing/btype.ml(182):5508-5513
                                                               0a))
                                                          with (17)
                                                           (before typing/btype.ml(182):5521-5525
                                                             1a)))))))
                                               (field 0 row)))))))))
                             hash_variant =
                               (function s : int
                                 (funct-body typing/btype.ml(185)<ghost>:5564-5848
                                   (before typing/btype.ml(186):5570-5848
                                     (let (accu = (makemutable 0 (int) 0))
                                       (before typing/btype.ml(187):5592-5848
                                         (seq
                                           (for i 0 to
                                             (- (string.length s) 1)
                                             (before typing/btype.ml(188):5632-5669
                                               (setfield_imm 0 accu
                                                 (+ (* 223 (field 0 accu))
                                                   (after typing/btype.ml(188):5664-5669
                                                     (string.get s i))))))
                                           (before typing/btype.ml(191):5706-5848
                                             (seq
                                               (setfield_imm 0 accu
                                                 (and (field 0 accu)
                                                   (- (lsl 1 31) 1)))
                                               (before typing/btype.ml(193):5792-5848
                                                 (if
                                                   (> (field 0 accu)
                                                     1073741823)
                                                   (before typing/btype.ml(193):5819-5837
                                                     (- (field 0 accu)
                                                       (lsl 1 31)))
                                                   (before typing/btype.ml(193):5843-5848
                                                     (field 0 accu))))))))))))
                             proxy =
                               (function ty
                                 (funct-body typing/btype.ml(195)<ghost>:5860-6243
                                   (before typing/btype.ml(196):5867-6243
                                     (let
                                       (ty0 =
                                          (after typing/btype.ml(196):5877-5884
                                            (apply repr ty)))
                                       (before typing/btype.ml(197):5890-6243
                                         (let (*match* = (field 0 ty0))
                                           (catch
                                             (switch *match*
                                              case tag 4:
                                               (let (ty =a (field 0 *match*))
                                                 (before typing/btype.ml(201):6004-6230
                                                   (letrec
                                                     (proxy_obj
                                                        (function ty
                                                          (funct-body typing/btype.ml(201)<ghost>:6022-6208
                                                            (before typing/btype.ml(202):6035-6208
                                                              (let
                                                                (*match* =
                                                                   (field 0
                                                                    ty))
                                                                (catch
                                                                  (catch
                                                                    (switch *match*
                                                                    case int 0:
                                                                    (before typing/btype.ml(205):6177-6180
                                                                    ty0)
                                                                    case tag 0:
                                                                    (exit 19)
                                                                    case tag 3:
                                                                    (exit 19)
                                                                    case tag 5:
                                                                    (let
                                                                    (ty =a
                                                                    (field 3
                                                                    *match*))
                                                                    (exit 18
                                                                    ty))
                                                                    case tag 6:
                                                                    (let
                                                                    (ty =a
                                                                    (field 0
                                                                    *match*))
                                                                    (exit 18
                                                                    ty))
                                                                    case tag 9:
                                                                    (exit 19)
                                                                    default:
                                                                    (before typing/btype.ml(206):6196-6208
                                                                    (raise
                                                                    (after typing/btype.ml(206):6196-6208
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/btype.ml"
                                                                    206 15])))))
                                                                   with (18 ty)
                                                                    (before typing/btype.ml(203):6099-6111
                                                                    (after typing/btype.ml(203):6099-6111
                                                                    (apply
                                                                    proxy_obj
                                                                    ty))))
                                                                 with (19)
                                                                  (before typing/btype.ml(204):6156-6158
                                                                    ty)))))))
                                                     (before typing/btype.ml(207):6218-6230
                                                       (after typing/btype.ml(207):6218-6230
                                                         (apply proxy_obj ty))))))
                                              case tag 8:
                                               (let
                                                 (row =a (field 0 *match*))
                                                 (before typing/btype.ml(198):5932-5952
                                                   (if
                                                     (not
                                                       (after typing/btype.ml(198):5936-5952
                                                         (apply static_row
                                                           row)))
                                                     (before typing/btype.ml(199):5962-5974
                                                       (after typing/btype.ml(199):5962-5974
                                                         (apply row_more row)))
                                                     (exit 21))))
                                              default: (exit 21))
                                            with (21)
                                             (before typing/btype.ml(208):6240-6243
                                               ty0))))))))
                             row_of_type =
                               (function t
                                 (funct-body typing/btype.ml(212)<ghost>:6312-6571
                                   (before typing/btype.ml(213):6318-6571
                                     (let
                                       (*match* =
                                          (field 0
                                            (after typing/btype.ml(213):6324-6332
                                              (apply repr t))))
                                       (catch
                                         (switch *match*
                                          case tag 4:
                                           (let (t =a (field 0 *match*))
                                             (before typing/btype.ml(215):6369-6515
                                               (letrec
                                                 (get_row
                                                    (function t
                                                      (funct-body typing/btype.ml(215)<ghost>:6385-6496
                                                        (before typing/btype.ml(216):6397-6496
                                                          (let
                                                            (t =
                                                               (after typing/btype.ml(216):6405-6411
                                                                 (apply repr
                                                                   t)))
                                                            (before typing/btype.ml(217):6423-6496
                                                              (let
                                                                (*match* =
                                                                   (field 0
                                                                    t))
                                                                (catch
                                                                  (switch *match*
                                                                   case tag 5:
                                                                    (let
                                                                    (t =a
                                                                    (field 3
                                                                    *match*))
                                                                    (before typing/btype.ml(218):6470-6479
                                                                    (after typing/btype.ml(218):6470-6479
                                                                    (apply
                                                                    get_row
                                                                    t))))
                                                                   default:
                                                                    (exit 22))
                                                                 with (22)
                                                                  (before typing/btype.ml(219):6495-6496
                                                                    t)))))))))
                                                 (before typing/btype.ml(220):6506-6515
                                                   (after typing/btype.ml(220):6506-6515
                                                     (apply get_row t))))))
                                          case tag 8:
                                           (let (row =a (field 0 *match*))
                                             (before typing/btype.ml(222):6542-6554
                                               (after typing/btype.ml(222):6542-6554
                                                 (apply row_more row))))
                                          default: (exit 23))
                                        with (23)
                                         (before typing/btype.ml(224):6570-6571
                                           t))))))
                             has_constr_row =
                               (function t
                                 (funct-body typing/btype.ml(226)<ghost>:6592-6646
                                   (before typing/btype.ml(227):6598-6646
                                     (&&
                                       (not
                                         (after typing/btype.ml(227):6602-6616
                                           (apply is_Tconstr t)))
                                       (after typing/btype.ml(227):6620-6646
                                         (apply is_Tconstr
                                           (after typing/btype.ml(227):6631-6646
                                             (apply row_of_type t))))))))
                             is_row_name =
                               (function s
                                 (funct-body typing/btype.ml(229)<ghost>:6664-6753
                                   (before typing/btype.ml(230):6670-6753
                                     (let (l =[int] (string.length s))
                                       (before typing/btype.ml(231):6699-6753
                                         (if (< l 4)
                                           (before typing/btype.ml(231):6713-6718
                                             0a)
                                           (before typing/btype.ml(231):6724-6753
                                             (after typing/btype.ml(231):6724-6753
                                               (caml_string_equal
                                                 (after typing/btype.ml(231):6724-6744
                                                   (apply
                                                     (field 3
                                                       (global Stdlib__string!))
                                                     s (- l 4) 4))
                                                 "#row")))))))))
                             is_constr_row =
                               (function allow_ident t
                                 (funct-body typing/btype.ml(233)<ghost>:6773-6967
                                   (before typing/btype.ml(234):6792-6967
                                     (let (*match* = (field 0 t))
                                       (catch
                                         (switch *match*
                                          case tag 3:
                                           (let
                                             (*match* =a (field 0 *match*))
                                             (switch* *match*
                                              case tag 0:
                                               (let (id =a (field 0 *match*))
                                                 (before typing/btype.ml(235):6850-6861
                                                   (if allow_ident
                                                     (before typing/btype.ml(236):6871-6898
                                                       (after typing/btype.ml(236):6871-6898
                                                         (apply is_row_name
                                                           (after typing/btype.ml(236):6883-6898
                                                             (apply
                                                               (field 14
                                                                 (global Ident!))
                                                               id)))))
                                                     (exit 24))))
                                              case tag 1:
                                               (let (s =a (field 1 *match*))
                                                 (before typing/btype.ml(237):6939-6952
                                                   (after typing/btype.ml(237):6939-6952
                                                     (apply is_row_name s))))
                                              case tag 2: (exit 24)))
                                          default: (exit 24))
                                        with (24)
                                         (before typing/btype.ml(238):6962-6967
                                           0a)))))))
                            (letrec
                              (fold_row
                                 (function f init row
                                   (funct-body typing/btype.ml(245)<ghost>:7153-7736
                                     (before typing/btype.ml(246):7168-7736
                                       (let
                                         (result =
                                            (after typing/btype.ml(247):7185-7420
                                              (apply
                                                (field 20
                                                  (global Stdlib__list!))
                                                (function init param
                                                  (funct-body typing/btype.ml(248):7206-7388
                                                    (let
                                                      (fi =a (field 1 param))
                                                      (before typing/btype.ml(249):7236-7387
                                                        (let
                                                          (*match* =
                                                             (after typing/btype.ml(249):7242-7259
                                                               (apply
                                                                 row_field_repr
                                                                 fi)))
                                                          (catch
                                                            (switch* *match*
                                                             case int 0:
                                                              (exit 27)
                                                             case tag 0:
                                                              (let
                                                                (*match* =a
                                                                   (field 0
                                                                    *match*))
                                                                (if *match*
                                                                  (let
                                                                    (ty =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/btype.ml(250):7297-7306
                                                                    (after typing/btype.ml(250):7297-7306
                                                                    (apply f
                                                                    init ty))))
                                                                  (exit 27)))
                                                             case tag 1:
                                                              (let
                                                                (tl =a
                                                                   (field 1
                                                                    *match*))
                                                                (before typing/btype.ml(251):7342-7366
                                                                  (after typing/btype.ml(251):7342-7366
                                                                    (apply
                                                                    (field 20
                                                                    (global Stdlib__list!))
                                                                    f init
                                                                    tl)))))
                                                           with (27)
                                                            (before typing/btype.ml(252):7383-7387
                                                              init)))))))
                                                init (field 0 row))))
                                         (before typing/btype.ml(256):7428-7736
                                           (let
                                             (*match* =
                                                (field 0
                                                  (after typing/btype.ml(256):7434-7453
                                                    (apply repr
                                                      (field 1 row)))))
                                             (catch
                                               (switch *match*
                                                case int 0: (exit 25)
                                                case tag 0: (exit 25)
                                                case tag 3: (exit 25)
                                                case tag 7: (exit 25)
                                                case tag 8:
                                                 (let
                                                   (row =a (field 0 *match*))
                                                   (before typing/btype.ml(257):7484-7505
                                                     (after typing/btype.ml(257):7484-7505
                                                       (apply fold_row f
                                                         result row))))
                                                case tag 9: (exit 25)
                                                default:
                                                 (before typing/btype.ml(265):7724-7736
                                                   (raise
                                                     (after typing/btype.ml(265):7724-7736
                                                       (makeblock 0
                                                         (global Assert_failure!)
                                                         [0:
                                                          "typing/btype.ml"
                                                          265 9])))))
                                              with (25)
                                               (before typing/btype.ml(259):7566-7714
                                                 (let
                                                   (*match* =
                                                      (after typing/btype.ml(260):7584-7648
                                                        (apply
                                                          (field 6
                                                            (global Stdlib__option!))
                                                          (function param
                                                            (funct-body typing/btype.ml(260):7595-7635
                                                              (let
                                                                (l =a
                                                                   (field 1
                                                                    param))
                                                                (before typing/btype.ml(260):7609-7634
                                                                  (after typing/btype.ml(260):7609-7634
                                                                    (apply
                                                                    (field 20
                                                                    (global Stdlib__list!))
                                                                    f result
                                                                    l))))))
                                                          (field 5 row))))
                                                   (if *match*
                                                     (let
                                                       (result =a
                                                          (field 0 *match*))
                                                       (before typing/btype.ml(263):7700-7706
                                                         result))
                                                     (before typing/btype.ml(262):7672-7678
                                                       result))))))))))))
                              (let
                                (iter_row =
                                   (function f row
                                     (funct-body typing/btype.ml(267)<ghost>:7751-7794
                                       (before typing/btype.ml(268):7761-7794
                                         (after typing/btype.ml(268):7761-7794
                                           (apply fold_row
                                             (function param v
                                               (funct-body typing/btype.ml(268):7770-7787
                                                 (before typing/btype.ml(268):7783-7786
                                                   (after typing/btype.ml(268):7783-7786
                                                     (apply f v)))))
                                             0a row)))))
                                 fold_type_expr =
                                   (function f init ty
                                     (funct-body typing/btype.ml(270)<ghost>:7815-8658
                                       (before typing/btype.ml(271):7829-8658
                                         (let (*match* = (field 0 ty))
                                           (switch* *match*
                                            case int 0:
                                             (before typing/btype.ml(289):8408-8412
                                               init)
                                            case tag 0:
                                             (before typing/btype.ml(272):7875-7879
                                               init)
                                            case tag 1:
                                             (let
                                               (ty2 =a (field 2 *match*)
                                                ty1 =a (field 1 *match*))
                                               (before typing/btype.ml(274):7915-7958
                                                 (let
                                                   (result =
                                                      (after typing/btype.ml(274):7928-7938
                                                        (apply f init ty1)))
                                                   (before typing/btype.ml(275):7946-7958
                                                     (after typing/btype.ml(275):7946-7958
                                                       (apply f result ty2))))))
                                            case tag 2:
                                             (let (l =a (field 0 *match*))
                                               (before typing/btype.ml(276):7986-8009
                                                 (after typing/btype.ml(276):7986-8009
                                                   (apply
                                                     (field 20
                                                       (global Stdlib__list!))
                                                     f init l))))
                                            case tag 3:
                                             (let (l =a (field 1 *match*))
                                               (before typing/btype.ml(277):8037-8060
                                                 (after typing/btype.ml(277):8037-8060
                                                   (apply
                                                     (field 20
                                                       (global Stdlib__list!))
                                                     f init l))))
                                            case tag 4:
                                             (let
                                               (*match* =a (field 1 *match*)
                                                ty =a (field 0 *match*)
                                                *match* =o (field 0 *match*))
                                               (if *match*
                                                 (let
                                                   (*match* =a
                                                      (field 0 *match*)
                                                    p =a (field 1 *match*))
                                                   (before typing/btype.ml(280):8114-8169
                                                     (let
                                                       (result =
                                                          (after typing/btype.ml(280):8127-8136
                                                            (apply f init ty)))
                                                       (before typing/btype.ml(281):8144-8169
                                                         (after typing/btype.ml(281):8144-8169
                                                           (apply
                                                             (field 20
                                                               (global Stdlib__list!))
                                                             f result p))))))
                                                 (let (ty =a ty)
                                                   (before typing/btype.ml(282):8197-8206
                                                     (after typing/btype.ml(282):8197-8206
                                                       (apply f init ty))))))
                                            case tag 5:
                                             (let
                                               (ty2 =a (field 3 *match*)
                                                ty1 =a (field 2 *match*))
                                               (before typing/btype.ml(287):8337-8380
                                                 (let
                                                   (result =
                                                      (after typing/btype.ml(287):8350-8360
                                                        (apply f init ty1)))
                                                   (before typing/btype.ml(288):8368-8380
                                                     (after typing/btype.ml(288):8368-8380
                                                       (apply f result ty2))))))
                                            case tag 6:
                                             (let (ty =a (field 0 *match*))
                                               (before typing/btype.ml(290):8440-8449
                                                 (after typing/btype.ml(290):8440-8449
                                                   (apply f init ty))))
                                            case tag 7:
                                             (let (ty =a (field 0 *match*))
                                               (before typing/btype.ml(291):8477-8486
                                                 (after typing/btype.ml(291):8477-8486
                                                   (apply f init ty))))
                                            case tag 8:
                                             (let (row =a (field 0 *match*))
                                               (before typing/btype.ml(284):8238-8301
                                                 (let
                                                   (result =
                                                      (after typing/btype.ml(284):8251-8270
                                                        (apply fold_row f
                                                          init row)))
                                                   (before typing/btype.ml(285):8278-8301
                                                     (after typing/btype.ml(285):8278-8301
                                                       (apply f result
                                                         (after typing/btype.ml(285):8287-8301
                                                           (apply row_more
                                                             row))))))))
                                            case tag 9:
                                             (before typing/btype.ml(292):8514-8518
                                               init)
                                            case tag 10:
                                             (let
                                               (tyl =a (field 1 *match*)
                                                ty =a (field 0 *match*))
                                               (before typing/btype.ml(294):8550-8607
                                                 (let
                                                   (result =
                                                      (after typing/btype.ml(294):8563-8572
                                                        (apply f init ty)))
                                                   (before typing/btype.ml(295):8580-8607
                                                     (after typing/btype.ml(295):8580-8607
                                                       (apply
                                                         (field 20
                                                           (global Stdlib__list!))
                                                         f result tyl))))))
                                            case tag 11:
                                             (let (l =a (field 2 *match*))
                                               (before typing/btype.ml(296):8635-8658
                                                 (after typing/btype.ml(296):8635-8658
                                                   (apply
                                                     (field 20
                                                       (global Stdlib__list!))
                                                     f init l)))))))))
                                 iter_type_expr =
                                   (function f ty
                                     (funct-body typing/btype.ml(298)<ghost>:8679-8726
                                       (before typing/btype.ml(299):8688-8726
                                         (after typing/btype.ml(299):8688-8726
                                           (apply fold_type_expr
                                             (function param v
                                               (funct-body typing/btype.ml(299):8703-8720
                                                 (before typing/btype.ml(299):8716-8719
                                                   (after typing/btype.ml(299):8716-8719
                                                     (apply f v)))))
                                             0a ty))))))
                                (letrec
                                  (iter_abbrev
                                     (function f param
                                       (funct-body typing/btype.ml(301)<ghost>:8748-8906
                                         (switch* param
                                          case int 0:
                                           (before typing/btype.ml(302):8791-8793
                                             0a)
                                          case tag 0:
                                           (let
                                             (rem =a (field 4 param)
                                              ty' =a (field 3 param)
                                              ty =a (field 2 param))
                                             (before typing/btype.ml(303):8827-8857
                                               (seq
                                                 (after typing/btype.ml(303):8827-8831
                                                   (apply f ty))
                                                 (before typing/btype.ml(303):8833-8857
                                                   (seq
                                                     (after typing/btype.ml(303):8833-8838
                                                       (apply f ty'))
                                                     (before typing/btype.ml(303):8840-8857
                                                       (after typing/btype.ml(303):8840-8857
                                                         (apply iter_abbrev f
                                                           rem))))))))
                                          case tag 1:
                                           (let (rem =a (field 0 param))
                                             (before typing/btype.ml(304):8888-8906
                                               (after typing/btype.ml(304):8888-8906
                                                 (apply iter_abbrev f
                                                   (field 0 rem)))))))))
                                  (let
                                    (iter_type_expr_cstr_args =
                                       (function f param
                                         (funct-body typing/btype.ml(323)<ghost>:9914-10024
                                           (switch* param
                                            case tag 0:
                                             (let (tl =a (field 0 param))
                                               (before typing/btype.ml(324):9948-9962
                                                 (after typing/btype.ml(324):9948-9962
                                                   (apply
                                                     (field 14
                                                       (global Stdlib__list!))
                                                     f tl))))
                                            case tag 1:
                                             (let (lbls =a (field 0 param))
                                               (before typing/btype.ml(325):9987-10024
                                                 (after typing/btype.ml(325):9987-10024
                                                   (apply
                                                     (field 14
                                                       (global Stdlib__list!))
                                                     (function d
                                                       (funct-body typing/btype.ml(325):9997-10019
                                                         (before typing/btype.ml(325):10007-10018
                                                           (after typing/btype.ml(325):10007-10018
                                                             (apply f
                                                               (field 2 d))))))
                                                     lbls)))))))
                                     map_type_expr_cstr_args =
                                       (function f param
                                         (funct-body typing/btype.ml(327)<ghost>:10054-10212
                                           (switch* param
                                            case tag 0:
                                             (let (tl =a (field 0 param))
                                               (before typing/btype.ml(328):10088-10114
                                                 (makeblock 0
                                                   (after typing/btype.ml(328):10099-10114
                                                     (apply
                                                       (field 16
                                                         (global Stdlib__list!))
                                                       f tl)))))
                                            case tag 1:
                                             (let (lbls =a (field 0 param))
                                               (before typing/btype.ml(330):10145-10212
                                                 (makeblock 1
                                                   (after typing/btype.ml(330):10157-10212
                                                     (apply
                                                       (field 16
                                                         (global Stdlib__list!))
                                                       (function d
                                                         (funct-body typing/btype.ml(330):10167-10206
                                                           (before typing/btype.ml(330):10177-10205
                                                             (let (init = d)
                                                               (makeblock 0
                                                                 (field 0
                                                                   init)
                                                                 (field 1
                                                                   init)
                                                                 (after typing/btype.ml(330):10193-10204
                                                                   (apply f
                                                                    (field 2
                                                                    d)))
                                                                 (field 3
                                                                   init)
                                                                 (field 4
                                                                   init))))))
                                                       lbls))))))))
                                     iter_type_expr_kind =
                                       (function f param
                                         (funct-body typing/btype.ml(332)<ghost>:10238-10542
                                           (switch* param
                                            case int 0:
                                             (before typing/btype.ml(333):10272-10274
                                               0a)
                                            case int 1:
                                             (before typing/btype.ml(344):10540-10542
                                               0a)
                                            case tag 0:
                                             (let (lbls =a (field 0 param))
                                               (before typing/btype.ml(342):10479-10516
                                                 (after typing/btype.ml(342):10479-10516
                                                   (apply
                                                     (field 14
                                                       (global Stdlib__list!))
                                                     (function d
                                                       (funct-body typing/btype.ml(342):10489-10511
                                                         (before typing/btype.ml(342):10499-10510
                                                           (after typing/btype.ml(342):10499-10510
                                                             (apply f
                                                               (field 2 d))))))
                                                     lbls))))
                                            case tag 1:
                                             (let (cstrs =a (field 0 param))
                                               (before typing/btype.ml(335):10307-10444
                                                 (after typing/btype.ml(335):10307-10444
                                                   (apply
                                                     (field 14
                                                       (global Stdlib__list!))
                                                     (function cd
                                                       (funct-body typing/btype.ml(336):10325-10430
                                                         (before typing/btype.ml(337):10347-10420
                                                           (seq
                                                             (after typing/btype.ml(337):10347-10384
                                                               (apply
                                                                 iter_type_expr_cstr_args
                                                                 f
                                                                 (field 1 cd)))
                                                             (before typing/btype.ml(338):10397-10420
                                                               (after typing/btype.ml(338):10397-10420
                                                                 (apply
                                                                   (field 8
                                                                    (global Stdlib__option!))
                                                                   f
                                                                   (field 2
                                                                    cd))))))))
                                                     cstrs)))))))
                                     type_iterators =
                                       (let
                                         (it_signature =
                                            (function it
                                              (funct-body typing/btype.ml(348)<ghost>:10585-10629
                                                (before typing/btype.ml(349):10594-10629
                                                  (after typing/btype.ml(349):10594-10629
                                                    (apply
                                                      (field 14
                                                        (global Stdlib__list!))
                                                      (after typing/btype.ml(349):10604-10629
                                                        (apply (field 1 it)
                                                          it)))))))
                                          it_signature_item =
                                            (function it param
                                              (funct-body typing/btype.ml(350)<ghost>:10654-11163
                                                (switch* param
                                                 case tag 0:
                                                  (let
                                                    (vd =a (field 1 param))
                                                    (before typing/btype.ml(351):10707-10736
                                                      (after typing/btype.ml(351):10707-10736
                                                        (apply (field 2 it)
                                                          it vd))))
                                                 case tag 1:
                                                  (let
                                                    (td =a (field 1 param))
                                                    (before typing/btype.ml(352):10776-10804
                                                      (after typing/btype.ml(352):10776-10804
                                                        (apply (field 3 it)
                                                          it td))))
                                                 case tag 2:
                                                  (let
                                                    (td =a (field 1 param))
                                                    (before typing/btype.ml(353):10844-10877
                                                      (after typing/btype.ml(353):10844-10877
                                                        (apply (field 4 it)
                                                          it td))))
                                                 case tag 3:
                                                  (let
                                                    (md =a (field 2 param))
                                                    (before typing/btype.ml(354):10917-10947
                                                      (after typing/btype.ml(354):10917-10947
                                                        (apply (field 5 it)
                                                          it md))))
                                                 case tag 4:
                                                  (let
                                                    (mtd =a (field 1 param))
                                                    (before typing/btype.ml(355):10987-11019
                                                      (after typing/btype.ml(355):10987-11019
                                                        (apply (field 6 it)
                                                          it mtd))))
                                                 case tag 5:
                                                  (let
                                                    (cd =a (field 1 param))
                                                    (before typing/btype.ml(356):11059-11088
                                                      (after typing/btype.ml(356):11059-11088
                                                        (apply (field 7 it)
                                                          it cd))))
                                                 case tag 6:
                                                  (let
                                                    (ctd =a (field 1 param))
                                                    (before typing/btype.ml(357):11128-11163
                                                      (after typing/btype.ml(357):11128-11163
                                                        (apply (field 8 it)
                                                          it ctd)))))))
                                          it_value_description =
                                            (function it vd
                                              (funct-body typing/btype.ml(358)<ghost>:11191-11233
                                                (before typing/btype.ml(359):11203-11233
                                                  (after typing/btype.ml(359):11203-11233
                                                    (apply (field 13 it) it
                                                      (field 0 vd))))))
                                          it_type_declaration =
                                            (function it td
                                              (funct-body typing/btype.ml(360)<ghost>:11260-11409
                                                (before typing/btype.ml(361):11272-11409
                                                  (seq
                                                    (after typing/btype.ml(361):11272-11317
                                                      (apply
                                                        (field 14
                                                          (global Stdlib__list!))
                                                        (after typing/btype.ml(361):11282-11302
                                                          (apply
                                                            (field 13 it) it))
                                                        (field 0 td)))
                                                    (before typing/btype.ml(362):11323-11409
                                                      (seq
                                                        (after typing/btype.ml(362):11323-11372
                                                          (apply
                                                            (field 8
                                                              (global Stdlib__option!))
                                                            (after typing/btype.ml(362):11335-11355
                                                              (apply
                                                                (field 13 it)
                                                                it))
                                                            (field 4 td)))
                                                        (before typing/btype.ml(363):11378-11409
                                                          (after typing/btype.ml(363):11378-11409
                                                            (apply
                                                              (field 11 it)
                                                              it
                                                              (field 2 td))))))))))
                                          it_extension_constructor =
                                            (function it td
                                              (funct-body typing/btype.ml(364)<ghost>:11441-11652
                                                (before typing/btype.ml(365):11453-11652
                                                  (seq
                                                    (after typing/btype.ml(365):11453-11480
                                                      (apply (field 14 it)
                                                        (field 0 td)))
                                                    (before typing/btype.ml(366):11486-11652
                                                      (seq
                                                        (after typing/btype.ml(366):11486-11535
                                                          (apply
                                                            (field 14
                                                              (global Stdlib__list!))
                                                            (after typing/btype.ml(366):11496-11516
                                                              (apply
                                                                (field 13 it)
                                                                it))
                                                            (field 1 td)))
                                                        (before typing/btype.ml(367):11541-11652
                                                          (seq
                                                            (after typing/btype.ml(367):11541-11598
                                                              (apply
                                                                iter_type_expr_cstr_args
                                                                (after typing/btype.ml(367):11566-11586
                                                                  (apply
                                                                    (field 13
                                                                    it) it))
                                                                (field 2 td)))
                                                            (before typing/btype.ml(368):11604-11652
                                                              (after typing/btype.ml(368):11604-11652
                                                                (apply
                                                                  (field 8
                                                                    (global Stdlib__option!))
                                                                  (after typing/btype.ml(368):11616-11636
                                                                    (apply
                                                                    (field 13
                                                                    it) it))
                                                                  (field 3
                                                                    td))))))))))))
                                          it_module_declaration =
                                            (function it md
                                              (funct-body typing/btype.ml(369)<ghost>:11681-11724
                                                (before typing/btype.ml(370):11693-11724
                                                  (after typing/btype.ml(370):11693-11724
                                                    (apply (field 9 it) it
                                                      (field 0 md))))))
                                          it_modtype_declaration =
                                            (function it mtd
                                              (funct-body typing/btype.ml(371)<ghost>:11754-11814
                                                (before typing/btype.ml(372):11767-11814
                                                  (after typing/btype.ml(372):11767-11814
                                                    (apply
                                                      (field 8
                                                        (global Stdlib__option!))
                                                      (after typing/btype.ml(372):11779-11801
                                                        (apply (field 9 it)
                                                          it))
                                                      (field 0 mtd))))))
                                          it_class_declaration =
                                            (function it cd
                                              (funct-body typing/btype.ml(373)<ghost>:11842-12012
                                                (before typing/btype.ml(374):11854-12012
                                                  (seq
                                                    (after typing/btype.ml(374):11854-11898
                                                      (apply
                                                        (field 14
                                                          (global Stdlib__list!))
                                                        (after typing/btype.ml(374):11864-11884
                                                          (apply
                                                            (field 13 it) it))
                                                        (field 0 cd)))
                                                    (before typing/btype.ml(375):11904-12012
                                                      (seq
                                                        (after typing/btype.ml(375):11904-11935
                                                          (apply
                                                            (field 10 it) it
                                                            (field 1 cd)))
                                                        (before typing/btype.ml(376):11941-12012
                                                          (seq
                                                            (after typing/btype.ml(376):11941-11984
                                                              (apply
                                                                (field 8
                                                                  (global Stdlib__option!))
                                                                (after typing/btype.ml(376):11953-11973
                                                                  (apply
                                                                    (field 13
                                                                    it) it))
                                                                (field 3 cd)))
                                                            (before typing/btype.ml(377):11990-12012
                                                              (after typing/btype.ml(377):11990-12012
                                                                (apply
                                                                  (field 14
                                                                    it)
                                                                  (field 2
                                                                    cd))))))))))))
                                          it_class_type_declaration =
                                            (function it ctd
                                              (funct-body typing/btype.ml(378)<ghost>:12045-12173
                                                (before typing/btype.ml(379):12058-12173
                                                  (seq
                                                    (after typing/btype.ml(379):12058-12104
                                                      (apply
                                                        (field 14
                                                          (global Stdlib__list!))
                                                        (after typing/btype.ml(379):12068-12088
                                                          (apply
                                                            (field 13 it) it))
                                                        (field 0 ctd)))
                                                    (before typing/btype.ml(380):12110-12173
                                                      (seq
                                                        (after typing/btype.ml(380):12110-12143
                                                          (apply
                                                            (field 10 it) it
                                                            (field 1 ctd)))
                                                        (before typing/btype.ml(381):12149-12173
                                                          (after typing/btype.ml(381):12149-12173
                                                            (apply
                                                              (field 14 it)
                                                              (field 2 ctd))))))))))
                                          it_module_type =
                                            (function it param
                                              (funct-body typing/btype.ml(382)<ghost>:12195-12422
                                                (catch
                                                  (switch* param
                                                   case tag 0: (exit 30)
                                                   case tag 1:
                                                    (let
                                                      (sg =a (field 0 param))
                                                      (before typing/btype.ml(385):12287-12308
                                                        (after typing/btype.ml(385):12287-12308
                                                          (apply (field 0 it)
                                                            it sg))))
                                                   case tag 2:
                                                    (let
                                                      (mt =a (field 2 param)
                                                       mto =a (field 1 param))
                                                      (before typing/btype.ml(387):12351-12422
                                                        (seq
                                                          (after typing/btype.ml(387):12351-12389
                                                            (apply
                                                              (field 8
                                                                (global Stdlib__option!))
                                                              (after typing/btype.ml(387):12363-12385
                                                                (apply
                                                                  (field 9
                                                                    it)
                                                                  it))
                                                              mto))
                                                          (before typing/btype.ml(388):12399-12422
                                                            (after typing/btype.ml(388):12399-12422
                                                              (apply
                                                                (field 9 it)
                                                                it mt))))))
                                                   case tag 3: (exit 30))
                                                 with (30)
                                                  (let
                                                    (p =a (field 0 param)
                                                     p = p)
                                                    (before typing/btype.ml(384):12248-12260
                                                      (after typing/btype.ml(384):12248-12260
                                                        (apply (field 14 it)
                                                          p)))))))
                                          it_class_type =
                                            (function it param
                                              (funct-body typing/btype.ml(389)<ghost>:12443-12942
                                                (switch* param
                                                 case tag 0:
                                                  (let
                                                    (cty =a (field 2 param)
                                                     tyl =a (field 1 param)
                                                     p =a (field 0 param))
                                                    (before typing/btype.ml(391):12499-12588
                                                      (seq
                                                        (after typing/btype.ml(391):12499-12511
                                                          (apply
                                                            (field 14 it) p))
                                                        (before typing/btype.ml(392):12521-12588
                                                          (seq
                                                            (after typing/btype.ml(392):12521-12555
                                                              (apply
                                                                (field 14
                                                                  (global Stdlib__list!))
                                                                (after typing/btype.ml(392):12531-12551
                                                                  (apply
                                                                    (field 13
                                                                    it) it))
                                                                tyl))
                                                            (before typing/btype.ml(393):12565-12588
                                                              (after typing/btype.ml(393):12565-12588
                                                                (apply
                                                                  (field 10
                                                                    it)
                                                                  it cty))))))))
                                                 case tag 1:
                                                  (let
                                                    (cs =a (field 0 param))
                                                    (before typing/btype.ml(395):12623-12846
                                                      (seq
                                                        (after typing/btype.ml(395):12623-12654
                                                          (apply
                                                            (field 13 it) it
                                                            (field 0 cs)))
                                                        (before typing/btype.ml(396):12664-12846
                                                          (seq
                                                            (after typing/btype.ml(396):12664-12728
                                                              (apply
                                                                (field 11
                                                                  (field 2
                                                                    (global Types!)))
                                                                (function
                                                                  param param
                                                                  (funct-body typing/btype.ml(396):12674-12715
                                                                    (let
                                                                    (ty =a
                                                                    (field 2
                                                                    param))
                                                                    (before typing/btype.ml(396):12693-12714
                                                                    (after typing/btype.ml(396):12693-12714
                                                                    (apply
                                                                    (field 13
                                                                    it) it
                                                                    ty))))))
                                                                (field 1 cs)))
                                                            (before typing/btype.ml(397):12738-12846
                                                              (after typing/btype.ml(397):12738-12846
                                                                (apply
                                                                  (field 14
                                                                    (global Stdlib__list!))
                                                                  (function
                                                                    param
                                                                    (funct-body typing/btype.ml(398):12758-12822
                                                                    (let
                                                                    (tl =a
                                                                    (field 1
                                                                    param)
                                                                    p =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(398):12774-12821
                                                                    (seq
                                                                    (after typing/btype.ml(398):12774-12786
                                                                    (apply
                                                                    (field 14
                                                                    it) p))
                                                                    (before typing/btype.ml(398):12788-12821
                                                                    (after typing/btype.ml(398):12788-12821
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (after typing/btype.ml(398):12798-12818
                                                                    (apply
                                                                    (field 13
                                                                    it) it))
                                                                    tl))))))))
                                                                  (field 3
                                                                    cs)))))))))
                                                 case tag 2:
                                                  (let
                                                    (cty =a (field 2 param)
                                                     ty =a (field 1 param))
                                                    (before typing/btype.ml(401):12888-12942
                                                      (seq
                                                        (after typing/btype.ml(401):12888-12909
                                                          (apply
                                                            (field 13 it) it
                                                            ty))
                                                        (before typing/btype.ml(402):12919-12942
                                                          (after typing/btype.ml(402):12919-12942
                                                            (apply
                                                              (field 10 it)
                                                              it cty)))))))))
                                          it_type_kind =
                                            (function it kind
                                              (funct-body typing/btype.ml(403)<ghost>:12962-13021
                                                (before typing/btype.ml(404):12976-13021
                                                  (after typing/btype.ml(404):12976-13021
                                                    (apply
                                                      iter_type_expr_kind
                                                      (after typing/btype.ml(404):12996-13016
                                                        (apply (field 13 it)
                                                          it))
                                                      kind)))))
                                          it_do_type_expr =
                                            (function it ty
                                              (funct-body typing/btype.ml(405)<ghost>:13044-13341
                                                (before typing/btype.ml(406):13056-13341
                                                  (seq
                                                    (after typing/btype.ml(406):13056-13094
                                                      (apply iter_type_expr
                                                        (after typing/btype.ml(406):13071-13091
                                                          (apply
                                                            (field 13 it) it))
                                                        ty))
                                                    (before typing/btype.ml(407):13100-13341
                                                      (let
                                                        (*match* =
                                                           (field 0 ty))
                                                        (catch
                                                          (catch
                                                            (catch
                                                              (switch *match*
                                                               case tag 3:
                                                                (exit 33)
                                                               case tag 4:
                                                                (let
                                                                  (*match* =a
                                                                    (field 1
                                                                    *match*)
                                                                   *match* =o
                                                                    (field 0
                                                                    *match*))
                                                                  (if *match*
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*)
                                                                    p =a
                                                                    (field 0
                                                                    *match*))
                                                                    (exit 31
                                                                    p))
                                                                    (exit 32)))
                                                               case tag 8:
                                                                (let
                                                                  (row =a
                                                                    (field 0
                                                                    *match*))
                                                                  (before typing/btype.ml(413):13264-13327
                                                                    (after typing/btype.ml(413):13264-13327
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__option!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/btype.ml(413):13276-13303
                                                                    (let
                                                                    (p =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(413):13290-13302
                                                                    (after typing/btype.ml(413):13290-13302
                                                                    (apply
                                                                    (field 14
                                                                    it) p))))))
                                                                    (field 5
                                                                    (after typing/btype.ml(413):13304-13318
                                                                    (apply
                                                                    row_repr
                                                                    row)))))))
                                                               case tag 11:
                                                                (exit 33)
                                                               default:
                                                                (exit 32))
                                                             with (33)
                                                              (let
                                                                (p =a
                                                                   (field 0
                                                                    *match*))
                                                                (exit 31 p)))
                                                           with (32)
                                                            (before typing/btype.ml(414):13339-13341
                                                              0a))
                                                         with (31 p)
                                                          (before typing/btype.ml(411):13221-13233
                                                            (after typing/btype.ml(411):13221-13233
                                                              (apply
                                                                (field 14 it)
                                                                p))))))))))
                                          it_path =
                                            (function _p
                                              (funct-body typing/btype.ml(415)<ghost>:13356-13363
                                                (before typing/btype.ml(415):13361-13363
                                                  0a))))
                                         (before typing/btype.ml(417):13371-13691
                                           (makeblock 0 it_signature
                                             it_signature_item
                                             it_value_description
                                             it_type_declaration
                                             it_extension_constructor
                                             it_module_declaration
                                             it_modtype_declaration
                                             it_class_declaration
                                             it_class_type_declaration
                                             it_module_type it_class_type
                                             it_type_kind it_do_type_expr
                                             it_do_type_expr it_path)))
                                     copy_row =
                                       (function f fixed row keep more
                                         (funct-body typing/btype.ml(423)<ghost>:13706-14384
                                           (before typing/btype.ml(424):13732-14384
                                             (let
                                               (fields =
                                                  (after typing/btype.ml(424):13745-14122
                                                    (apply
                                                      (field 16
                                                        (global Stdlib__list!))
                                                      (function param
                                                        (funct-body typing/btype.ml(425):13760-14101
                                                          (let
                                                            (fi =a
                                                               (field 1
                                                                 param)
                                                             l =a
                                                               (field 0
                                                                 param))
                                                            (before typing/btype.ml(425):13776-14100
                                                              (makeblock 0 l
                                                                (let
                                                                  (*match* =
                                                                    (after typing/btype.ml(426):13793-13810
                                                                    (apply
                                                                    row_field_repr
                                                                    fi)))
                                                                  (catch
                                                                    (switch* *match*
                                                                    case int 0:
                                                                    (exit 34)
                                                                    case tag 0:
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (ty =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/btype.ml(427):13847-13867
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    (after typing/btype.ml(427):13860-13866
                                                                    (apply f
                                                                    ty))))))
                                                                    (exit 34)))
                                                                    case tag 1:
                                                                    (let
                                                                    (e =a
                                                                    (field 3
                                                                    *match*)
                                                                    m =a
                                                                    (field 2
                                                                    *match*)
                                                                    tl =a
                                                                    (field 1
                                                                    *match*)
                                                                    c =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/btype.ml(429):13914-14082
                                                                    (let
                                                                    (e =
                                                                    (if keep
                                                                    (before typing/btype.ml(429):13935-13936
                                                                    e)
                                                                    (before typing/btype.ml(429):13942-13950
                                                                    (makemutable 0
                                                                    0a))))
                                                                    (before typing/btype.ml(430):13966-14082
                                                                    (let
                                                                    (m =
                                                                    (if
                                                                    (field 4
                                                                    row)
                                                                    (before typing/btype.ml(430):13996-14001
                                                                    fixed)
                                                                    (before typing/btype.ml(430):14007-14008
                                                                    m)))
                                                                    (before typing/btype.ml(431):14024-14082
                                                                    (let
                                                                    (tl =
                                                                    (after typing/btype.ml(431):14033-14046
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    f tl)))
                                                                    (before typing/btype.ml(432):14062-14082
                                                                    (makeblock 1
                                                                    c tl m e))))))))))
                                                                   with (34)
                                                                    (before typing/btype.ml(433):14098-14100
                                                                    fi))))))))
                                                      (field 0 row))))
                                               (before typing/btype.ml(435):14128-14384
                                                 (let
                                                   (name =
                                                      (let
                                                        (*match* =
                                                           (field 5 row))
                                                        (if *match*
                                                          (let
                                                            (*match* =a
                                                               (field 0
                                                                 *match*)
                                                             tl =a
                                                               (field 1
                                                                 *match*)
                                                             path =a
                                                               (field 0
                                                                 *match*))
                                                            (before typing/btype.ml(437):14205-14231
                                                              (makeblock 0
                                                                (makeblock 0
                                                                  path
                                                                  (after typing/btype.ml(437):14217-14230
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    f tl))))))
                                                          (before typing/btype.ml(436):14175-14179
                                                            0a))))
                                                   (before typing/btype.ml(438):14237-14384
                                                     (makeblock 0 fields more
                                                       0a (field 3 row)
                                                       (&& (field 4 row)
                                                         fixed)
                                                       name)))))))))
                                    (letrec
                                      (copy_kind
                                         (function param
                                           (funct-body typing/btype.ml(442):14406-14543
                                             (if (isint param)
                                               (if param
                                                 (before typing/btype.ml(446):14531-14543
                                                   (raise
                                                     (after typing/btype.ml(446):14531-14543
                                                       (makeblock 0
                                                         (global Assert_failure!)
                                                         [0:
                                                          "typing/btype.ml"
                                                          446 16]))))
                                                 (before typing/btype.ml(445):14506-14514
                                                   0a))
                                               (let
                                                 (*match* =a (field 0 param)
                                                  *match* =o
                                                    (field 0 *match*))
                                                 (if *match*
                                                   (let
                                                     (k =a (field 0 *match*))
                                                     (before typing/btype.ml(443):14446-14457
                                                       (after typing/btype.ml(443):14446-14457
                                                         (apply copy_kind k))))
                                                   (before typing/btype.ml(444):14474-14489
                                                     (makeblock 0
                                                       (makemutable 0 0a)))))))))
                                      (let
                                        (copy_commu =
                                           (function c
                                             (funct-body typing/btype.ml(448)<ghost>:14560-14622
                                               (before typing/btype.ml(449):14566-14622
                                                 (if
                                                   (==
                                                     (after typing/btype.ml(449):14569-14581
                                                       (apply commu_repr c))
                                                     0a)
                                                   (before typing/btype.ml(449):14593-14596
                                                     0a)
                                                   (before typing/btype.ml(449):14602-14622
                                                     (makeblock 0
                                                       (makemutable 0 1a))))))))
                                        (letrec
                                          (norm_univar
                                             (function ty
                                               (funct-body typing/btype.ml(453)<ghost>:14745-14922
                                                 (before typing/btype.ml(454):14752-14922
                                                   (let
                                                     (*match* = (field 0 ty))
                                                     (catch
                                                       (catch
                                                         (switch *match*
                                                          case tag 2:
                                                           (let
                                                             (*match* =a
                                                                (field 0
                                                                  *match*))
                                                             (if *match*
                                                               (let
                                                                 (ty =a
                                                                    (field 0
                                                                    *match*))
                                                                 (before typing/btype.ml(457):14869-14883
                                                                   (after typing/btype.ml(457):14869-14883
                                                                    (apply
                                                                    norm_univar
                                                                    ty))))
                                                               (exit 37)))
                                                          case tag 6:
                                                           (let
                                                             (ty =a
                                                                (field 0
                                                                  *match*))
                                                             (before typing/btype.ml(456):14828-14842
                                                               (after typing/btype.ml(456):14828-14842
                                                                 (apply
                                                                   norm_univar
                                                                   ty))))
                                                          case tag 7:
                                                           (exit 36)
                                                          case tag 9:
                                                           (exit 36)
                                                          default: (exit 37))
                                                        with (37)
                                                         (before typing/btype.ml(458):14910-14922
                                                           (raise
                                                             (after typing/btype.ml(458):14910-14922
                                                               (makeblock 0
                                                                 (global Assert_failure!)
                                                                 [0:
                                                                  "typing/btype.ml"
                                                                  458 26])))))
                                                      with (36)
                                                       (before typing/btype.ml(455):14799-14801
                                                         ty)))))))
                                          (letrec
                                            (copy_type_desc
                                               (function *opt* f ty
                                                 (funct-body typing/btype.ml(460)<ghost>:14947-15912
                                                   (before typing/btype.ml(460):14971-15912
                                                     (let
                                                       (keep_names =
                                                          (if *opt*
                                                            (let
                                                              (*sth* =a
                                                                 (field 0
                                                                   *opt*))
                                                              (before typing/btype.ml(460):14960-14965
                                                                *sth*))
                                                            (before typing/btype.ml(460):14960-14965
                                                              0a)))
                                                       (before typing/btype.ml(460):14971-15912
                                                         (switch* ty
                                                          case int 0:
                                                           (before typing/btype.ml(471):15590-15594
                                                             0a)
                                                          case tag 0:
                                                           (before typing/btype.ml(461):15007-15043
                                                             (if keep_names
                                                               (before typing/btype.ml(461):15026-15028
                                                                 ty)
                                                               (before typing/btype.ml(461):15034-15043
                                                                 [0: 0a])))
                                                          case tag 1:
                                                           (let
                                                             (c =a
                                                                (field 3 ty)
                                                              ty2 =a
                                                                (field 2 ty)
                                                              ty1 =a
                                                                (field 1 ty)
                                                              p =a
                                                                (field 0 ty))
                                                             (before typing/btype.ml(462):15074-15112
                                                               (makeblock 1 p
                                                                 (after typing/btype.ml(462):15085-15090
                                                                   (apply f
                                                                    ty1))
                                                                 (after typing/btype.ml(462):15092-15097
                                                                   (apply f
                                                                    ty2))
                                                                 (after typing/btype.ml(462):15099-15111
                                                                   (apply
                                                                    copy_commu
                                                                    c)))))
                                                          case tag 2:
                                                           (let
                                                             (l =a
                                                                (field 0 ty))
                                                             (before typing/btype.ml(463):15140-15161
                                                               (makeblock 2
                                                                 (after typing/btype.ml(463):15147-15161
                                                                   (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    f l)))))
                                                          case tag 3:
                                                           (let
                                                             (l =a
                                                                (field 1 ty)
                                                              p =a
                                                                (field 0 ty))
                                                             (before typing/btype.ml(464):15189-15224
                                                               (makeblock 3 p
                                                                 (after typing/btype.ml(464):15201-15213
                                                                   (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    f l))
                                                                 (makemutable 0
                                                                   0a))))
                                                          case tag 4:
                                                           (let
                                                             (*match* =a
                                                                (field 1 ty)
                                                              ty =a
                                                                (field 0 ty)
                                                              *match* =o
                                                                (field 0
                                                                  *match*))
                                                             (if *match*
                                                               (let
                                                                 (*match* =a
                                                                    (field 0
                                                                    *match*)
                                                                  tl =a
                                                                    (field 1
                                                                    *match*)
                                                                  p =a
                                                                    (field 0
                                                                    *match*))
                                                                 (before typing/btype.ml(466):15295-15339
                                                                   (makeblock 4
                                                                    (after typing/btype.ml(466):15304-15308
                                                                    (apply f
                                                                    ty))
                                                                    (makemutable 0
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    p
                                                                    (after typing/btype.ml(466):15323-15336
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    f tl))))))))
                                                               (let
                                                                 (ty =a ty)
                                                                 (before typing/btype.ml(467):15367-15391
                                                                   (makeblock 4
                                                                    (after typing/btype.ml(467):15376-15380
                                                                    (apply f
                                                                    ty))
                                                                    (makemutable 0
                                                                    0a))))))
                                                          case tag 5:
                                                           (let
                                                             (ty2 =a
                                                                (field 3 ty)
                                                              ty1 =a
                                                                (field 2 ty)
                                                              k =a
                                                                (field 1 ty)
                                                              p =a
                                                                (field 0 ty))
                                                             (before typing/btype.ml(470):15519-15562
                                                               (makeblock 5 p
                                                                 (after typing/btype.ml(470):15530-15547
                                                                   (apply
                                                                    field_kind_repr
                                                                    k))
                                                                 (after typing/btype.ml(470):15549-15554
                                                                   (apply f
                                                                    ty1))
                                                                 (after typing/btype.ml(470):15556-15561
                                                                   (apply f
                                                                    ty2)))))
                                                          case tag 6:
                                                           (let
                                                             (ty =a
                                                                (field 0 ty))
                                                             (before typing/btype.ml(472):15622-15646
                                                               (after typing/btype.ml(472):15622-15646
                                                                 (apply
                                                                   copy_type_desc
                                                                   0a f
                                                                   (field 0
                                                                    ty)))))
                                                          case tag 7:
                                                           (before typing/btype.ml(473):15674-15686
                                                             (raise
                                                               (after typing/btype.ml(473):15674-15686
                                                                 (makeblock 0
                                                                   (global Assert_failure!)
                                                                   [0:
                                                                    "typing/btype.ml"
                                                                    473 27]))))
                                                          case tag 8:
                                                           (before typing/btype.ml(468):15419-15431
                                                             (raise
                                                               (after typing/btype.ml(468):15419-15431
                                                                 (makeblock 0
                                                                   (global Assert_failure!)
                                                                   [0:
                                                                    "typing/btype.ml"
                                                                    468 27]))))
                                                          case tag 9:
                                                           (let (ty =a ty)
                                                             (before typing/btype.ml(474):15714-15716
                                                               ty))
                                                          case tag 10:
                                                           (let
                                                             (tyl =a
                                                                (field 1 ty)
                                                              ty =a
                                                                (field 0 ty))
                                                             (before typing/btype.ml(476):15777-15855
                                                               (let
                                                                 (tyl =
                                                                    (after typing/btype.ml(476):15787-15828
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    x
                                                                    (funct-body typing/btype.ml(476):15796-15824
                                                                    (before typing/btype.ml(476):15806-15823
                                                                    (after typing/btype.ml(476):15806-15823
                                                                    (apply
                                                                    norm_univar
                                                                    (after typing/btype.ml(476):15818-15823
                                                                    (apply f
                                                                    x)))))))
                                                                    tyl)))
                                                                 (before typing/btype.ml(477):15838-15855
                                                                   (makeblock 10
                                                                    (after typing/btype.ml(477):15845-15849
                                                                    (apply f
                                                                    ty)) tyl)))))
                                                          case tag 11:
                                                           (let
                                                             (l =a
                                                                (field 2 ty)
                                                              n =a
                                                                (field 1 ty)
                                                              p =a
                                                                (field 0 ty))
                                                             (before typing/btype.ml(478):15883-15912
                                                               (makeblock 11
                                                                 p n
                                                                 (after typing/btype.ml(478):15899-15911
                                                                   (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    f l))))))))))))
                                            (let
                                              (For_copy =
                                                 (module-defn(For_copy) typing/btype.ml(482):15943-17231
                                                   (let
                                                     (save_desc =
                                                        (function copy_scope
                                                          ty desc
                                                          (funct-body typing/btype.ml(502)<ghost>:16503-16588
                                                            (before typing/btype.ml(503):16528-16588
                                                              (setfield_ptr 0
                                                                copy_scope
                                                                (makeblock 0
                                                                  (makeblock 0
                                                                    ty desc)
                                                                  (field 0
                                                                    copy_scope))))))
                                                      dup_kind =
                                                        (function copy_scope
                                                          r
                                                          (funct-body typing/btype.ml(505)<ghost>:16605-16888
                                                            (before typing/btype.ml(506):16624-16888
                                                              (seq
                                                                (if
                                                                  (after typing/btype.ml(506):16631-16650
                                                                    (apply
                                                                    (field 9
                                                                    (global Stdlib__option!))
                                                                    (field 0
                                                                    r)))
                                                                  0a
                                                                  (raise
                                                                    (after typing/btype.ml(506):16624-16650
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/btype.ml"
                                                                    506 4]))))
                                                                (before typing/btype.ml(507):16656-16888
                                                                  (if
                                                                    (not
                                                                    (after typing/btype.ml(507):16663-16697
                                                                    (apply
                                                                    (field 32
                                                                    (global Stdlib__list!))
                                                                    r
                                                                    (field 2
                                                                    copy_scope))))
                                                                    (before typing/btype.ml(507):16703-16888
                                                                    (seq
                                                                    (setfield_ptr 1
                                                                    copy_scope
                                                                    (makeblock 0
                                                                    r
                                                                    (field 1
                                                                    copy_scope)))
                                                                    (before typing/btype.ml(509):16776-16880
                                                                    (let
                                                                    (r' =
                                                                    (makemutable 0
                                                                    0a))
                                                                    (before typing/btype.ml(510):16803-16880
                                                                    (seq
                                                                    (setfield_ptr 2
                                                                    copy_scope
                                                                    (makeblock 0
                                                                    r'
                                                                    (field 2
                                                                    copy_scope)))
                                                                    (before typing/btype.ml(511):16861-16880
                                                                    (setfield_ptr 0
                                                                    r
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    r'))))))))))
                                                                    0a))))))
                                                      cleanup =
                                                        (function param
                                                          (funct-body typing/btype.ml(515)<ghost>:16939-17080
                                                            (let
                                                              (saved_desc =o
                                                                 (field 0
                                                                   param)
                                                               saved_kinds =o
                                                                 (field 1
                                                                   param))
                                                              (before typing/btype.ml(516):16976-17080
                                                                (seq
                                                                  (after typing/btype.ml(516):16976-17032
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/btype.ml(516):16986-17021
                                                                    (let
                                                                    (desc =a
                                                                    (field 1
                                                                    param)
                                                                    ty =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(516):17005-17020
                                                                    (setfield_ptr 0
                                                                    ty desc)))))
                                                                    saved_desc))
                                                                  (before typing/btype.ml(517):17038-17080
                                                                    (after typing/btype.ml(517):17038-17080
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    r
                                                                    (funct-body typing/btype.ml(517):17048-17068
                                                                    (before typing/btype.ml(517):17058-17067
                                                                    (setfield_ptr 0
                                                                    r 0a))))
                                                                    saved_kinds))))))))
                                                      with_scope =
                                                        (function f
                                                          (funct-body typing/btype.ml(519)<ghost>:17099-17227
                                                            (before typing/btype.ml(520):17107-17227
                                                              (let
                                                                (scope =
                                                                   (makemutable 0
                                                                    0a 0a 0a))
                                                                (before typing/btype.ml(521):17180-17227
                                                                  (let
                                                                    (res =
                                                                    (after typing/btype.ml(521):17190-17197
                                                                    (apply f
                                                                    scope)))
                                                                    (before typing/btype.ml(522):17205-17227
                                                                    (seq
                                                                    (after typing/btype.ml(522):17205-17218
                                                                    (apply
                                                                    cleanup
                                                                    scope))
                                                                    (before typing/btype.ml(523):17224-17227
                                                                    res))))))))))
                                                     (pseudo typing/btype.ml(490):16157-17231
                                                       (makeblock 0 save_desc
                                                         dup_kind with_scope)))))
                                              (letrec
                                                (mark_type
                                                   (function ty
                                                     (funct-body typing/btype.ml(527)<ghost>:17270-17415
                                                       (before typing/btype.ml(528):17277-17415
                                                         (let
                                                           (ty =
                                                              (after typing/btype.ml(528):17286-17293
                                                                (apply repr
                                                                  ty)))
                                                           (before typing/btype.ml(529):17299-17415
                                                             (if
                                                               (>=
                                                                 (field 1 ty)
                                                                 lowest_level)
                                                               (before typing/btype.ml(529):17332-17415
                                                                 (seq
                                                                   (setfield_imm 1
                                                                    ty
                                                                    (-
                                                                    pivot_level
                                                                    (field 1
                                                                    ty)))
                                                                   (before typing/btype.ml(531):17382-17409
                                                                    (after typing/btype.ml(531):17382-17409
                                                                    (apply
                                                                    iter_type_expr
                                                                    mark_type
                                                                    ty)))))
                                                               0a)))))))
                                                (let
                                                  (mark_type_node =
                                                     (function ty
                                                       (funct-body typing/btype.ml(534)<ghost>:17436-17549
                                                         (before typing/btype.ml(535):17443-17549
                                                           (let
                                                             (ty =
                                                                (after typing/btype.ml(535):17452-17459
                                                                  (apply repr
                                                                    ty)))
                                                             (before typing/btype.ml(536):17465-17549
                                                               (if
                                                                 (>=
                                                                   (field 1
                                                                    ty)
                                                                   lowest_level)
                                                                 (before typing/btype.ml(536):17498-17549
                                                                   (setfield_imm 1
                                                                    ty
                                                                    (-
                                                                    pivot_level
                                                                    (field 1
                                                                    ty))))
                                                                 0a))))))
                                                   mark_type_params =
                                                     (function ty
                                                       (funct-body typing/btype.ml(540)<ghost>:17572-17606
                                                         (before typing/btype.ml(541):17579-17606
                                                           (after typing/btype.ml(541):17579-17606
                                                             (apply
                                                               iter_type_expr
                                                               mark_type ty)))))
                                                   type_iterators =
                                                     (let
                                                       (it_type_expr =
                                                          (function it ty
                                                            (funct-body typing/btype.ml(544)<ghost>:17648-17787
                                                              (before typing/btype.ml(545):17660-17787
                                                                (let
                                                                  (ty =
                                                                    (after typing/btype.ml(545):17669-17676
                                                                    (apply
                                                                    repr ty)))
                                                                  (before typing/btype.ml(546):17684-17787
                                                                    (if
                                                                    (>=
                                                                    (field 1
                                                                    ty)
                                                                    lowest_level)
                                                                    (before typing/btype.ml(546):17717-17787
                                                                    (seq
                                                                    (after typing/btype.ml(547):17729-17746
                                                                    (apply
                                                                    mark_type_node
                                                                    ty))
                                                                    (before typing/btype.ml(548):17754-17778
                                                                    (after typing/btype.ml(548):17754-17778
                                                                    (apply
                                                                    (field 12
                                                                    it) it
                                                                    ty)))))
                                                                    0a)))))))
                                                       (before typing/btype.ml(551):17795-17829
                                                         (let
                                                           (init =
                                                              type_iterators)
                                                           (makeblock 0
                                                             (field 0 init)
                                                             (field 1 init)
                                                             (field 2 init)
                                                             (field 3 init)
                                                             (field 4 init)
                                                             (field 5 init)
                                                             (field 6 init)
                                                             (field 7 init)
                                                             (field 8 init)
                                                             (field 9 init)
                                                             (field 10 init)
                                                             (field 11 init)
                                                             (field 12 init)
                                                             it_type_expr
                                                             (field 14 init))))))
                                                  (letrec
                                                    (unmark_type
                                                       (function ty
                                                         (funct-body typing/btype.ml(555)<ghost>:17884-18030
                                                           (before typing/btype.ml(556):17891-18030
                                                             (let
                                                               (ty =
                                                                  (after typing/btype.ml(556):17900-17907
                                                                    (apply
                                                                    repr ty)))
                                                               (before typing/btype.ml(557):17913-18030
                                                                 (if
                                                                   (<
                                                                    (field 1
                                                                    ty)
                                                                    lowest_level)
                                                                   (before typing/btype.ml(557):17945-18030
                                                                    (seq
                                                                    (setfield_imm 1
                                                                    ty
                                                                    (-
                                                                    pivot_level
                                                                    (field 1
                                                                    ty)))
                                                                    (before typing/btype.ml(559):17995-18024
                                                                    (after typing/btype.ml(559):17995-18024
                                                                    (apply
                                                                    iter_type_expr
                                                                    unmark_type
                                                                    ty)))))
                                                                   0a)))))))
                                                    (let
                                                      (unmark_iterators =
                                                         (let
                                                           (it_type_expr =
                                                              (function _it
                                                                ty
                                                                (funct-body typing/btype.ml(563)<ghost>:18074-18097
                                                                  (before typing/btype.ml(563):18083-18097
                                                                    (after typing/btype.ml(563):18083-18097
                                                                    (apply
                                                                    unmark_type
                                                                    ty))))))
                                                           (before typing/btype.ml(564):18103-18137
                                                             (let
                                                               (init =
                                                                  type_iterators)
                                                               (makeblock 0
                                                                 (field 0
                                                                   init)
                                                                 (field 1
                                                                   init)
                                                                 (field 2
                                                                   init)
                                                                 (field 3
                                                                   init)
                                                                 (field 4
                                                                   init)
                                                                 (field 5
                                                                   init)
                                                                 (field 6
                                                                   init)
                                                                 (field 7
                                                                   init)
                                                                 (field 8
                                                                   init)
                                                                 (field 9
                                                                   init)
                                                                 (field 10
                                                                   init)
                                                                 (field 11
                                                                   init)
                                                                 (field 12
                                                                   init)
                                                                 it_type_expr
                                                                 (field 14
                                                                   init)))))
                                                       unmark_type_decl =
                                                         (function decl
                                                           (funct-body typing/btype.ml(566)<ghost>:18160-18227
                                                             (before typing/btype.ml(567):18169-18227
                                                               (after typing/btype.ml(567):18169-18227
                                                                 (apply
                                                                   (field 3
                                                                    unmark_iterators)
                                                                   unmark_iterators
                                                                   decl)))))
                                                       unmark_extension_constructor =
                                                         (function ext
                                                           (funct-body typing/btype.ml(569)<ghost>:18262-18408
                                                             (before typing/btype.ml(570):18270-18408
                                                               (seq
                                                                 (after typing/btype.ml(570):18270-18311
                                                                   (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    unmark_type
                                                                    (field 1
                                                                    ext)))
                                                                 (before typing/btype.ml(571):18315-18408
                                                                   (seq
                                                                    (after typing/btype.ml(571):18315-18364
                                                                    (apply
                                                                    iter_type_expr_cstr_args
                                                                    unmark_type
                                                                    (field 2
                                                                    ext)))
                                                                    (before typing/btype.ml(572):18368-18408
                                                                    (after typing/btype.ml(572):18368-18408
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__option!))
                                                                    unmark_type
                                                                    (field 3
                                                                    ext))))))))))
                                                       unmark_class_signature =
                                                         (function sign
                                                           (funct-body typing/btype.ml(574)<ghost>:18437-18538
                                                             (before typing/btype.ml(575):18446-18538
                                                               (seq
                                                                 (after typing/btype.ml(575):18446-18472
                                                                   (apply
                                                                    unmark_type
                                                                    (field 0
                                                                    sign)))
                                                                 (before typing/btype.ml(576):18476-18538
                                                                   (after typing/btype.ml(576):18476-18538
                                                                    (apply
                                                                    (field 11
                                                                    (field 2
                                                                    (global Types!)))
                                                                    (function
                                                                    _l param
                                                                    (funct-body typing/btype.ml(576):18486-18523
                                                                    (let
                                                                    (t =a
                                                                    (field 2
                                                                    param))
                                                                    (before typing/btype.ml(576):18509-18522
                                                                    (after typing/btype.ml(576):18509-18522
                                                                    (apply
                                                                    unmark_type
                                                                    t))))))
                                                                    (field 1
                                                                    sign))))))))
                                                       unmark_class_type =
                                                         (function cty
                                                           (funct-body typing/btype.ml(578)<ghost>:18562-18621
                                                             (before typing/btype.ml(579):18570-18621
                                                               (after typing/btype.ml(579):18570-18621
                                                                 (apply
                                                                   (field 10
                                                                    unmark_iterators)
                                                                   unmark_iterators
                                                                   cty)))))
                                                       lte_public =
                                                         (function p1 p2
                                                           (funct-body typing/btype.ml(588)<ghost>:18888-19004
                                                             (before typing/btype.ml(589):18923-19004
                                                               (let
                                                                 (*match* =
                                                                    p1
                                                                  *match* =
                                                                    p2)
                                                                 (catch
                                                                   (if
                                                                    *match*
                                                                    (if
                                                                    *match*
                                                                    (exit 39)
                                                                    (before typing/btype.ml(591):18999-19004
                                                                    0a))
                                                                    (exit 39))
                                                                  with (39)
                                                                   (before typing/btype.ml(590):18971-18975
                                                                    1a)))))))
                                                      (letrec
                                                        (find_expans
                                                           (function priv p1
                                                             param
                                                             (funct-body typing/btype.ml(593)<ghost>:19026-19268
                                                               (switch* param
                                                                case int 0:
                                                                 (before typing/btype.ml(594):19057-19061
                                                                   0a)
                                                                case tag 0:
                                                                 (let
                                                                   (rem =a
                                                                    (field 4
                                                                    param)
                                                                    ty =a
                                                                    (field 3
                                                                    param)
                                                                    p2 =a
                                                                    (field 1
                                                                    param)
                                                                    priv' =a
                                                                    (field 0
                                                                    param))
                                                                   (before typing/btype.ml(596):19106-19146
                                                                    (if
                                                                    (&&
                                                                    (after typing/btype.ml(596):19106-19127
                                                                    (apply
                                                                    lte_public
                                                                    priv
                                                                    priv'))
                                                                    (after typing/btype.ml(596):19131-19146
                                                                    (apply
                                                                    (field 0
                                                                    (global Path!))
                                                                    p1 p2)))
                                                                    (before typing/btype.ml(596):19150-19157
                                                                    (makeblock 0
                                                                    ty))
                                                                    (before typing/btype.ml(597):19191-19214
                                                                    (after typing/btype.ml(597):19191-19214
                                                                    (apply
                                                                    find_expans
                                                                    priv p1
                                                                    rem))))))
                                                                case tag 1:
                                                                 (let
                                                                   (*match* =a
                                                                    (field 0
                                                                    param)
                                                                    rem =o
                                                                    (field 0
                                                                    *match*))
                                                                   (before typing/btype.ml(598):19245-19268
                                                                    (after typing/btype.ml(598):19245-19268
                                                                    (apply
                                                                    find_expans
                                                                    priv p1
                                                                    rem))))))))
                                                        (let
                                                          (memo =
                                                             (makemutable 0
                                                               0a)
                                                           cleanup_abbrev =
                                                             (function param
                                                               (funct-body typing/btype.ml(616)<ghost>:19743-19866
                                                                 (before typing/btype.ml(618):19810-19866
                                                                   (seq
                                                                    (after typing/btype.ml(618):19810-19852
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    abbr
                                                                    (funct-body typing/btype.ml(618):19820-19846
                                                                    (before typing/btype.ml(618):19833-19845
                                                                    (setfield_ptr 0
                                                                    abbr 0a))))
                                                                    (field 0
                                                                    memo)))
                                                                    (before typing/btype.ml(619):19856-19866
                                                                    (setfield_ptr 0
                                                                    memo 0a))))))
                                                           memorize_abbrev =
                                                             (function mem
                                                               priv path v v'
                                                               (funct-body typing/btype.ml(621)<ghost>:19888-20057
                                                                 (before typing/btype.ml(623):19968-20057
                                                                   (seq
                                                                    (setfield_ptr 0
                                                                    mem
                                                                    (makeblock 0
                                                                    priv path
                                                                    v v'
                                                                    (field 0
                                                                    mem)))
                                                                    (before typing/btype.ml(625):20037-20057
                                                                    (setfield_ptr 0
                                                                    memo
                                                                    (makeblock 0
                                                                    mem
                                                                    (field 0
                                                                    memo)))))))))
                                                          (letrec
                                                            (forget_abbrev_rec
                                                               (function mem
                                                                 path
                                                                 (funct-body typing/btype.ml(627)<ghost>:20085-20384
                                                                   (before typing/btype.ml(628):20098-20384
                                                                    (switch* mem
                                                                    case int 0:
                                                                    (before typing/btype.ml(630):20131-20134
                                                                    mem)
                                                                    case tag 0:
                                                                    (let
                                                                    (rem =a
                                                                    (field 4
                                                                    mem)
                                                                    v' =a
                                                                    (field 3
                                                                    mem)
                                                                    v =a
                                                                    (field 2
                                                                    mem)
                                                                    path' =a
                                                                    (field 1
                                                                    mem)
                                                                    priv =a
                                                                    (field 0
                                                                    mem))
                                                                    (before typing/btype.ml(631):20172-20192
                                                                    (if
                                                                    (after typing/btype.ml(631):20172-20192
                                                                    (apply
                                                                    (field 0
                                                                    (global Path!))
                                                                    path
                                                                    path'))
                                                                    (before typing/btype.ml(632):20202-20205
                                                                    rem)
                                                                    (let
                                                                    (rem =a
                                                                    rem
                                                                    path' =a
                                                                    path')
                                                                    (before typing/btype.ml(634):20251-20305
                                                                    (makeblock 0
                                                                    priv
                                                                    path' v
                                                                    v'
                                                                    (after typing/btype.ml(634):20278-20304
                                                                    (apply
                                                                    forget_abbrev_rec
                                                                    rem path))))))))
                                                                    case tag 1:
                                                                    (let
                                                                    (mem' =a
                                                                    (field 0
                                                                    mem))
                                                                    (before typing/btype.ml(636):20330-20384
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    mem'
                                                                    (after typing/btype.ml(636):20338-20366
                                                                    (apply
                                                                    forget_abbrev_rec
                                                                    (field 0
                                                                    mem')
                                                                    path)))
                                                                    (before typing/btype.ml(637):20374-20384
                                                                    (raise
                                                                    (after typing/btype.ml(637):20380-20384
                                                                    (field 2
                                                                    (global Stdlib!)))))))))))))
                                                            (let
                                                              (forget_abbrev =
                                                                 (function
                                                                   mem path
                                                                   (funct-body typing/btype.ml(639)<ghost>:20404-20471
                                                                    (before typing/btype.ml(640):20417-20471
                                                                    (try
                                                                    (setfield_ptr 0
                                                                    mem
                                                                    (after typing/btype.ml(640):20428-20455
                                                                    (apply
                                                                    forget_abbrev_rec
                                                                    (field 0
                                                                    mem)
                                                                    path)))
                                                                    with exn
                                                                    (if
                                                                    (== exn
                                                                    (field 2
                                                                    (global Stdlib!)))
                                                                    (before typing/btype.ml(640):20469-20471
                                                                    0a)
                                                                    (reraise
                                                                    exn))))))
                                                               is_optional =
                                                                 (function
                                                                   param
                                                                   (funct-body typing/btype.ml(658):20952-20992
                                                                    (catch
                                                                    (switch* param
                                                                    case int 0:
                                                                    (exit 42)
                                                                    case tag 0:
                                                                    (exit 42)
                                                                    case tag 1:
                                                                    (before typing/btype.ml(658):20975-20979
                                                                    1a))
                                                                    with (42)
                                                                    (before typing/btype.ml(658):20987-20992
                                                                    0a))))
                                                               label_name =
                                                                 (function
                                                                   param
                                                                   (funct-body typing/btype.ml(660):21011-21072
                                                                    (if
                                                                    (isint
                                                                    param)
                                                                    (before typing/btype.ml(661):21035-21037
                                                                    "")
                                                                    (let
                                                                    (s =a
                                                                    (field 0
                                                                    param)
                                                                    s = s)
                                                                    (before typing/btype.ml(663):21071-21072
                                                                    s)))))
                                                               prefixed_label_name =
                                                                 (function
                                                                   param
                                                                   (funct-body typing/btype.ml(665):21100-21178
                                                                    (switch* param
                                                                    case int 0:
                                                                    (before typing/btype.ml(666):21124-21126
                                                                    "")
                                                                    case tag 0:
                                                                    (let
                                                                    (s =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(667):21145-21152
                                                                    (after typing/btype.ml(667):21145-21152
                                                                    (apply
                                                                    (field 27
                                                                    (global Stdlib!))
                                                                    "~" s))))
                                                                    case tag 1:
                                                                    (let
                                                                    (s =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(668):21171-21178
                                                                    (after typing/btype.ml(668):21171-21178
                                                                    (apply
                                                                    (field 27
                                                                    (global Stdlib!))
                                                                    "?" s))))))))
                                                              (letrec
                                                                (extract_label_aux
                                                                   (function
                                                                    hd l
                                                                    param
                                                                    (funct-body typing/btype.ml(670)<ghost>:21206-21371
                                                                    (if param
                                                                    (let
                                                                    (ls =a
                                                                    (field 1
                                                                    param)
                                                                    p =a
                                                                    (field 0
                                                                    param)
                                                                    t =a
                                                                    (field 1
                                                                    p)
                                                                    l' =a
                                                                    (field 0
                                                                    p))
                                                                    (before typing/btype.ml(673):21279-21371
                                                                    (if
                                                                    (after typing/btype.ml(673):21282-21299
                                                                    (caml_string_equal
                                                                    (after typing/btype.ml(673):21282-21295
                                                                    (apply
                                                                    label_name
                                                                    l')) l))
                                                                    (before typing/btype.ml(673):21305-21329
                                                                    (makeblock 0
                                                                    l' t
                                                                    (after typing/btype.ml(673):21313-21324
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__list!))
                                                                    hd)) ls))
                                                                    (before typing/btype.ml(674):21341-21371
                                                                    (after typing/btype.ml(674):21341-21371
                                                                    (apply
                                                                    extract_label_aux
                                                                    (makeblock 0
                                                                    p hd) l
                                                                    ls))))))
                                                                    (before typing/btype.ml(671):21232-21247
                                                                    (raise
                                                                    (after typing/btype.ml(671):21238-21247
                                                                    (field 7
                                                                    (global Stdlib!)))))))))
                                                                (let
                                                                  (extract_label =
                                                                    (function
                                                                    l ls
                                                                    (funct-body typing/btype.ml(676)<ghost>:21391-21423
                                                                    (before typing/btype.ml(676):21398-21423
                                                                    (after typing/btype.ml(676):21398-21423
                                                                    (apply
                                                                    extract_label_aux
                                                                    0a l ls)))))
                                                                   undo_change =
                                                                    (function
                                                                    param
                                                                    (funct-body typing/btype.ml(683):21610-21965
                                                                    (switch* param
                                                                    case tag 0:
                                                                    (let
                                                                    (desc =a
                                                                    (field 1
                                                                    param)
                                                                    ty =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(684):21644-21659
                                                                    (setfield_ptr 0
                                                                    ty desc)))
                                                                    case tag 1:
                                                                    (let
                                                                    (desc =a
                                                                    (field 1
                                                                    param)
                                                                    ty =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(685):21692-21707
                                                                    (setfield_ptr 0
                                                                    ty desc)))
                                                                    case tag 2:
                                                                    (let
                                                                    (level =a
                                                                    (field 1
                                                                    param)
                                                                    ty =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(686):21734-21751
                                                                    (setfield_imm 1
                                                                    ty level)))
                                                                    case tag 3:
                                                                    (let
                                                                    (scope =a
                                                                    (field 1
                                                                    param)
                                                                    ty =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(687):21778-21795
                                                                    (setfield_imm 2
                                                                    ty scope)))
                                                                    case tag 4:
                                                                    (let
                                                                    (v =a
                                                                    (field 1
                                                                    param)
                                                                    r =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(688):21817-21823
                                                                    (setfield_ptr 0
                                                                    r v)))
                                                                    case tag 5:
                                                                    (let
                                                                    (v =a
                                                                    (field 1
                                                                    param)
                                                                    r =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(689):21845-21851
                                                                    (setfield_ptr 0
                                                                    r v)))
                                                                    case tag 6:
                                                                    (let
                                                                    (v =a
                                                                    (field 1
                                                                    param)
                                                                    r =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(690):21873-21879
                                                                    (setfield_ptr 0
                                                                    r v)))
                                                                    case tag 7:
                                                                    (let
                                                                    (v =a
                                                                    (field 1
                                                                    param)
                                                                    r =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(691):21901-21907
                                                                    (setfield_ptr 0
                                                                    r v)))
                                                                    case tag 8:
                                                                    (let
                                                                    (v =a
                                                                    (field 1
                                                                    param)
                                                                    r =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(692):21929-21935
                                                                    (setfield_ptr 0
                                                                    r v)))
                                                                    case tag 9:
                                                                    (let
                                                                    (v =a
                                                                    (field 1
                                                                    param)
                                                                    r =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(693):21959-21965
                                                                    (setfield_ptr 0
                                                                    r v))))))
                                                                   last_snapshot =
                                                                    (makemutable 0 (int)
                                                                    0)
                                                                   log_type =
                                                                    (function
                                                                    ty
                                                                    (funct-body typing/btype.ml(698)<ghost>:22041-22112
                                                                    (before typing/btype.ml(699):22048-22112
                                                                    (if
                                                                    (<=
                                                                    (field 3
                                                                    ty)
                                                                    (field 0
                                                                    last_snapshot))
                                                                    (before typing/btype.ml(699):22080-22112
                                                                    (after typing/btype.ml(699):22080-22112
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 0
                                                                    ty
                                                                    (field 0
                                                                    ty)))))
                                                                    0a))))
                                                                   link_type =
                                                                    (function
                                                                    ty ty'
                                                                    (funct-body typing/btype.ml(700)<ghost>:22127-22655
                                                                    (before typing/btype.ml(701):22138-22655
                                                                    (seq
                                                                    (after typing/btype.ml(701):22138-22149
                                                                    (apply
                                                                    log_type
                                                                    ty))
                                                                    (before typing/btype.ml(702):22153-22655
                                                                    (let
                                                                    (desc =
                                                                    (field 0
                                                                    ty))
                                                                    (before typing/btype.ml(703):22177-22655
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    ty
                                                                    (makeblock 6
                                                                    ty'))
                                                                    (before typing/btype.ml(706):22324-22655
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    ty')
                                                                    *match* =
                                                                    desc
                                                                    *match* =
                                                                    *match*)
                                                                    (catch
                                                                    (switch *match*
                                                                    case tag 0:
                                                                    (switch *match*
                                                                    case tag 0:
                                                                    (let
                                                                    (name' =a
                                                                    (field 0
                                                                    *match*)
                                                                    name =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/btype.ml(708):22385-22643
                                                                    (let
                                                                    (*match* =
                                                                    name
                                                                    *match* =
                                                                    name')
                                                                    (if
                                                                    *match*
                                                                    (if
                                                                    *match*
                                                                    (before typing/btype.ml(712):22539-22605
                                                                    (if
                                                                    (<
                                                                    (field 1
                                                                    ty)
                                                                    (field 1
                                                                    ty'))
                                                                    (before typing/btype.ml(712):22568-22605
                                                                    (seq
                                                                    (after typing/btype.ml(712):22569-22581
                                                                    (apply
                                                                    log_type
                                                                    ty'))
                                                                    (before typing/btype.ml(712):22583-22604
                                                                    (setfield_ptr 0
                                                                    ty'
                                                                    (makeblock 0
                                                                    name)))))
                                                                    0a))
                                                                    (before typing/btype.ml(709):22439-22474
                                                                    (seq
                                                                    (after typing/btype.ml(709):22439-22451
                                                                    (apply
                                                                    log_type
                                                                    ty'))
                                                                    (before typing/btype.ml(709):22453-22474
                                                                    (setfield_ptr 0
                                                                    ty'
                                                                    (makeblock 0
                                                                    name))))))
                                                                    (if
                                                                    *match*
                                                                    (before typing/btype.ml(710):22500-22502
                                                                    0a)
                                                                    (before typing/btype.ml(713):22631-22633
                                                                    0a))))))
                                                                    default:
                                                                    (exit 44))
                                                                    default:
                                                                    (exit 44))
                                                                    with (44)
                                                                    (before typing/btype.ml(715):22653-22655
                                                                    0a))))))))))))
                                                                   set_level =
                                                                    (function
                                                                    ty
                                                                    level[int]
                                                                    (funct-body typing/btype.ml(718)<ghost>:22747-22891
                                                                    (before typing/btype.ml(719):22760-22891
                                                                    (if
                                                                    (!= level
                                                                    (field 1
                                                                    ty))
                                                                    (before typing/btype.ml(719):22786-22891
                                                                    (seq
                                                                    (if
                                                                    (<=
                                                                    (field 3
                                                                    ty)
                                                                    (field 0
                                                                    last_snapshot))
                                                                    (before typing/btype.ml(720):22828-22862
                                                                    (after typing/btype.ml(720):22828-22862
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 2 (*,int)
                                                                    ty
                                                                    (field 1
                                                                    ty)))))
                                                                    0a)
                                                                    (before typing/btype.ml(721):22868-22885
                                                                    (setfield_imm 1
                                                                    ty level))))
                                                                    0a))))
                                                                   set_scope =
                                                                    (function
                                                                    ty
                                                                    scope[int]
                                                                    (funct-body typing/btype.ml(723)<ghost>:22906-23050
                                                                    (before typing/btype.ml(724):22919-23050
                                                                    (if
                                                                    (!= scope
                                                                    (field 2
                                                                    ty))
                                                                    (before typing/btype.ml(724):22945-23050
                                                                    (seq
                                                                    (if
                                                                    (<=
                                                                    (field 3
                                                                    ty)
                                                                    (field 0
                                                                    last_snapshot))
                                                                    (before typing/btype.ml(725):22987-23021
                                                                    (after typing/btype.ml(725):22987-23021
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 3 (*,int)
                                                                    ty
                                                                    (field 2
                                                                    ty)))))
                                                                    0a)
                                                                    (before typing/btype.ml(726):23027-23044
                                                                    (setfield_imm 2
                                                                    ty scope))))
                                                                    0a))))
                                                                   set_univar =
                                                                    (function
                                                                    rty ty
                                                                    (funct-body typing/btype.ml(728)<ghost>:23066-23123
                                                                    (before typing/btype.ml(729):23077-23123
                                                                    (seq
                                                                    (after typing/btype.ml(729):23077-23107
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 8
                                                                    rty
                                                                    (field 0
                                                                    rty))))
                                                                    (before typing/btype.ml(729):23109-23123
                                                                    (setfield_ptr 0
                                                                    rty
                                                                    (makeblock 0
                                                                    ty)))))))
                                                                   set_name =
                                                                    (function
                                                                    nm v
                                                                    (funct-body typing/btype.ml(730)<ghost>:23137-23183
                                                                    (before typing/btype.ml(731):23146-23183
                                                                    (seq
                                                                    (after typing/btype.ml(731):23146-23174
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 4
                                                                    nm
                                                                    (field 0
                                                                    nm))))
                                                                    (before typing/btype.ml(731):23176-23183
                                                                    (setfield_ptr 0
                                                                    nm v))))))
                                                                   set_row_field =
                                                                    (function
                                                                    e v
                                                                    (funct-body typing/btype.ml(732)<ghost>:23202-23248
                                                                    (before typing/btype.ml(733):23210-23248
                                                                    (seq
                                                                    (after typing/btype.ml(733):23210-23235
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 5
                                                                    e
                                                                    (field 0
                                                                    e))))
                                                                    (before typing/btype.ml(733):23237-23248
                                                                    (setfield_ptr 0
                                                                    e
                                                                    (makeblock 0
                                                                    v)))))))
                                                                   set_kind =
                                                                    (function
                                                                    rk k
                                                                    (funct-body typing/btype.ml(734)<ghost>:23262-23313
                                                                    (before typing/btype.ml(735):23271-23313
                                                                    (seq
                                                                    (after typing/btype.ml(735):23271-23299
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 6
                                                                    rk
                                                                    (field 0
                                                                    rk))))
                                                                    (before typing/btype.ml(735):23301-23313
                                                                    (setfield_ptr 0
                                                                    rk
                                                                    (makeblock 0
                                                                    k)))))))
                                                                   set_commu =
                                                                    (function
                                                                    rc c
                                                                    (funct-body typing/btype.ml(736)<ghost>:23328-23375
                                                                    (before typing/btype.ml(737):23337-23375
                                                                    (seq
                                                                    (after typing/btype.ml(737):23337-23366
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 7
                                                                    rc
                                                                    (field 0
                                                                    rc))))
                                                                    (before typing/btype.ml(737):23368-23375
                                                                    (setfield_ptr 0
                                                                    rc c))))))
                                                                   set_typeset =
                                                                    (function
                                                                    rs s
                                                                    (funct-body typing/btype.ml(738)<ghost>:23392-23441
                                                                    (before typing/btype.ml(739):23401-23441
                                                                    (seq
                                                                    (after typing/btype.ml(739):23401-23432
                                                                    (apply
                                                                    log_change
                                                                    (makeblock 9
                                                                    rs
                                                                    (field 0
                                                                    rs))))
                                                                    (before typing/btype.ml(739):23434-23441
                                                                    (setfield_ptr 0
                                                                    rs s))))))
                                                                   snapshot =
                                                                    (function
                                                                    param
                                                                    (funct-body typing/btype.ml(741)<ghost>:23456-23658
                                                                    (before typing/btype.ml(742):23463-23658
                                                                    (let
                                                                    (old =[int]
                                                                    (field 0
                                                                    last_snapshot))
                                                                    (before typing/btype.ml(743):23493-23658
                                                                    (seq
                                                                    (setfield_imm 0
                                                                    last_snapshot
                                                                    (field 0
                                                                    new_id))
                                                                    (before typing/btype.ml(744):23521-23658
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/btype.ml(744):23527-23543
                                                                    (apply
                                                                    (field 3
                                                                    (global Stdlib__weak!))
                                                                    trail 0)))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (r =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/btype.ml(744):23559-23567
                                                                    (makeblock 0 (*,int)
                                                                    r old)))
                                                                    (before typing/btype.ml(746):23586-23658
                                                                    (let
                                                                    (r =
                                                                    (makemutable 0
                                                                    0a))
                                                                    (before typing/btype.ml(747):23617-23658
                                                                    (seq
                                                                    (after typing/btype.ml(747):23617-23642
                                                                    (apply
                                                                    (field 2
                                                                    (global Stdlib__weak!))
                                                                    trail 0
                                                                    (makeblock 0
                                                                    r)))
                                                                    (before typing/btype.ml(748):23650-23658
                                                                    (makeblock 0 (*,int)
                                                                    r old))))))))))))))))
                                                                  (letrec
                                                                    (
                                                                    rev_log
                                                                    (function
                                                                    accu
                                                                    param
                                                                    (funct-body typing/btype.ml(750)<ghost>:23676-23839
                                                                    (if
                                                                    (isint
                                                                    param)
                                                                    (if param
                                                                    (before typing/btype.ml(752):23729-23741
                                                                    (raise
                                                                    (after typing/btype.ml(752):23729-23741
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/btype.ml"
                                                                    752 15]))))
                                                                    (before typing/btype.ml(751):23709-23713
                                                                    accu))
                                                                    (let
                                                                    (next =a
                                                                    (field 1
                                                                    param)
                                                                    ch =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(754):23773-23839
                                                                    (let
                                                                    (d =
                                                                    (field 0
                                                                    next))
                                                                    (before typing/btype.ml(755):23796-23839
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    next 1a)
                                                                    (before typing/btype.ml(756):23819-23839
                                                                    (after typing/btype.ml(756):23819-23839
                                                                    (apply
                                                                    rev_log
                                                                    (makeblock 0
                                                                    ch accu)
                                                                    d))))))))))))
                                                                    (let
                                                                    (backtrack =
                                                                    (function
                                                                    param
                                                                    (funct-body typing/btype.ml(758)<ghost>:23855-24196
                                                                    (let
                                                                    (old =a
                                                                    (field 1
                                                                    param)
                                                                    changes =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(759):23874-24196
                                                                    (let
                                                                    (change =
                                                                    (field 0
                                                                    changes))
                                                                    (if
                                                                    (isint
                                                                    change)
                                                                    (if
                                                                    change
                                                                    (before typing/btype.ml(761):23947-23973
                                                                    (after typing/btype.ml(761):23947-23973
                                                                    (apply
                                                                    (field 1
                                                                    (global Stdlib!))
                                                                    "Btype.backtrack")))
                                                                    (before typing/btype.ml(760):23911-23931
                                                                    (setfield_imm 0
                                                                    last_snapshot
                                                                    old)))
                                                                    (before typing/btype.ml(763):24006-24196
                                                                    (seq
                                                                    (after typing/btype.ml(763):24006-24023
                                                                    (apply
                                                                    cleanup_abbrev
                                                                    0a))
                                                                    (before typing/btype.ml(764):24031-24196
                                                                    (let
                                                                    (backlog =
                                                                    (after typing/btype.ml(764):24045-24062
                                                                    (apply
                                                                    rev_log
                                                                    0a
                                                                    change)))
                                                                    (before typing/btype.ml(765):24072-24196
                                                                    (seq
                                                                    (after typing/btype.ml(765):24072-24101
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    undo_change
                                                                    backlog))
                                                                    (before typing/btype.ml(766):24109-24196
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    changes
                                                                    0a)
                                                                    (before typing/btype.ml(767):24137-24196
                                                                    (seq
                                                                    (setfield_imm 0
                                                                    last_snapshot
                                                                    old)
                                                                    (before typing/btype.ml(768):24165-24196
                                                                    (after typing/btype.ml(768):24165-24196
                                                                    (apply
                                                                    (field 2
                                                                    (global Stdlib__weak!))
                                                                    trail 0
                                                                    (makeblock 0
                                                                    changes)))))))))))))))))))))
                                                                    (letrec
                                                                    (rev_compress_log
                                                                    (function
                                                                    log r
                                                                    (funct-body typing/btype.ml(770)<ghost>:24223-24410
                                                                    (before typing/btype.ml(771):24233-24410
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    r))
                                                                    (if
                                                                    (isint
                                                                    *match*)
                                                                    (before typing/btype.ml(773):24280-24283
                                                                    log)
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*))
                                                                    (switch *match*
                                                                    case tag 1:
                                                                    (let
                                                                    (next =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/btype.ml(775):24324-24354
                                                                    (after typing/btype.ml(775):24324-24354
                                                                    (apply
                                                                    rev_compress_log
                                                                    (makeblock 0
                                                                    r log)
                                                                    next))))
                                                                    default:
                                                                    (let
                                                                    (next =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/btype.ml(777):24385-24410
                                                                    (after typing/btype.ml(777):24385-24410
                                                                    (apply
                                                                    rev_compress_log
                                                                    log next))))))))))))
                                                                    (let
                                                                    (undo_compress =
                                                                    (function
                                                                    param
                                                                    (funct-body typing/btype.ml(779)<ghost>:24430-24753
                                                                    (let
                                                                    (changes =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/btype.ml(780):24450-24753
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    changes))
                                                                    (if
                                                                    (isint
                                                                    *match*)
                                                                    (before typing/btype.ml(782):24499-24501
                                                                    0a)
                                                                    (before typing/btype.ml(784):24524-24753
                                                                    (let
                                                                    (log =
                                                                    (after typing/btype.ml(784):24534-24561
                                                                    (apply
                                                                    rev_compress_log
                                                                    0a
                                                                    changes)))
                                                                    (before typing/btype.ml(785):24571-24753
                                                                    (after typing/btype.ml(785):24571-24753
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    r
                                                                    (funct-body typing/btype.ml(786):24589-24741
                                                                    (before typing/btype.ml(786):24599-24740
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    r))
                                                                    (catch
                                                                    (if
                                                                    (isint
                                                                    *match*)
                                                                    (exit 47)
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*))
                                                                    (switch *match*
                                                                    case tag 1:
                                                                    (let
                                                                    (next =a
                                                                    (field 1
                                                                    *match*)
                                                                    d =a
                                                                    (field 2
                                                                    *match*)
                                                                    desc =a
                                                                    (field 1
                                                                    *match*)
                                                                    ty =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/btype.ml(787):24667-24679
                                                                    (if
                                                                    (==
                                                                    (field 0
                                                                    ty) d)
                                                                    (before typing/btype.ml(788):24695-24722
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    ty desc)
                                                                    (before typing/btype.ml(788):24712-24722
                                                                    (setfield_ptr 0
                                                                    r
                                                                    (field 0
                                                                    next)))))
                                                                    (exit 47))))
                                                                    default:
                                                                    (exit 47))))
                                                                    with (47)
                                                                    (before typing/btype.ml(789):24738-24740
                                                                    0a))))))
                                                                    log))))))))))))
                                                                    (pseudo _none_(0)<ghost>:-1--1
                                                                    (makeblock 0
                                                                    TypeSet
                                                                    TypeMap
                                                                    TypeHash
                                                                    generic_level
                                                                    newty2
                                                                    newgenty
                                                                    newgenvar
                                                                    is_Tvar
                                                                    is_Tunivar
                                                                    is_Tconstr
                                                                    dummy_method
                                                                    default_mty
                                                                    repr
                                                                    field_kind_repr
                                                                    commu_repr
                                                                    row_repr
                                                                    row_field_repr
                                                                    row_field
                                                                    row_more
                                                                    row_fixed
                                                                    static_row
                                                                    hash_variant
                                                                    proxy
                                                                    row_of_type
                                                                    has_constr_row
                                                                    is_row_name
                                                                    is_constr_row
                                                                    iter_type_expr
                                                                    fold_type_expr
                                                                    iter_row
                                                                    fold_row
                                                                    iter_abbrev
                                                                    type_iterators
                                                                    unmark_iterators
                                                                    copy_type_desc
                                                                    copy_row
                                                                    copy_kind
                                                                    For_copy
                                                                    lowest_level
                                                                    pivot_level
                                                                    mark_type
                                                                    mark_type_node
                                                                    mark_type_params
                                                                    unmark_type
                                                                    unmark_type_decl
                                                                    unmark_extension_constructor
                                                                    unmark_class_type
                                                                    unmark_class_signature
                                                                    find_expans
                                                                    cleanup_abbrev
                                                                    memorize_abbrev
                                                                    forget_abbrev
                                                                    is_optional
                                                                    label_name
                                                                    prefixed_label_name
                                                                    extract_label
                                                                    snapshot
                                                                    backtrack
                                                                    undo_compress
                                                                    link_type
                                                                    set_level
                                                                    set_scope
                                                                    set_name
                                                                    set_row_field
                                                                    set_univar
                                                                    set_kind
                                                                    set_commu
                                                                    set_typeset
                                                                    log_type
                                                                    print_raw
                                                                    iter_type_expr_kind
                                                                    iter_type_expr_cstr_args
                                                                    map_type_expr_cstr_args)))))))))))))))))))))))))))))))))))))))
