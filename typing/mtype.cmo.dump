(setglobal Mtype!
  (letrec
    (scrape
       (function env mty
         (funct-body typing/mtype.ml(23)<ghost>:1165-1339
           (before typing/mtype.ml(24):1177-1339
             (switch mty
              case tag 0:
               (let (p =a (field 0 mty))
                 (before typing/mtype.ml(26):1217-1326
                   (try
                     (after typing/mtype.ml(27):1235-1280
                       (apply scrape env
                         (after typing/mtype.ml(27):1246-1280
                           (apply (field 20 (global Env!)) p env))))
                    with exn
                     (if (== exn (field 7 (global Stdlib!)))
                       (before typing/mtype.ml(29):1313-1316 mty)
                       (reraise exn)))))
              default: (before typing/mtype.ml(31):1336-1339 mty))))))
    (let
      (freshen =
         (function scope[int] mty
           (funct-body typing/mtype.ml(33)<ghost>:1353-1416
             (before typing/mtype.ml(34):1368-1416
               (after typing/mtype.ml(34):1368-1416
                 (apply (field 18 (global Subst!)) (makeblock 0 (int) scope)
                   (field 0 (global Subst!)) mty))))))
      (letrec
        (strengthen
           (function aliasable env mty p
             (funct-body typing/mtype.ml(36)<ghost>:1437-1791
               (before typing/mtype.ml(37):1462-1791
                 (let
                   (mty =
                      (after typing/mtype.ml(37):1468-1482
                        (apply scrape env mty)))
                   (catch
                     (switch* mty
                      case tag 0: (exit 3)
                      case tag 1:
                       (let (sg =a (field 0 mty))
                         (before typing/mtype.ml(39):1518-1567
                           (makeblock 1
                             (after typing/mtype.ml(39):1531-1567
                               (apply strengthen_sig aliasable env sg p)))))
                      case tag 2:
                       (let
                         (res =a (field 2 mty)
                          arg =a (field 1 mty)
                          param =a (field 0 mty))
                         (before typing/mtype.ml(41):1610-1666
                           (if
                             (&& (field 0 (field 52 (global Clflags!)))
                               (after typing/mtype.ml(41):1643-1666
                                 (caml_string_notequal
                                   (after typing/mtype.ml(41):1643-1659
                                     (apply (field 14 (global Ident!)) param))
                                   "*")))
                             (before typing/mtype.ml(42):1676-1770
                               (makeblock 2 param arg
                                 (after typing/mtype.ml(43):1708-1769
                                   (apply strengthen 0a env res
                                     (makeblock 2 p (makeblock 0 param))))))
                             (exit 3))))
                      case tag 3: (exit 3))
                    with (3) (before typing/mtype.ml(45):1788-1791 mty))))))
          strengthen_sig
            (function aliasable env sg p
              (funct-body typing/mtype.ml(47)<ghost>:1812-3904
                (before typing/mtype.ml(48):1836-3904
                  (if sg
                    (let (sigelt =a (field 0 sg))
                      (switch* sigelt
                       case tag 0:
                        (let (rem =a (field 1 sg))
                          (before typing/mtype.ml(51):1914-1959
                            (makeblock 0 sigelt
                              (after typing/mtype.ml(51):1924-1959
                                (apply strengthen_sig aliasable env rem p)))))
                       case tag 1:
                        (let
                          (decl =a (field 1 sigelt)
                           *match* =a (field 2 decl)
                           id =a (field 0 sigelt))
                          (catch
                            (if (isint *match*)
                              (if *match* (exit 6)
                                (let (rem =a (field 1 sg))
                                  (if rem
                                    (let (*match* =a (field 0 rem))
                                      (switch *match*
                                       case tag 1:
                                        (let
                                          (*match* =a (field 1 *match*)
                                           *match* =a (field 3 *match*))
                                          (if *match* (exit 6)
                                            (let (id' =a (field 0 *match*))
                                              (before typing/mtype.ml(54):2084-2123
                                                (if
                                                  (after typing/mtype.ml(54):2084-2123
                                                    (caml_string_equal
                                                      (after typing/mtype.ml(54):2084-2097
                                                        (apply
                                                          (field 14
                                                            (global Ident!))
                                                          id))
                                                      (after typing/mtype.ml(54):2100-2123
                                                        (apply
                                                          (field 27
                                                            (global Stdlib!))
                                                          (after typing/mtype.ml(54):2100-2114
                                                            (apply
                                                              (field 14
                                                                (global Ident!))
                                                              id'))
                                                          "#row"))))
                                                  (before typing/mtype.ml(55):2133-2168
                                                    (after typing/mtype.ml(55):2133-2168
                                                      (apply strengthen_sig
                                                        aliasable env rem p)))
                                                  (exit 6))))))
                                       default: (exit 6)))
                                    (exit 6))))
                              (exit 6))
                           with (6)
                            (let
                              (id =a id
                               rem =a (field 1 sg)
                               vis =a (field 3 sigelt)
                               rs =a (field 2 sigelt))
                              (before typing/mtype.ml(57):2217-2863
                                (let
                                  (newdecl =
                                     (let
                                       (*match* = (field 4 decl)
                                        *match* = (field 3 decl)
                                        *match* = (field 2 decl)
                                        *match* = *match*
                                        *match* = *match*
                                        *match* = *match*)
                                       (catch
                                         (if *match*
                                           (if *match*
                                             (before typing/mtype.ml(59):2335-2339
                                               decl)
                                             (if (isint *match*) (exit 4)
                                               (before typing/mtype.ml(60):2403-2407
                                                 decl)))
                                           (exit 4))
                                        with (4)
                                         (before typing/mtype.ml(62):2435-2778
                                           (let
                                             (manif =
                                                (makeblock 0
                                                  (after typing/mtype.ml(63):2465-2584
                                                    (apply
                                                      (field 5
                                                        (global Btype!))
                                                      (makeblock 3
                                                        (makeblock 1 p
                                                          (after typing/mtype.ml(63):2497-2510
                                                            (apply
                                                              (field 14
                                                                (global Ident!))
                                                              id)))
                                                        (field 0 decl)
                                                        (makemutable 0 0a))))))
                                             (before typing/mtype.ml(65):2600-2778
                                               (if (== (field 2 decl) 0a)
                                                 (before typing/mtype.ml(66):2653-2711
                                                   (let (init = decl)
                                                     (makeblock 0 (*,int,*,*,*,*,*,int,*,*,*,*)
                                                       (field 0 init)
                                                       (field 1 init)
                                                       (field 2 init) 1a
                                                       manif (field 5 init)
                                                       (field 6 init)
                                                       (field 7 init)
                                                       (field 8 init)
                                                       (field 9 init)
                                                       (field 10 init)
                                                       (field 11 init))))
                                                 (before typing/mtype.ml(68):2743-2778
                                                   (let (init = decl)
                                                     (makeblock 0 (*,int,*,*,*,*,*,int,*,*,*,*)
                                                       (field 0 init)
                                                       (field 1 init)
                                                       (field 2 init)
                                                       (field 3 init) manif
                                                       (field 5 init)
                                                       (field 6 init)
                                                       (field 7 init)
                                                       (field 8 init)
                                                       (field 9 init)
                                                       (field 10 init)
                                                       (field 11 init)))))))))))
                                  (before typing/mtype.ml(70):2794-2863
                                    (makeblock 0
                                      (makeblock 1 id newdecl rs vis)
                                      (after typing/mtype.ml(70):2828-2863
                                        (apply strengthen_sig aliasable env
                                          rem p)))))))))
                       case tag 2:
                        (let (sigelt =a sigelt rem =a (field 1 sg))
                          (before typing/mtype.ml(72):2909-2954
                            (makeblock 0 sigelt
                              (after typing/mtype.ml(72):2919-2954
                                (apply strengthen_sig aliasable env rem p)))))
                       case tag 3:
                        (let
                          (rem =a (field 1 sg)
                           vis =a (field 4 sigelt)
                           rs =a (field 3 sigelt)
                           md =a (field 2 sigelt)
                           pres =a (field 1 sigelt)
                           id =a (field 0 sigelt))
                          (before typing/mtype.ml(74):3009-3241
                            (let
                              (str =
                                 (after typing/mtype.ml(75):3027-3085
                                   (apply strengthen_decl aliasable env md
                                     (makeblock 1 p
                                       (after typing/mtype.ml(75):3070-3083
                                         (apply (field 14 (global Ident!))
                                           id))))))
                              (before typing/mtype.ml(77):3101-3241
                                (makeblock 0 (makeblock 3 id pres str rs vis)
                                  (after typing/mtype.ml(78):3145-3241
                                    (apply strengthen_sig aliasable
                                      (after typing/mtype.ml(79):3179-3235
                                        (apply (field 51 (global Env!)) 0a 0a
                                          id pres md env))
                                      rem p)))))))
                       case tag 4:
                        (let
                          (rem =a (field 1 sg)
                           vis =a (field 2 sigelt)
                           decl =a (field 1 sigelt)
                           id =a (field 0 sigelt))
                          (before typing/mtype.ml(82):3365-3656
                            (let
                              (newdecl =
                                 (let (*match* = (field 0 decl))
                                   (if *match*
                                     (before typing/mtype.ml(87):3536-3540
                                       decl)
                                     (before typing/mtype.ml(85):3442-3503
                                       (let (init = decl)
                                         (makeblock 0
                                           (makeblock 0
                                             (makeblock 0
                                               (makeblock 1 p
                                                 (after typing/mtype.ml(85):3486-3499
                                                   (apply
                                                     (field 14
                                                       (global Ident!))
                                                     id)))))
                                           (field 1 init) (field 2 init)))))))
                              (before typing/mtype.ml(89):3556-3656
                                (makeblock 0 (makeblock 4 id newdecl vis)
                                  (after typing/mtype.ml(90):3595-3656
                                    (apply strengthen_sig aliasable
                                      (after typing/mtype.ml(90):3621-3650
                                        (apply (field 52 (global Env!)) id
                                          decl env))
                                      rem p)))))))
                       case tag 5:
                        (let (sigelt =a sigelt rem =a (field 1 sg))
                          (before typing/mtype.ml(93):3764-3809
                            (makeblock 0 sigelt
                              (after typing/mtype.ml(93):3774-3809
                                (apply strengthen_sig aliasable env rem p)))))
                       case tag 6:
                        (let (sigelt =a sigelt rem =a (field 1 sg))
                          (before typing/mtype.ml(95):3859-3904
                            (makeblock 0 sigelt
                              (after typing/mtype.ml(95):3869-3904
                                (apply strengthen_sig aliasable env rem p)))))))
                    (before typing/mtype.ml(49):1860-1862 0a)))))
          strengthen_decl
            (function aliasable env md p
              (funct-body typing/mtype.ml(97)<ghost>:3926-4112
                (before typing/mtype.ml(98):3950-4112
                  (let (mty = (field 0 md))
                    (switch mty
                     case tag 3: (before typing/mtype.ml(99):3991-3993 md)
                     default:
                      (before typing/mtype.ml(100):4005-4014
                        (if aliasable
                          (before typing/mtype.ml(100):4018-4049
                            (let (init = md)
                              (makeblock 0 (makeblock 3 p) (field 1 init)
                                (field 2 init))))
                          (before typing/mtype.ml(101):4061-4112
                            (let (init = md)
                              (makeblock 0
                                (after typing/mtype.ml(101):4080-4111
                                  (apply strengthen aliasable env mty p))
                                (field 1 init) (field 2 init))))))))))))
        (let
          (*match* = (setfield_ptr 0 (field 101 (global Env!)) strengthen))
          (letrec
            (make_aliases_absent
               (function pres mty
                 (funct-body typing/mtype.ml(105)<ghost>:4181-4481
                   (before typing/mtype.ml(106):4194-4481
                     (switch* mty
                      case tag 0:
                       (let (mty =a mty)
                         (before typing/mtype.ml(114):4472-4481
                           (makeblock 0 pres mty)))
                      case tag 1:
                       (let (sg =a (field 0 mty))
                         (before typing/mtype.ml(109):4273-4320
                           (makeblock 0 pres
                             (makeblock 1
                               (after typing/mtype.ml(109):4292-4320
                                 (apply make_aliases_absent_sig sg))))))
                      case tag 2:
                       (let
                         (res =a (field 2 mty)
                          arg =a (field 1 mty)
                          param =a (field 0 mty))
                         (before typing/mtype.ml(111):4363-4454
                           (let
                             (*match* =
                                (after typing/mtype.ml(111):4376-4410
                                  (apply make_aliases_absent 0a res))
                              res =a (field 1 *match*))
                             (before typing/mtype.ml(112):4420-4454
                               (makeblock 0 pres (makeblock 2 param arg res))))))
                      case tag 3:
                       (before typing/mtype.ml(107):4228-4242
                         (makeblock 0 1a mty))))))
              make_aliases_absent_sig
                (function sg
                  (funct-body typing/mtype.ml(116)<ghost>:4511-4833
                    (before typing/mtype.ml(117):4518-4833
                      (if sg
                        (let (sigelt =a (field 0 sg))
                          (switch sigelt
                           case tag 3:
                            (let
                              (rem =a (field 1 sg)
                               priv =a (field 4 sigelt)
                               rs =a (field 3 sigelt)
                               md =a (field 2 sigelt)
                               pres =a (field 1 sigelt)
                               id =a (field 0 sigelt))
                              (before typing/mtype.ml(120):4600-4768
                                (let
                                  (*match* =
                                     (after typing/mtype.ml(120):4620-4655
                                       (apply make_aliases_absent pres
                                         (field 0 md)))
                                   md_type =a (field 1 *match*)
                                   pres =a (field 0 *match*))
                                  (before typing/mtype.ml(121):4665-4768
                                    (let
                                      (md =
                                         (let (init = md)
                                           (makeblock 0 md_type
                                             (field 1 init) (field 2 init))))
                                      (before typing/mtype.ml(122):4703-4768
                                        (makeblock 0
                                          (makeblock 3 id pres md rs priv)
                                          (after typing/mtype.ml(122):4741-4768
                                            (apply make_aliases_absent_sig
                                              rem)))))))))
                           default:
                            (let (rem =a (field 1 sg))
                              (before typing/mtype.ml(124):4796-4833
                                (makeblock 0 sigelt
                                  (after typing/mtype.ml(124):4806-4833
                                    (apply make_aliases_absent_sig rem)))))))
                        (before typing/mtype.ml(118):4542-4544 0a))))))
            (let
              (scrape_for_type_of =
                 (function env pres mty
                   (funct-body typing/mtype.ml(126)<ghost>:4858-5241
                     (before typing/mtype.ml(127):4875-5241
                       (letrec
                         (loop
                            (function env path mty
                              (funct-body typing/mtype.ml(127)<ghost>:4888-5189
                                (before typing/mtype.ml(128):4907-5189
                                  (let (*match* = mty *match* = path)
                                    (switch *match*
                                     case tag 3:
                                      (let (path =a (field 0 *match*))
                                        (before typing/mtype.ml(129):4955-5101
                                          (try
                                            (let
                                              (md =
                                                 (after typing/mtype.ml(131):4992-5016
                                                   (apply
                                                     (field 14 (global Env!))
                                                     path env)))
                                              (before typing/mtype.ml(132):5030-5061
                                                (after typing/mtype.ml(132):5030-5061
                                                  (apply loop env
                                                    (makeblock 0 path)
                                                    (field 0 md)))))
                                           with exn
                                            (if
                                              (== exn
                                                (field 7 (global Stdlib!)))
                                              (before typing/mtype.ml(133):5088-5091
                                                mty)
                                              (reraise exn)))))
                                     default:
                                      (if *match*
                                        (let
                                          (mty =a *match*
                                           path =a (field 0 *match*))
                                          (before typing/mtype.ml(136):5134-5174
                                            (after typing/mtype.ml(136):5134-5174
                                              (apply strengthen 0a env mty
                                                path))))
                                        (before typing/mtype.ml(137):5186-5189
                                          mty))))))))
                         (before typing/mtype.ml(139):5197-5241
                           (after typing/mtype.ml(139):5197-5241
                             (apply make_aliases_absent pres
                               (after typing/mtype.ml(139):5222-5241
                                 (apply loop env 0a mty))))))))))
              (letrec
                (nondep_mty_with_presence
                   (function env va ids pres mty
                     (funct-body typing/mtype.ml(147)<ghost>:5476-6723
                       (before typing/mtype.ml(148):5500-6723
                         (switch* mty
                          case tag 0:
                           (let (p =a (field 0 mty))
                             (before typing/mtype.ml(150):5540-5866
                               (let
                                 (*match* =
                                    (after typing/mtype.ml(150):5552-5576
                                      (apply (field 2 (global Path!)) ids p)))
                                 (if *match*
                                   (let (id =a (field 0 *match*))
                                     (before typing/mtype.ml(152):5611-5830
                                       (let
                                         (expansion =
                                            (try
                                              (after typing/mtype.ml(153):5643-5675
                                                (apply
                                                  (field 20 (global Env!)) p
                                                  env))
                                             with exn
                                              (if
                                                (== exn
                                                  (field 7 (global Stdlib!)))
                                                (before typing/mtype.ml(155):5720-5756
                                                  (raise
                                                    (after typing/mtype.ml(155):5726-5756
                                                      (makeblock 0
                                                        (field 86
                                                          (global Ctype!))
                                                        id))))
                                                (reraise exn))))
                                         (before typing/mtype.ml(157):5780-5830
                                           (after typing/mtype.ml(157):5780-5830
                                             (apply nondep_mty_with_presence
                                               env va ids pres expansion))))))
                                   (before typing/mtype.ml(158):5847-5856
                                     (makeblock 0 pres mty))))))
                          case tag 1:
                           (let (sg =a (field 0 mty))
                             (before typing/mtype.ml(172):6252-6320
                               (let
                                 (mty =
                                    (makeblock 1
                                      (after typing/mtype.ml(172):6275-6301
                                        (apply nondep_sig env va ids sg))))
                                 (before typing/mtype.ml(173):6311-6320
                                   (makeblock 0 pres mty)))))
                          case tag 2:
                           (let
                             (res =a (field 2 mty)
                              arg =a (field 1 mty)
                              param =a (field 0 mty))
                             (before typing/mtype.ml(175):6363-6723
                               (let
                                 (var_inv =
                                    (switch* va
                                     case int 0:
                                      (before typing/mtype.ml(176):6405-6411
                                        1a)
                                     case int 1:
                                      (before typing/mtype.ml(176):6424-6426
                                        0a)
                                     case int 2:
                                      (before typing/mtype.ml(176):6439-6445
                                        2a)))
                                 (before typing/mtype.ml(177):6455-6723
                                   (let
                                     (mty =
                                        (makeblock 2 param
                                          (after typing/mtype.ml(178):6492-6535
                                            (apply
                                              (field 6
                                                (global Stdlib__option!))
                                              (after typing/mtype.ml(178):6503-6531
                                                (apply nondep_mty env var_inv
                                                  ids))
                                              arg))
                                          (after typing/mtype.ml(179):6557-6697
                                            (apply nondep_mty
                                              (after typing/mtype.ml(180):6590-6686
                                                (apply
                                                  (field 50 (global Env!))
                                                  [0: 1a] param 0a
                                                  (after typing/mtype.ml(181):6658-6681
                                                    (apply
                                                      (field 11
                                                        (global Btype!))
                                                      arg))
                                                  env))
                                              va ids res))))
                                     (before typing/mtype.ml(183):6714-6723
                                       (makeblock 0 pres mty)))))))
                          case tag 3:
                           (let (p =a (field 0 mty))
                             (before typing/mtype.ml(161):5892-6221
                               (let
                                 (*match* =
                                    (after typing/mtype.ml(161):5904-5928
                                      (apply (field 2 (global Path!)) ids p)))
                                 (if *match*
                                   (let (id =a (field 0 *match*))
                                     (before typing/mtype.ml(163):5963-6185
                                       (let
                                         (expansion =
                                            (try
                                              (after typing/mtype.ml(164):5995-6016
                                                (apply
                                                  (field 14 (global Env!)) p
                                                  env))
                                             with exn
                                              (if
                                                (== exn
                                                  (field 7 (global Stdlib!)))
                                                (before typing/mtype.ml(166):6061-6097
                                                  (raise
                                                    (after typing/mtype.ml(166):6067-6097
                                                      (makeblock 0
                                                        (field 86
                                                          (global Ctype!))
                                                        id))))
                                                (reraise exn))))
                                         (before typing/mtype.ml(168):6121-6185
                                           (after typing/mtype.ml(168):6121-6185
                                             (apply nondep_mty_with_presence
                                               env va ids 0a
                                               (field 0 expansion)))))))
                                   (before typing/mtype.ml(169):6202-6211
                                     (makeblock 0 pres mty))))))))))
                  nondep_mty
                    (function env va ids mty
                      (funct-body typing/mtype.ml(185)<ghost>:6740-6815
                        (before typing/mtype.ml(186):6759-6815
                          (field 1
                            (after typing/mtype.ml(186):6763-6815
                              (apply nondep_mty_with_presence env va ids 0a
                                mty))))))
                  nondep_sig_item
                    (function env va ids param
                      (funct-body typing/mtype.ml(188)<ghost>:6837-7961
                        (switch* param
                         case tag 0:
                          (let
                            (vis =a (field 2 param)
                             d =a (field 1 param)
                             id =a (field 0 param))
                            (before typing/mtype.ml(190):6894-7002
                              (makeblock 0 id
                                (let (init = d)
                                  (makeblock 0
                                    (after typing/mtype.ml(191):6943-6979
                                      (apply (field 87 (global Ctype!)) env
                                        ids (field 0 d)))
                                    (field 1 init) (field 2 init)
                                    (field 3 init)))
                                vis)))
                         case tag 1:
                          (let
                            (vis =a (field 3 param)
                             rs =a (field 2 param)
                             d =a (field 1 param)
                             id =a (field 0 param))
                            (before typing/mtype.ml(194):7041-7106
                              (makeblock 1 id
                                (after typing/mtype.ml(194):7054-7096
                                  (apply (field 88 (global Ctype!)) env ids
                                    (== va 0a) d))
                                rs vis)))
                         case tag 2:
                          (let
                            (vis =a (field 3 param)
                             es =a (field 2 param)
                             ext =a (field 1 param)
                             id =a (field 0 param))
                            (before typing/mtype.ml(196):7149-7220
                              (makeblock 2 id
                                (after typing/mtype.ml(196):7164-7210
                                  (apply (field 89 (global Ctype!)) env ids
                                    ext))
                                es vis)))
                         case tag 3:
                          (let
                            (vis =a (field 4 param)
                             rs =a (field 3 param)
                             md =a (field 2 param)
                             pres =a (field 1 param)
                             id =a (field 0 param))
                            (before typing/mtype.ml(198):7268-7399
                              (let
                                (*match* =
                                   (after typing/mtype.ml(198):7284-7335
                                     (apply nondep_mty_with_presence env va
                                       ids pres (field 0 md)))
                                 mty =a (field 1 *match*)
                                 pres =a (field 0 *match*))
                                (before typing/mtype.ml(199):7345-7399
                                  (makeblock 3 id pres
                                    (let (init = md)
                                      (makeblock 0 mty (field 1 init)
                                        (field 2 init)))
                                    rs vis)))))
                         case tag 4:
                          (let
                            (vis =a (field 2 param)
                             d =a (field 1 param)
                             id =a (field 0 param))
                            (before typing/mtype.ml(201):7437-7742
                              (try
                                (makeblock 4 id
                                  (after typing/mtype.ml(202):7471-7500
                                    (apply nondep_modtype_decl env ids d))
                                  vis)
                               with exn
                                (let (tag =a (field 0 exn))
                                  (if (== tag (field 86 (global Ctype!)))
                                    (before typing/mtype.ml(204):7564-7732
                                      (if va
                                        (before typing/mtype.ml(207):7723-7732
                                          (reraise
                                            (after typing/mtype.ml(207):7729-7732
                                              exn)))
                                        (before typing/mtype.ml(205):7594-7706
                                          (makeblock 4 id
                                            (makeblock 0 0a 0a
                                              (field 0 (global Location!)))
                                            vis))))
                                    (reraise exn))))))
                         case tag 5:
                          (let
                            (vis =a (field 3 param)
                             rs =a (field 2 param)
                             d =a (field 1 param)
                             id =a (field 0 param))
                            (before typing/mtype.ml(210):7782-7846
                              (makeblock 5 id
                                (after typing/mtype.ml(210):7796-7836
                                  (apply (field 90 (global Ctype!)) env ids
                                    d))
                                rs vis)))
                         case tag 6:
                          (let
                            (vis =a (field 3 param)
                             rs =a (field 2 param)
                             d =a (field 1 param)
                             id =a (field 0 param))
                            (before typing/mtype.ml(212):7891-7961
                              (makeblock 6 id
                                (after typing/mtype.ml(212):7910-7951
                                  (apply (field 91 (global Ctype!)) env ids
                                    d))
                                rs vis))))))
                  nondep_sig
                    (function env va ids sg
                      (funct-body typing/mtype.ml(214)<ghost>:7978-8036
                        (before typing/mtype.ml(215):7996-8036
                          (after typing/mtype.ml(215):7996-8036
                            (apply (field 16 (global Stdlib__list!))
                              (after typing/mtype.ml(215):8005-8033
                                (apply nondep_sig_item env va ids))
                              sg)))))
                  nondep_modtype_decl
                    (function env ids mtd
                      (funct-body typing/mtype.ml(217)<ghost>:8062-8151
                        (before typing/mtype.ml(218):8078-8151
                          (let (init = mtd)
                            (makeblock 0
                              (after typing/mtype.ml(218):8099-8150
                                (apply (field 6 (global Stdlib__option!))
                                  (after typing/mtype.ml(218):8110-8137
                                    (apply nondep_mty env 2a ids))
                                  (field 0 mtd)))
                              (field 1 init) (field 2 init)))))))
                (let
                  (nondep_supertype =
                     (function env ids
                       (funct-body typing/mtype.ml(220)<ghost>:8174-8205
                         (before typing/mtype.ml(220):8184-8205
                           (after typing/mtype.ml(220):8184-8205
                             (apply nondep_mty env 0a ids)))))
                   nondep_sig_item =
                     (function env ids
                       (funct-body typing/mtype.ml(221)<ghost>:8226-8262
                         (before typing/mtype.ml(221):8236-8262
                           (after typing/mtype.ml(221):8236-8262
                             (apply nondep_sig_item env 0a ids)))))
                   enrich_typedecl =
                     (function env p id decl
                       (funct-body typing/mtype.ml(223)<ghost>:8284-9483
                         (before typing/mtype.ml(224):8302-9483
                           (let (*match* = (field 4 decl))
                             (if *match*
                               (before typing/mtype.ml(225):8346-8350 decl)
                               (before typing/mtype.ml(227):8369-9483
                                 (try
                                   (let
                                     (orig_decl =
                                        (after typing/mtype.ml(228):8397-8416
                                          (apply (field 12 (global Env!)) p
                                            env)))
                                     (before typing/mtype.ml(229):8428-9053
                                       (if
                                         (!= (field 1 decl)
                                           (field 1 orig_decl))
                                         (before typing/mtype.ml(230):8486-8490
                                           decl)
                                         (before typing/mtype.ml(232):8514-9053
                                           (let
                                             (orig_ty =
                                                (after typing/mtype.ml(233):8540-8635
                                                  (apply
                                                    (field 80
                                                      (global Ctype!))
                                                    (after typing/mtype.ml(234):8574-8635
                                                      (apply
                                                        (field 5
                                                          (global Btype!))
                                                        (makeblock 3 p
                                                          (field 0 orig_decl)
                                                          (makemutable 0 0a)))))))
                                             (before typing/mtype.ml(236):8659-9053
                                               (let
                                                 (new_ty =
                                                    (after typing/mtype.ml(237):8684-8782
                                                      (apply
                                                        (field 80
                                                          (global Ctype!))
                                                        (after typing/mtype.ml(238):8718-8782
                                                          (apply
                                                            (field 5
                                                              (global Btype!))
                                                            (makeblock 3
                                                              (makeblock 0
                                                                id)
                                                              (field 0 decl)
                                                              (makemutable 0
                                                                0a)))))))
                                                 (before typing/mtype.ml(240):8806-9053
                                                   (let
                                                     (env =
                                                        (after typing/mtype.ml(240):8816-8853
                                                          (apply
                                                            (field 48
                                                              (global Env!))
                                                            0a id decl env)))
                                                     (before typing/mtype.ml(241):8867-9053
                                                       (seq
                                                         (after typing/mtype.ml(241):8867-8897
                                                           (apply
                                                             (field 111
                                                               (global Ctype!))
                                                             env orig_ty
                                                             new_ty))
                                                         (before typing/mtype.ml(242):8909-9053
                                                           (let
                                                             (orig_ty =
                                                                (after typing/mtype.ml(243):8935-8989
                                                                  (apply
                                                                    (field 5
                                                                    (global Btype!))
                                                                    (makeblock 3
                                                                    p
                                                                    (field 0
                                                                    decl)
                                                                    (makemutable 0
                                                                    0a)))))
                                                             (before typing/mtype.ml(245):9013-9053
                                                               (let
                                                                 (init = decl)
                                                                 (makeblock 0 (*,int,*,*,*,*,*,int,*,*,*,*)
                                                                   (field 0
                                                                    init)
                                                                   (field 1
                                                                    init)
                                                                   (field 2
                                                                    init)
                                                                   (field 3
                                                                    init)
                                                                   (makeblock 0
                                                                    orig_ty)
                                                                   (field 5
                                                                    init)
                                                                   (field 6
                                                                    init)
                                                                   (field 7
                                                                    init)
                                                                   (field 8
                                                                    init)
                                                                   (field 9
                                                                    init)
                                                                   (field 10
                                                                    init)
                                                                   (field 11
                                                                    init)))))))))))))))))
                                  with exn
                                   (catch
                                     (if (== exn (field 7 (global Stdlib!)))
                                       (exit 28)
                                       (let (tag =a (field 0 exn))
                                         (if
                                           (== tag (field 1 (global Ctype!)))
                                           (exit 28) (reraise exn))))
                                    with (28)
                                     (before typing/mtype.ml(253):9479-9483
                                       decl))))))))))
                  (letrec
                    (enrich_modtype
                       (function env p mty
                         (funct-body typing/mtype.ml(255)<ghost>:9508-9632
                           (before typing/mtype.ml(256):9522-9632
                             (switch mty
                              case tag 1:
                               (let (sg =a (field 0 mty))
                                 (before typing/mtype.ml(258):9567-9613
                                   (makeblock 1
                                     (after typing/mtype.ml(258):9580-9613
                                       (apply
                                         (field 16 (global Stdlib__list!))
                                         (after typing/mtype.ml(258):9590-9609
                                           (apply enrich_item env p))
                                         sg)))))
                              default:
                               (before typing/mtype.ml(260):9629-9632 mty)))))
                      enrich_item
                        (function env p item
                          (funct-body typing/mtype.ml(262)<ghost>:9650-10067
                            (switch item
                             case tag 1:
                              (let
                                (priv =a (field 3 item)
                                 rs =a (field 2 item)
                                 decl =a (field 1 item)
                                 id =a (field 0 item))
                                (before typing/mtype.ml(264):9709-9801
                                  (makeblock 1 id
                                    (after typing/mtype.ml(265):9738-9790
                                      (apply enrich_typedecl env
                                        (makeblock 1 p
                                          (after typing/mtype.ml(265):9767-9780
                                            (apply (field 14 (global Ident!))
                                              id)))
                                        id decl))
                                    rs priv)))
                             case tag 3:
                              (let
                                (priv =a (field 4 item)
                                 rs =a (field 3 item)
                                 md =a (field 2 item)
                                 pres =a (field 1 item)
                                 id =a (field 0 item))
                                (before typing/mtype.ml(267):9850-10050
                                  (makeblock 3 id pres
                                    (let (init = md)
                                      (makeblock 0
                                        (after typing/mtype.ml(269):9927-10004
                                          (apply enrich_modtype env
                                            (makeblock 1 p
                                              (after typing/mtype.ml(270):9978-9991
                                                (apply
                                                  (field 14 (global Ident!))
                                                  id)))
                                            (field 0 md)))
                                        (field 1 init) (field 2 init)))
                                    rs priv)))
                             default:
                              (before typing/mtype.ml(273):10063-10067 item)))))
                    (letrec
                      (type_paths
                         (function env p mty
                           (funct-body typing/mtype.ml(275)<ghost>:10088-10243
                             (before typing/mtype.ml(276):10102-10243
                               (let
                                 (*match* =
                                    (after typing/mtype.ml(276):10108-10122
                                      (apply scrape env mty)))
                                 (switch* *match*
                                  case tag 0:
                                   (before typing/mtype.ml(277):10147-10149
                                     0a)
                                  case tag 1:
                                   (let (sg =a (field 0 *match*))
                                     (before typing/mtype.ml(279):10196-10219
                                       (after typing/mtype.ml(279):10196-10219
                                         (apply type_paths_sig env p sg))))
                                  case tag 2:
                                   (before typing/mtype.ml(280):10241-10243
                                     0a)
                                  case tag 3:
                                   (before typing/mtype.ml(278):10169-10171
                                     0a))))))
                        type_paths_sig
                          (function env p sg
                            (funct-body typing/mtype.ml(282)<ghost>:10264-10799
                              (before typing/mtype.ml(283):10277-10799
                                (if sg
                                  (let (*match* =a (field 0 sg))
                                    (switch *match*
                                     case tag 1:
                                      (let
                                        (rem =a (field 1 sg)
                                         id =a (field 0 *match*))
                                        (before typing/mtype.ml(286):10350-10400
                                          (makeblock 0
                                            (makeblock 1 p
                                              (after typing/mtype.ml(286):10358-10371
                                                (apply
                                                  (field 14 (global Ident!))
                                                  id)))
                                            (after typing/mtype.ml(286):10376-10400
                                              (apply type_paths_sig env p
                                                rem)))))
                                     case tag 3:
                                      (let
                                        (rem =a (field 1 sg)
                                         md =a (field 2 *match*)
                                         pres =a (field 1 *match*)
                                         id =a (field 0 *match*))
                                        (before typing/mtype.ml(288):10452-10596
                                          (after typing/mtype.ml(288):10452-10596
                                            (apply
                                              (field 36 (global Stdlib!))
                                              (after typing/mtype.ml(288):10452-10502
                                                (apply type_paths env
                                                  (makeblock 1 p
                                                    (after typing/mtype.ml(288):10476-10489
                                                      (apply
                                                        (field 14
                                                          (global Ident!))
                                                        id)))
                                                  (field 0 md)))
                                              (after typing/mtype.ml(289):10511-10596
                                                (apply type_paths_sig
                                                  (after typing/mtype.ml(289):10526-10582
                                                    (apply
                                                      (field 51
                                                        (global Env!))
                                                      0a 0a id pres md env))
                                                  p rem))))))
                                     case tag 4:
                                      (let
                                        (rem =a (field 1 sg)
                                         decl =a (field 1 *match*)
                                         id =a (field 0 *match*))
                                        (before typing/mtype.ml(292):10642-10692
                                          (after typing/mtype.ml(292):10642-10692
                                            (apply type_paths_sig
                                              (after typing/mtype.ml(292):10657-10686
                                                (apply
                                                  (field 52 (global Env!)) id
                                                  decl env))
                                              p rem))))
                                     default:
                                      (let (rem =a (field 1 sg))
                                        (before typing/mtype.ml(294):10775-10799
                                          (after typing/mtype.ml(294):10775-10799
                                            (apply type_paths_sig env p rem))))))
                                  (before typing/mtype.ml(284):10301-10303
                                    0a))))))
                      (letrec
                        (no_code_needed_mod
                           (function env pres mty
                             (funct-body typing/mtype.ml(297)<ghost>:10829-11090
                               (before typing/mtype.ml(298):10846-11090
                                 (if pres
                                   (before typing/mtype.ml(299):10879-10883
                                     1a)
                                   (before typing/mtype.ml(300):10902-11090
                                     (let
                                       (*match* =
                                          (after typing/mtype.ml(301):10920-10934
                                            (apply scrape env mty)))
                                       (switch* *match*
                                        case tag 0:
                                         (before typing/mtype.ml(302):10963-10968
                                           0a)
                                        case tag 1:
                                         (let (sg =a (field 0 *match*))
                                           (before typing/mtype.ml(303):10997-11022
                                             (after typing/mtype.ml(303):10997-11022
                                               (apply no_code_needed_sig env
                                                 sg))))
                                        case tag 2:
                                         (before typing/mtype.ml(304):11048-11053
                                           0a)
                                        case tag 3:
                                         (before typing/mtype.ml(305):11077-11082
                                           0a))))))))
                          no_code_needed_sig
                            (function env sg
                              (funct-body typing/mtype.ml(308)<ghost>:11115-11642
                                (before typing/mtype.ml(309):11126-11642
                                  (if sg
                                    (let (*match* =a (field 0 sg))
                                      (catch
                                        (switch *match*
                                         case tag 0:
                                          (let
                                            (rem =a (field 1 sg)
                                             decl =a (field 1 *match*))
                                            (before typing/mtype.ml(312):11199-11307
                                              (let (*match* = (field 1 decl))
                                                (catch
                                                  (switch *match*
                                                   case tag 0:
                                                    (before typing/mtype.ml(313):11252-11278
                                                      (after typing/mtype.ml(313):11252-11278
                                                        (apply
                                                          no_code_needed_sig
                                                          env rem)))
                                                   default: (exit 33))
                                                 with (33)
                                                  (before typing/mtype.ml(314):11292-11297
                                                    0a)))))
                                         case tag 2: (exit 35)
                                         case tag 3:
                                          (let
                                            (rem =a (field 1 sg)
                                             md =a (field 2 *match*)
                                             pres =a (field 1 *match*)
                                             id =a (field 0 *match*))
                                            (before typing/mtype.ml(317):11359-11494
                                              (&&
                                                (after typing/mtype.ml(317):11359-11397
                                                  (apply no_code_needed_mod
                                                    env pres (field 0 md)))
                                                (after typing/mtype.ml(318):11407-11494
                                                  (apply no_code_needed_sig
                                                    (after typing/mtype.ml(319):11434-11490
                                                      (apply
                                                        (field 51
                                                          (global Env!))
                                                        0a 0a id pres md env))
                                                    rem)))))
                                         case tag 5: (exit 35)
                                         default:
                                          (let (rem =a (field 1 sg))
                                            (before typing/mtype.ml(321):11563-11589
                                              (after typing/mtype.ml(321):11563-11589
                                                (apply no_code_needed_sig env
                                                  rem)))))
                                       with (35)
                                        (before typing/mtype.ml(323):11637-11642
                                          0a)))
                                    (before typing/mtype.ml(310):11150-11154
                                      1a))))))
                        (let
                          (no_code_needed =
                             (function env mty
                               (funct-body typing/mtype.ml(325)<ghost>:11663-11710
                                 (before typing/mtype.ml(325):11673-11710
                                   (after typing/mtype.ml(325):11673-11710
                                     (apply no_code_needed_mod env 0a mty))))))
                          (letrec
                            (contains_type
                               (function env param
                                 (funct-body typing/mtype.ml(329)<ghost>:11786-12158
                                   (switch* param
                                    case tag 0:
                                     (let (path =a (field 0 param))
                                       (before typing/mtype.ml(331):11829-12014
                                         (try
                                           (let
                                             (*match* =
                                                (field 0
                                                  (after typing/mtype.ml(331):11845-11872
                                                    (apply
                                                      (field 15
                                                        (global Env!))
                                                      path env))))
                                             (if *match*
                                               (let
                                                 (mty =a (field 0 *match*))
                                                 (before typing/mtype.ml(333):11948-11969
                                                   (after typing/mtype.ml(333):11948-11969
                                                     (apply contains_type env
                                                       mty))))
                                               (before typing/mtype.ml(332):11903-11913
                                                 (raise
                                                   (after typing/mtype.ml(332):11909-11913
                                                     (field 2
                                                       (global Stdlib!)))))))
                                          with exn
                                           (if
                                             (== exn
                                               (field 7 (global Stdlib!)))
                                             (before typing/mtype.ml(334):11994-12004
                                               (raise
                                                 (after typing/mtype.ml(334):12000-12004
                                                   (field 2 (global Stdlib!)))))
                                             (reraise exn)))))
                                    case tag 1:
                                     (let (sg =a (field 0 param))
                                       (before typing/mtype.ml(337):12045-12069
                                         (after typing/mtype.ml(337):12045-12069
                                           (apply contains_type_sig env sg))))
                                    case tag 2:
                                     (let (body =a (field 2 param))
                                       (before typing/mtype.ml(339):12108-12130
                                         (after typing/mtype.ml(339):12108-12130
                                           (apply contains_type env body))))
                                    case tag 3:
                                     (before typing/mtype.ml(341):12156-12158
                                       0a))))
                              contains_type_sig
                                (function env
                                  (funct-body typing/mtype.ml(343)<ghost>:12182-12222
                                    (before typing/mtype.ml(343):12188-12222
                                      (after typing/mtype.ml(343):12188-12222
                                        (apply
                                          (field 14 (global Stdlib__list!))
                                          (after typing/mtype.ml(343):12198-12222
                                            (apply contains_type_item env)))))))
                              contains_type_item
                                (function env param
                                  (funct-body typing/mtype.ml(345)<ghost>:12247-12944
                                    (catch
                                      (catch
                                        (switch param
                                         case tag 1:
                                          (let (*match* =a (field 1 param))
                                            (catch
                                              (let
                                                (*match* =a (field 2 *match*))
                                                (catch
                                                  (if (isint *match*)
                                                    (if *match* (exit 41)
                                                      (let
                                                        (*match* =a
                                                           (field 3 *match*))
                                                        (if *match* (exit 41)
                                                          (exit 40))))
                                                    (exit 41))
                                                 with (41)
                                                  (let
                                                    (*match* =a
                                                       (field 4 *match*))
                                                    (if *match* (exit 38)
                                                      (exit 40)))))
                                             with (40) (exit 37)))
                                         case tag 2:
                                          (let
                                            (*match* =a (field 1 param)
                                             *match* =a (field 2 *match*))
                                            (switch* *match*
                                             case tag 0: (exit 38)
                                             case tag 1: (exit 37)))
                                         case tag 3:
                                          (let
                                            (*match* =a (field 2 param)
                                             mty =a (field 0 *match*))
                                            (before typing/mtype.ml(357):12826-12847
                                              (after typing/mtype.ml(357):12826-12847
                                                (apply contains_type env mty))))
                                         case tag 4: (exit 37)
                                         default: (exit 38))
                                       with (37)
                                        (before typing/mtype.ml(355):12761-12771
                                          (raise
                                            (after typing/mtype.ml(355):12767-12771
                                              (field 2 (global Stdlib!))))))
                                     with (38)
                                      (before typing/mtype.ml(363):12942-12944
                                        0a)))))
                            (let
                              (contains_type =
                                 (function env mty
                                   (funct-body typing/mtype.ml(365)<ghost>:12964-13026
                                     (before typing/mtype.ml(366):12976-13026
                                       (try
                                         (seq
                                           (after typing/mtype.ml(366):12980-13001
                                             (apply contains_type env mty))
                                           (before typing/mtype.ml(366):13003-13008
                                             0a))
                                        with exn
                                         (if
                                           (== exn
                                             (field 2 (global Stdlib!)))
                                           (before typing/mtype.ml(366):13022-13026
                                             1a)
                                           (reraise exn)))))))
                              (letrec
                                (get_prefixes
                                   (function param
                                     (funct-body typing/mtype.ml(371):13098-13206
                                       (catch
                                         (switch* param
                                          case tag 0:
                                           (before typing/mtype.ml(372):13123-13137
                                             (field 0
                                               (field 14 (global Path!))))
                                          case tag 1: (exit 45)
                                          case tag 2: (exit 45))
                                        with (45)
                                         (let (p =a (field 0 param) p = p)
                                           (before typing/mtype.ml(374):13175-13206
                                             (after typing/mtype.ml(374):13175-13206
                                               (apply
                                                 (field 3
                                                   (field 14 (global Path!)))
                                                 p
                                                 (after typing/mtype.ml(374):13190-13206
                                                   (apply get_prefixes p))))))))))
                                (letrec
                                  (get_arg_paths
                                     (function param
                                       (funct-body typing/mtype.ml(376):13232-13460
                                         (switch* param
                                          case tag 0:
                                           (before typing/mtype.ml(377):13257-13271
                                             (field 0
                                               (field 14 (global Path!))))
                                          case tag 1:
                                           (let (p =a (field 0 param))
                                             (before typing/mtype.ml(378):13291-13306
                                               (after typing/mtype.ml(378):13291-13306
                                                 (apply get_arg_paths p))))
                                          case tag 2:
                                           (let
                                             (p2 =a (field 1 param)
                                              p1 =a (field 0 param))
                                             (before typing/mtype.ml(380):13336-13460
                                               (after typing/mtype.ml(380):13336-13460
                                                 (apply
                                                   (field 3
                                                     (field 14
                                                       (global Path!)))
                                                   p2
                                                   (after typing/mtype.ml(381):13360-13460
                                                     (apply
                                                       (field 6
                                                         (field 14
                                                           (global Path!)))
                                                       (after typing/mtype.ml(381):13376-13393
                                                         (apply get_prefixes
                                                           p2))
                                                       (after typing/mtype.ml(382):13405-13459
                                                         (apply
                                                           (field 6
                                                             (field 14
                                                               (global Path!)))
                                                           (after typing/mtype.ml(382):13421-13439
                                                             (apply
                                                               get_arg_paths
                                                               p1))
                                                           (after typing/mtype.ml(382):13440-13458
                                                             (apply
                                                               get_arg_paths
                                                               p2))))))))))))))
                                  (letrec
                                    (rollback_path
                                       (function subst p
                                         (funct-body typing/mtype.ml(384)<ghost>:13484-13740
                                           (before typing/mtype.ml(385):13496-13740
                                             (try
                                               (makeblock 0
                                                 (after typing/mtype.ml(385):13507-13530
                                                   (apply
                                                     (field 26
                                                       (field 13
                                                         (global Path!)))
                                                     p subst)))
                                              with exn
                                               (if
                                                 (== exn
                                                   (field 7 (global Stdlib!)))
                                                 (before typing/mtype.ml(387):13555-13740
                                                   (catch
                                                     (switch* p
                                                      case tag 0: (exit 46)
                                                      case tag 1:
                                                       (let
                                                         (s =a (field 1 p)
                                                          p1 =a (field 0 p))
                                                         (before typing/mtype.ml(390):13629-13740
                                                           (let
                                                             (p1' =
                                                                (after typing/mtype.ml(390):13639-13661
                                                                  (apply
                                                                    rollback_path
                                                                    subst p1)))
                                                             (before typing/mtype.ml(391):13673-13740
                                                               (if
                                                                 (after typing/mtype.ml(391):13676-13692
                                                                   (apply
                                                                    (field 0
                                                                    (global Path!))
                                                                    p1 p1'))
                                                                 (before typing/mtype.ml(391):13698-13699
                                                                   p)
                                                                 (before typing/mtype.ml(391):13705-13740
                                                                   (after typing/mtype.ml(391):13705-13740
                                                                    (apply
                                                                    rollback_path
                                                                    subst
                                                                    (makeblock 1
                                                                    p1' s)))))))))
                                                      case tag 2: (exit 46))
                                                    with (46)
                                                     (before typing/mtype.ml(388):13597-13598
                                                       p)))
                                                 (reraise exn)))))))
                                    (letrec
                                      (collect_ids
                                         (function subst bindings p
                                           (funct-body typing/mtype.ml(393)<ghost>:13762-14050
                                             (before typing/mtype.ml(394):13785-14050
                                               (let
                                                 (*match* =
                                                    (after typing/mtype.ml(394):13797-13818
                                                      (apply rollback_path
                                                        subst p)))
                                                 (catch
                                                   (switch* *match*
                                                    case tag 0:
                                                     (let
                                                       (id =a
                                                          (field 0 *match*))
                                                       (before typing/mtype.ml(396):13851-14015
                                                         (let
                                                           (ids =
                                                              (try
                                                                (after typing/mtype.ml(397):13875-13931
                                                                  (apply
                                                                    collect_ids
                                                                    subst
                                                                    bindings
                                                                    (after typing/mtype.ml(397):13902-13931
                                                                    (apply
                                                                    (field 28
                                                                    (global Ident!))
                                                                    id
                                                                    bindings))))
                                                               with exn
                                                                (if
                                                                  (== exn
                                                                    (field 7
                                                                    (global Stdlib!)))
                                                                  (before typing/mtype.ml(398):13960-13975
                                                                    (field 0
                                                                    (field 5
                                                                    (global Ident!))))
                                                                  (reraise
                                                                    exn))))
                                                           (before typing/mtype.ml(400):13995-14015
                                                             (after typing/mtype.ml(400):13995-14015
                                                               (apply
                                                                 (field 3
                                                                   (field 5
                                                                    (global Ident!)))
                                                                 id ids))))))
                                                    case tag 1: (exit 49)
                                                    case tag 2: (exit 49))
                                                  with (49)
                                                   (before typing/mtype.ml(401):14027-14042
                                                     (field 0
                                                       (field 5
                                                         (global Ident!))))))))))
                                      (let
                                        (collect_arg_paths =
                                           (function mty
                                             (funct-body typing/mtype.ml(404)<ghost>:14074-15067
                                               (before typing/mtype.ml(405):14082-15067
                                                 (let
                                                   (paths =
                                                      (makemutable 0
                                                        (field 0
                                                          (field 14
                                                            (global Path!))))
                                                    subst =
                                                      (makemutable 0
                                                        (field 0
                                                          (field 13
                                                            (global Path!))))
                                                    bindings =
                                                      (makemutable 0
                                                        (field 26
                                                          (global Ident!))))
                                                   (before typing/mtype.ml(411):14286-15067
                                                     (let
                                                       (it_path =
                                                          (function p
                                                            (funct-body typing/mtype.ml(411)<ghost>:14298-14350
                                                              (before typing/mtype.ml(411):14302-14350
                                                                (setfield_ptr 0
                                                                  paths
                                                                  (after typing/mtype.ml(411):14311-14350
                                                                    (apply
                                                                    (field 6
                                                                    (field 14
                                                                    (global Path!)))
                                                                    (after typing/mtype.ml(411):14326-14343
                                                                    (apply
                                                                    get_arg_paths
                                                                    p))
                                                                    (field 0
                                                                    paths)))))))
                                                        it_signature_item =
                                                          (function it si
                                                            (funct-body typing/mtype.ml(412)<ghost>:14375-14826
                                                              (before typing/mtype.ml(413):14387-14826
                                                                (seq
                                                                  (after typing/mtype.ml(413):14387-14425
                                                                    (apply
                                                                    (field 1
                                                                    (field 32
                                                                    (global Btype!)))
                                                                    it si))
                                                                  (before typing/mtype.ml(414):14431-14826
                                                                    (catch
                                                                    (switch si
                                                                    case tag 3:
                                                                    (let
                                                                    (*match* =a
                                                                    (field 2
                                                                    si)
                                                                    *match* =a
                                                                    (field 0
                                                                    *match*)
                                                                    id =a
                                                                    (field 0
                                                                    si))
                                                                    (switch* *match*
                                                                    case tag 0:
                                                                    (exit 51)
                                                                    case tag 1:
                                                                    (let
                                                                    (id =a id
                                                                    sg =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/mtype.ml(418):14617-14812
                                                                    (after typing/mtype.ml(418):14617-14812
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/mtype.ml(419):14637-14799
                                                                    (switch param
                                                                    case tag 3:
                                                                    (let
                                                                    (id' =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/mtype.ml(420):14693-14776
                                                                    (setfield_ptr 0
                                                                    subst
                                                                    (after typing/mtype.ml(421):14718-14776
                                                                    (apply
                                                                    (field 3
                                                                    (field 13
                                                                    (global Path!)))
                                                                    (makeblock 1
                                                                    (makeblock 0
                                                                    id)
                                                                    (after typing/mtype.ml(421):14749-14763
                                                                    (apply
                                                                    (field 14
                                                                    (global Ident!))
                                                                    id')))
                                                                    id'
                                                                    (field 0
                                                                    subst))))))
                                                                    default:
                                                                    (before typing/mtype.ml(422):14796-14798
                                                                    0a))))
                                                                    sg))))
                                                                    case tag 2:
                                                                    (exit 51)
                                                                    case tag 3:
                                                                    (let
                                                                    (p =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/mtype.ml(416):14510-14546
                                                                    (setfield_ptr 0
                                                                    bindings
                                                                    (after typing/mtype.ml(416):14522-14546
                                                                    (apply
                                                                    (field 27
                                                                    (global Ident!))
                                                                    id p
                                                                    (field 0
                                                                    bindings))))))))
                                                                    default:
                                                                    (exit 51))
                                                                    with (51)
                                                                    (before typing/mtype.ml(424):14824-14826
                                                                    0a))))))))
                                                       (before typing/mtype.ml(426):14834-15067
                                                         (let
                                                           (it =
                                                              (let
                                                                (init =
                                                                   (field 32
                                                                    (global Btype!)))
                                                                (makeblock 0
                                                                  (field 0
                                                                    init)
                                                                  it_signature_item
                                                                  (field 2
                                                                    init)
                                                                  (field 3
                                                                    init)
                                                                  (field 4
                                                                    init)
                                                                  (field 5
                                                                    init)
                                                                  (field 6
                                                                    init)
                                                                  (field 7
                                                                    init)
                                                                  (field 8
                                                                    init)
                                                                  (field 9
                                                                    init)
                                                                  (field 10
                                                                    init)
                                                                  (field 11
                                                                    init)
                                                                  (field 12
                                                                    init)
                                                                  (field 13
                                                                    init)
                                                                  it_path)))
                                                           (before typing/mtype.ml(427):14897-15067
                                                             (seq
                                                               (after typing/mtype.ml(427):14897-14921
                                                                 (apply
                                                                   (field 9
                                                                    it)
                                                                   it mty))
                                                               (before typing/mtype.ml(428):14925-15067
                                                                 (seq
                                                                   (after typing/mtype.ml(428):14925-14963
                                                                    (apply
                                                                    (field 9
                                                                    it)
                                                                    (field 33
                                                                    (global Btype!))
                                                                    mty))
                                                                   (before typing/mtype.ml(429):14967-15067
                                                                    (after typing/mtype.ml(429):14967-15067
                                                                    (apply
                                                                    (field 15
                                                                    (field 14
                                                                    (global Path!)))
                                                                    (function
                                                                    p
                                                                    (funct-body typing/mtype.ml(429):14981-15040
                                                                    (before typing/mtype.ml(429):14991-15039
                                                                    (after typing/mtype.ml(429):14991-15039
                                                                    (apply
                                                                    (field 6
                                                                    (field 5
                                                                    (global Ident!)))
                                                                    (after typing/mtype.ml(429):15007-15039
                                                                    (apply
                                                                    collect_ids
                                                                    (field 0
                                                                    subst)
                                                                    (field 0
                                                                    bindings)
                                                                    p)))))))
                                                                    (field 0
                                                                    paths)
                                                                    (field 0
                                                                    (field 5
                                                                    (global Ident!)))))))))))))))))))
                                        (letrec
                                          (remove_aliases_mty
                                             (function env args pres mty
                                               (funct-body typing/mtype.ml(437)<ghost>:15246-15842
                                                 (before typing/mtype.ml(438):15268-15842
                                                   (let
                                                     (args' =
                                                        (let (init = args)
                                                          (makemutable 0 0a
                                                            (field 1 init)
                                                            (field 2 init))))
                                                     (before typing/mtype.ml(439):15314-15842
                                                       (let
                                                         (res =
                                                            (let
                                                              (mty =
                                                                 (after typing/mtype.ml(440):15334-15353
                                                                   (apply
                                                                    (field 2
                                                                    args) env
                                                                    mty)))
                                                              (catch
                                                                (switch* mty
                                                                 case tag 0:
                                                                  (exit 52)
                                                                 case tag 1:
                                                                  (let
                                                                    (sg =a
                                                                    (field 0
                                                                    mty))
                                                                    (before typing/mtype.ml(442):15393-15452
                                                                    (makeblock 0
                                                                    0a
                                                                    (makeblock 1
                                                                    (after typing/mtype.ml(442):15419-15452
                                                                    (apply
                                                                    remove_aliases_sig
                                                                    env args'
                                                                    sg))))))
                                                                 case tag 2:
                                                                  (exit 52)
                                                                 case tag 3:
                                                                  (before typing/mtype.ml(444):15482-15697
                                                                    (let
                                                                    (mty' =
                                                                    (after typing/mtype.ml(444):15493-15517
                                                                    (apply
                                                                    (field 111
                                                                    (global Env!))
                                                                    env mty)))
                                                                    (before typing/mtype.ml(445):15529-15697
                                                                    (if
                                                                    (after typing/mtype.ml(445):15532-15542
                                                                    (caml_equal
                                                                    mty' mty))
                                                                    (before typing/mtype.ml(445):15548-15585
                                                                    (makeblock 0
                                                                    pres mty))
                                                                    (before typing/mtype.ml(447):15591-15697
                                                                    (seq
                                                                    (setfield_imm 0
                                                                    args' 1a)
                                                                    (before typing/mtype.ml(449):15641-15685
                                                                    (after typing/mtype.ml(449):15641-15685
                                                                    (apply
                                                                    remove_aliases_mty
                                                                    env args'
                                                                    0a mty'))))))))))
                                                               with (52)
                                                                (before typing/mtype.ml(452):15719-15734
                                                                  (makeblock 0
                                                                    0a mty)))))
                                                         (before typing/mtype.ml(454):15742-15842
                                                           (if
                                                             (field 0 args')
                                                             (before typing/mtype.ml(454):15765-15811
                                                               (seq
                                                                 (setfield_imm 0
                                                                   args 1a)
                                                                 (before typing/mtype.ml(456):15802-15805
                                                                   res)))
                                                             (before typing/mtype.ml(457):15817-15842
                                                               (makeblock 0
                                                                 pres mty))))))))))
                                            remove_aliases_sig
                                              (function env args sg
                                                (funct-body typing/mtype.ml(461)<ghost>:15867-16497
                                                  (before typing/mtype.ml(462):15883-16497
                                                    (if sg
                                                      (let
                                                        (it =a (field 0 sg))
                                                        (switch it
                                                         case tag 3:
                                                          (let
                                                            (rem =a
                                                               (field 1 sg)
                                                             priv =a
                                                               (field 4 it)
                                                             rs =a
                                                               (field 3 it)
                                                             md =a
                                                               (field 2 it)
                                                             pres =a
                                                               (field 1 it)
                                                             id =a
                                                               (field 0 it))
                                                            (before typing/mtype.ml(465):15966-16296
                                                              (let
                                                                (*match* =
                                                                   (let
                                                                    (mty =
                                                                    (field 0
                                                                    md))
                                                                    (catch
                                                                    (switch mty
                                                                    case tag 3:
                                                                    (let
                                                                    (p =a
                                                                    (field 0
                                                                    mty))
                                                                    (before typing/mtype.ml(467):16039-16056
                                                                    (if
                                                                    (after typing/mtype.ml(467):16039-16056
                                                                    (apply
                                                                    (field 1
                                                                    args) id
                                                                    p))
                                                                    (before typing/mtype.ml(468):16072-16088
                                                                    (makeblock 0
                                                                    pres
                                                                    (field 0
                                                                    md)))
                                                                    (exit 53))))
                                                                    default:
                                                                    (exit 53))
                                                                    with (53)
                                                                    (before typing/mtype.ml(470):16118-16154
                                                                    (after typing/mtype.ml(470):16118-16154
                                                                    (apply
                                                                    remove_aliases_mty
                                                                    env args
                                                                    pres mty)))))
                                                                 mty =a
                                                                   (field 1
                                                                    *match*)
                                                                 pres =a
                                                                   (field 0
                                                                    *match*))
                                                                (before typing/mtype.ml(472):16170-16296
                                                                  (makeblock 0
                                                                    (makeblock 3
                                                                    id pres
                                                                    (let
                                                                    (init =
                                                                    md)
                                                                    (makeblock 0
                                                                    mty
                                                                    (field 1
                                                                    init)
                                                                    (field 2
                                                                    init)))
                                                                    rs priv)
                                                                    (after typing/mtype.ml(473):16236-16296
                                                                    (apply
                                                                    remove_aliases_sig
                                                                    (after typing/mtype.ml(473):16255-16287
                                                                    (apply
                                                                    (field 50
                                                                    (global Env!))
                                                                    0a id
                                                                    pres mty
                                                                    env))
                                                                    args rem)))))))
                                                         case tag 4:
                                                          (let
                                                            (rem =a
                                                               (field 1 sg)
                                                             priv =a
                                                               (field 2 it)
                                                             mtd =a
                                                               (field 1 it)
                                                             id =a
                                                               (field 0 it))
                                                            (before typing/mtype.ml(475):16344-16436
                                                              (makeblock 0
                                                                (makeblock 4
                                                                  id mtd
                                                                  priv)
                                                                (after typing/mtype.ml(476):16380-16436
                                                                  (apply
                                                                    remove_aliases_sig
                                                                    (after typing/mtype.ml(476):16399-16427
                                                                    (apply
                                                                    (field 52
                                                                    (global Env!))
                                                                    id mtd
                                                                    env))
                                                                    args rem)))))
                                                         default:
                                                          (let
                                                            (rem =a
                                                               (field 1 sg))
                                                            (before typing/mtype.ml(478):16460-16497
                                                              (makeblock 0 it
                                                                (after typing/mtype.ml(478):16466-16497
                                                                  (apply
                                                                    remove_aliases_sig
                                                                    env args
                                                                    rem)))))))
                                                      (before typing/mtype.ml(463):15907-15909
                                                        0a))))))
                                          (let
                                            (scrape_for_functor_arg =
                                               (function env mty
                                                 (funct-body typing/mtype.ml(480)<ghost>:16526-16733
                                                   (before typing/mtype.ml(481):16538-16733
                                                     (let
                                                       (exclude =
                                                          (function _id p
                                                            (funct-body typing/mtype.ml(481)<ghost>:16550-16626
                                                              (before typing/mtype.ml(482):16562-16626
                                                                (try
                                                                  (seq
                                                                    (ignore
                                                                    (after typing/mtype.ml(482):16573-16596
                                                                    (apply
                                                                    (field 14
                                                                    (global Env!))
                                                                    p env)))
                                                                    (before typing/mtype.ml(482):16598-16602
                                                                    1a))
                                                                 with exn
                                                                  (if
                                                                    (== exn
                                                                    (field 7
                                                                    (global Stdlib!)))
                                                                    (before typing/mtype.ml(482):16621-16626
                                                                    0a)
                                                                    (reraise
                                                                    exn)))))))
                                                       (before typing/mtype.ml(484):16634-16733
                                                         (let
                                                           (*match* =
                                                              (after typing/mtype.ml(485):16651-16722
                                                                (apply
                                                                  remove_aliases_mty
                                                                  env
                                                                  (makemutable 0
                                                                    0a
                                                                    exclude
                                                                    scrape)
                                                                  0a mty))
                                                            mty =a
                                                              (field 1
                                                                *match*))
                                                           (before typing/mtype.ml(487):16730-16733
                                                             mty)))))))
                                             scrape_for_type_of =
                                               (function remove_aliases env
                                                 mty
                                                 (funct-body typing/mtype.ml(489)<ghost>:16758-17132
                                                   (before typing/mtype.ml(490):16786-17132
                                                     (if remove_aliases
                                                       (before typing/mtype.ml(490):16809-17049
                                                         (let
                                                           (excl =
                                                              (after typing/mtype.ml(491):16830-16851
                                                                (apply
                                                                  collect_arg_paths
                                                                  mty)))
                                                           (before typing/mtype.ml(492):16859-17043
                                                             (let
                                                               (exclude =
                                                                  (function
                                                                    id _p
                                                                    (funct-body typing/mtype.ml(492)<ghost>:16871-16900
                                                                    (before typing/mtype.ml(492):16879-16900
                                                                    (after typing/mtype.ml(492):16879-16900
                                                                    (apply
                                                                    (field 2
                                                                    (field 5
                                                                    (global Ident!)))
                                                                    id excl))))))
                                                               (before typing/mtype.ml(493):16908-17043
                                                                 (let
                                                                   (scrape =
                                                                    (function
                                                                    param mty
                                                                    (funct-body typing/mtype.ml(493)<ghost>:16919-16930
                                                                    (before typing/mtype.ml(493):16927-16930
                                                                    mty))))
                                                                   (before typing/mtype.ml(494):16938-17043
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/mtype.ml(495):16957-17028
                                                                    (apply
                                                                    remove_aliases_mty
                                                                    env
                                                                    (makemutable 0
                                                                    0a
                                                                    exclude
                                                                    scrape)
                                                                    0a mty))
                                                                    mty =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/mtype.ml(497):17040-17043
                                                                    mty)))))))))
                                                       (before typing/mtype.ml(498):17055-17132
                                                         (let
                                                           (*match* =
                                                              (after typing/mtype.ml(499):17078-17115
                                                                (apply
                                                                  scrape_for_type_of
                                                                  env 0a mty))
                                                            mty =a
                                                              (field 1
                                                                *match*))
                                                           (before typing/mtype.ml(500):17123-17126
                                                             mty)))))))
                                             lower_nongen =
                                               (function nglev[int] mty
                                                 (funct-body typing/mtype.ml(505)<ghost>:17197-17577
                                                   (before typing/mtype.ml(506):17211-17577
                                                     (let
                                                       (it_type_expr =
                                                          (function it ty
                                                            (funct-body typing/mtype.ml(507)<ghost>:17248-17454
                                                              (before typing/mtype.ml(508):17260-17454
                                                                (let
                                                                  (ty =
                                                                    (after typing/mtype.ml(508):17269-17276
                                                                    (apply
                                                                    (field 12
                                                                    (global Btype!))
                                                                    ty)))
                                                                  (before typing/mtype.ml(509):17284-17454
                                                                    (let
                                                                    (*match* =o
                                                                    (field 0
                                                                    ty))
                                                                    (catch
                                                                    (switch *match*
                                                                    case tag 0:
                                                                    (let
                                                                    (level =o
                                                                    (field 1
                                                                    ty))
                                                                    (before typing/mtype.ml(511):17336-17401
                                                                    (if
                                                                    (&&
                                                                    (< level
                                                                    (field 3
                                                                    (global Btype!)))
                                                                    (> level
                                                                    nglev))
                                                                    (before typing/mtype.ml(511):17383-17401
                                                                    (after typing/mtype.ml(511):17383-17401
                                                                    (apply
                                                                    (field 60
                                                                    (global Btype!))
                                                                    ty nglev)))
                                                                    0a)))
                                                                    default:
                                                                    (exit 69))
                                                                    with (69)
                                                                    (before typing/mtype.ml(513):17421-17454
                                                                    (after typing/mtype.ml(513):17421-17454
                                                                    (apply
                                                                    (field 13
                                                                    (field 32
                                                                    (global Btype!)))
                                                                    it ty)))))))))))
                                                       (before typing/mtype.ml(515):17462-17577
                                                         (let
                                                           (it =
                                                              (let
                                                                (init =
                                                                   (field 32
                                                                    (global Btype!)))
                                                                (makeblock 0
                                                                  (field 0
                                                                    init)
                                                                  (field 1
                                                                    init)
                                                                  (field 2
                                                                    init)
                                                                  (field 3
                                                                    init)
                                                                  (field 4
                                                                    init)
                                                                  (field 5
                                                                    init)
                                                                  (field 6
                                                                    init)
                                                                  (field 7
                                                                    init)
                                                                  (field 8
                                                                    init)
                                                                  (field 9
                                                                    init)
                                                                  (field 10
                                                                    init)
                                                                  (field 11
                                                                    init)
                                                                  (field 12
                                                                    init)
                                                                  it_type_expr
                                                                  (field 14
                                                                    init))))
                                                           (before typing/mtype.ml(516):17511-17577
                                                             (seq
                                                               (after typing/mtype.ml(516):17511-17535
                                                                 (apply
                                                                   (field 9
                                                                    it)
                                                                   it mty))
                                                               (before typing/mtype.ml(517):17539-17577
                                                                 (after typing/mtype.ml(517):17539-17577
                                                                   (apply
                                                                    (field 9
                                                                    it)
                                                                    (field 33
                                                                    (global Btype!))
                                                                    mty))))))))))))
                                            (pseudo _none_(0)<ghost>:-1--1
                                              (makeblock 0 scrape
                                                scrape_for_functor_arg
                                                scrape_for_type_of freshen
                                                strengthen strengthen_decl
                                                nondep_supertype
                                                nondep_sig_item
                                                no_code_needed
                                                no_code_needed_sig
                                                enrich_modtype
                                                enrich_typedecl type_paths
                                                contains_type lower_nongen))))))))))))))))))))))))
