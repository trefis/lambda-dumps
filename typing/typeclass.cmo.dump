(setglobal Typeclass!
  (let
    (Error = (makeblock 248 "Typeclass.Error" (caml_fresh_oo_id 0))
     Error_forward =
       (makeblock 248 "Typeclass.Error_forward" (caml_fresh_oo_id 0))
     type_open_descr =
       (makemutable 0
         (function param param
           (funct-body typing/typeclass.ml(104):3704-3740
             (before typing/typeclass.ml(104):3727-3739
               (raise
                 (after typing/typeclass.ml(104):3727-3739
                   (makeblock 0 (global Assert_failure!)
                     [0: "typing/typeclass.ml" 104 29])))))))
     ctyp =
       (function desc typ env loc
         (funct-body typing/typeclass.ml(106)<ghost>:3751-3867
           (before typing/typeclass.ml(107):3772-3867
             (makemutable 0 desc typ env loc 0a))))
     dummy_method = (field 10 (global Btype!))
     unbound_class =
       (makeblock 0
         (after typing/typeclass.ml(126):4291-4321
           (apply (field 10 (global Ident!)) "*undef*"))))
    (letrec
      (scrape_class_type
         (function cty
           (funct-body typing/typeclass.ml(136):4565-4660
             (catch
               (switch* cty
                case tag 0:
                 (let (cty =a (field 2 cty))
                   (before typing/typeclass.ml(137):4604-4625
                     (after typing/typeclass.ml(137):4604-4625
                       (apply scrape_class_type cty))))
                case tag 1: (exit 1)
                case tag 2: (exit 1))
              with (1) (before typing/typeclass.ml(138):4657-4660 cty)))))
      (letrec
        (generalize_class_type
           (function gen param
             (funct-body typing/typeclass.ml(141)<ghost>:4722-5115
               (switch* param
                case tag 0:
                 (let (cty =a (field 2 param) params =a (field 1 param))
                   (before typing/typeclass.ml(144):4780-4837
                     (seq
                       (after typing/typeclass.ml(144):4780-4800
                         (apply (field 14 (global Stdlib__list!)) gen params))
                       (before typing/typeclass.ml(145):4808-4837
                         (after typing/typeclass.ml(145):4808-4837
                           (apply generalize_class_type gen cty))))))
                case tag 1:
                 (let
                   (*match* =a (field 0 param)
                    inher =a (field 3 *match*)
                    vars =a (field 1 *match*)
                    sty =a (field 0 *match*))
                   (before typing/typeclass.ml(147):4921-5035
                     (seq
                       (after typing/typeclass.ml(147):4921-4928
                         (apply gen sty))
                       (before typing/typeclass.ml(148):4936-5035
                         (seq
                           (after typing/typeclass.ml(148):4936-4979
                             (apply (field 11 (field 2 (global Types!)))
                               (function param param
                                 (funct-body typing/typeclass.ml(148):4946-4974
                                   (let (ty =a (field 2 param))
                                     (before typing/typeclass.ml(148):4967-4973
                                       (after typing/typeclass.ml(148):4967-4973
                                         (apply gen ty))))))
                               vars))
                           (before typing/typeclass.ml(149):4987-5035
                             (after typing/typeclass.ml(149):4987-5035
                               (apply (field 14 (global Stdlib__list!))
                                 (function param
                                   (funct-body typing/typeclass.ml(149):4997-5029
                                     (let (tl =a (field 1 param))
                                       (before typing/typeclass.ml(149):5012-5028
                                         (after typing/typeclass.ml(149):5012-5028
                                           (apply
                                             (field 14
                                               (global Stdlib__list!))
                                             gen tl))))))
                                 inher))))))))
                case tag 2:
                 (let (cty =a (field 2 param) ty =a (field 1 param))
                   (before typing/typeclass.ml(151):5072-5115
                     (seq
                       (after typing/typeclass.ml(151):5072-5078
                         (apply gen ty))
                       (before typing/typeclass.ml(152):5086-5115
                         (after typing/typeclass.ml(152):5086-5115
                           (apply generalize_class_type gen cty))))))))))
        (let
          (generalize_class_type =
             (function vars
               (funct-body typing/typeclass.ml(154)<ghost>:5143-5254
                 (before typing/typeclass.ml(155):5152-5254
                   (let
                     (gen =
                        (if vars
                          (before typing/typeclass.ml(155):5175-5191
                            (field 39 (global Ctype!)))
                          (before typing/typeclass.ml(155):5197-5223
                            (field 41 (global Ctype!)))))
                     (before typing/typeclass.ml(156):5229-5254
                       (after typing/typeclass.ml(156):5229-5254
                         (apply generalize_class_type gen)))))))
           virtual_methods =
             (function sign
               (funct-body typing/typeclass.ml(159)<ghost>:5325-5601
                 (before typing/typeclass.ml(160):5334-5601
                   (let
                     (*match* =
                        (after typing/typeclass.ml(161):5356-5419
                          (apply (field 26 (global Ctype!))
                            (after typing/typeclass.ml(161):5377-5419
                              (apply (field 25 (global Ctype!))
                                (field 0 sign)))))
                      fields =a (field 0 *match*))
                     (before typing/typeclass.ml(163):5427-5601
                       (after typing/typeclass.ml(163):5427-5601
                         (apply (field 20 (global Stdlib__list!))
                           (function virt param
                             (funct-body typing/typeclass.ml(164):5446-5587
                               (let (lab =a (field 0 param))
                                 (before typing/typeclass.ml(165):5478-5586
                                   (if
                                     (after typing/typeclass.ml(165):5481-5499
                                       (caml_string_equal lab dummy_method))
                                     (before typing/typeclass.ml(165):5505-5509
                                       virt)
                                     (before typing/typeclass.ml(166):5522-5586
                                       (if
                                         (after typing/typeclass.ml(166):5525-5554
                                           (apply
                                             (field 2
                                               (field 8 (global Types!)))
                                             lab (field 2 sign)))
                                         (before typing/typeclass.ml(166):5560-5564
                                           virt)
                                         (before typing/typeclass.ml(167):5577-5586
                                           (makeblock 0 lab virt)))))))))
                           0a fields))))))))
          (letrec
            (constructor_type
               (function constr cty
                 (funct-body typing/typeclass.ml(171)<ghost>:5689-5917
                   (before typing/typeclass.ml(172):5704-5917
                     (switch* cty
                      case tag 0:
                       (let (cty =a (field 2 cty))
                         (before typing/typeclass.ml(174):5755-5782
                           (after typing/typeclass.ml(174):5755-5782
                             (apply constructor_type constr cty))))
                      case tag 1:
                       (before typing/typeclass.ml(176):5812-5818 constr)
                      case tag 2:
                       (let
                         (cty =a (field 2 cty)
                          ty =a (field 1 cty)
                          l =a (field 0 cty))
                         (before typing/typeclass.ml(178):5855-5917
                           (after typing/typeclass.ml(178):5855-5917
                             (apply (field 17 (global Ctype!))
                               (makeblock 1 l ty
                                 (after typing/typeclass.ml(178):5883-5910
                                   (apply constructor_type constr cty))
                                 0a))))))))))
            (letrec
              (class_body
                 (function cty
                   (funct-body typing/typeclass.ml(180)<ghost>:5938-6116
                     (before typing/typeclass.ml(181):5946-6116
                       (switch* cty
                        case tag 0:
                         (before typing/typeclass.ml(183):5987-5990 cty)
                        case tag 1:
                         (before typing/typeclass.ml(185):6063-6066 cty)
                        case tag 2:
                         (let (cty =a (field 2 cty))
                           (before typing/typeclass.ml(187):6102-6116
                             (after typing/typeclass.ml(187):6102-6116
                               (apply class_body cty)))))))))
              (let
                (extract_constraints =
                   (function cty
                     (funct-body typing/typeclass.ml(189)<ghost>:6142-6507
                       (before typing/typeclass.ml(190):6150-6507
                         (let
                           (sign =
                              (after typing/typeclass.ml(190):6161-6194
                                (apply (field 101 (global Ctype!)) cty)))
                           (before typing/typeclass.ml(191):6200-6507
                             (makeblock 0
                               (after typing/typeclass.ml(191):6201-6260
                                 (apply (field 12 (field 2 (global Types!)))
                                   (function lab param vars
                                     (funct-body typing/typeclass.ml(191):6211-6242
                                       (before typing/typeclass.ml(191):6230-6241
                                         (makeblock 0 lab vars))))
                                   (field 1 sign) 0a))
                               (let
                                 (*match* =
                                    (after typing/typeclass.ml(193):6294-6351
                                      (apply (field 26 (global Ctype!))
                                        (after typing/typeclass.ml(193):6315-6351
                                          (apply (field 25 (global Ctype!))
                                            (field 0 sign)))))
                                  fields =a (field 0 *match*))
                                 (before typing/typeclass.ml(195):6361-6479
                                   (after typing/typeclass.ml(195):6361-6479
                                     (apply (field 20 (global Stdlib__list!))
                                       (function meths param
                                         (funct-body typing/typeclass.ml(196):6381-6464
                                           (let (lab =a (field 0 param))
                                             (before typing/typeclass.ml(197):6415-6463
                                               (if
                                                 (after typing/typeclass.ml(197):6418-6436
                                                   (caml_string_equal lab
                                                     dummy_method))
                                                 (before typing/typeclass.ml(197):6442-6447
                                                   meths)
                                                 (before typing/typeclass.ml(197):6453-6463
                                                   (makeblock 0 lab meths)))))))
                                       0a fields))))
                               (field 2 sign))))))))
                (letrec
                  (abbreviate_class_type
                     (function path params cty
                       (funct-body typing/typeclass.ml(202)<ghost>:6539-6749
                         (before typing/typeclass.ml(203):6559-6749
                           (catch
                             (switch* cty
                              case tag 0: (exit 8)
                              case tag 1: (exit 8)
                              case tag 2:
                               (let
                                 (cty =a (field 2 cty)
                                  ty =a (field 1 cty)
                                  l =a (field 0 cty))
                                 (before typing/typeclass.ml(207):6693-6749
                                   (makeblock 2 l ty
                                     (after typing/typeclass.ml(207):6711-6748
                                       (apply abbreviate_class_type path
                                         params cty))))))
                            with (8)
                             (before typing/typeclass.ml(205):6626-6656
                               (makeblock 0 path params cty)))))))
                  (letrec
                    (closed_class_type
                       (function param
                         (funct-body typing/typeclass.ml(213):6940-7351
                           (switch* param
                            case tag 0:
                             (let (params =a (field 1 param))
                               (before typing/typeclass.ml(215):6988-7039
                                 (after typing/typeclass.ml(215):6988-7039
                                   (apply (field 27 (global Stdlib__list!))
                                     (after typing/typeclass.ml(215):7001-7032
                                       (apply (field 95 (global Ctype!))
                                         (field 0 (global Env!))))
                                     params))))
                            case tag 1:
                             (let (sign =a (field 0 param))
                               (before typing/typeclass.ml(217):7072-7243
                                 (&&
                                   (after typing/typeclass.ml(217):7072-7116
                                     (apply (field 95 (global Ctype!))
                                       (field 0 (global Env!))
                                       (field 0 sign)))
                                   (after typing/typeclass.ml(219):7134-7243
                                     (apply
                                       (field 12 (field 2 (global Types!)))
                                       (function param param cc
                                         (funct-body typing/typeclass.ml(219):7144-7207
                                           (let (ty =a (field 2 param))
                                             (before typing/typeclass.ml(219):7168-7206
                                               (&&
                                                 (after typing/typeclass.ml(219):7168-7200
                                                   (apply
                                                     (field 95
                                                       (global Ctype!))
                                                     (field 0 (global Env!))
                                                     ty))
                                                 cc)))))
                                       (field 1 sign) 1a)))))
                            case tag 2:
                             (let
                               (cty =a (field 2 param) ty =a (field 1 param))
                               (before typing/typeclass.ml(223):7280-7351
                                 (&&
                                   (after typing/typeclass.ml(223):7280-7312
                                     (apply (field 95 (global Ctype!))
                                       (field 0 (global Env!)) ty))
                                   (after typing/typeclass.ml(225):7330-7351
                                     (apply closed_class_type cty)))))))))
                    (let
                      (closed_class =
                         (function cty
                           (funct-body typing/typeclass.ml(227)<ghost>:7370-7477
                             (before typing/typeclass.ml(228):7378-7477
                               (&&
                                 (after typing/typeclass.ml(228):7378-7437
                                   (apply (field 27 (global Stdlib__list!))
                                     (after typing/typeclass.ml(228):7391-7422
                                       (apply (field 95 (global Ctype!))
                                         (field 0 (global Env!))))
                                     (field 0 cty)))
                                 (after typing/typeclass.ml(230):7447-7477
                                   (apply closed_class_type (field 1 cty))))))))
                      (letrec
                        (limited_generalize
                           (function rv param
                             (funct-body typing/typeclass.ml(232)<ghost>:7506-8015
                               (switch* param
                                case tag 0:
                                 (let
                                   (cty =a (field 2 param)
                                    params =a (field 1 param))
                                   (before typing/typeclass.ml(235):7567-7646
                                     (seq
                                       (after typing/typeclass.ml(235):7567-7613
                                         (apply
                                           (field 14 (global Stdlib__list!))
                                           (after typing/typeclass.ml(235):7577-7606
                                             (apply
                                               (field 44 (global Ctype!)) rv))
                                           params))
                                       (before typing/typeclass.ml(236):7621-7646
                                         (after typing/typeclass.ml(236):7621-7646
                                           (apply limited_generalize rv cty))))))
                                case tag 1:
                                 (let (sign =a (field 0 param))
                                   (before typing/typeclass.ml(238):7679-7915
                                     (seq
                                       (after typing/typeclass.ml(238):7679-7721
                                         (apply (field 44 (global Ctype!)) rv
                                           (field 0 sign)))
                                       (before typing/typeclass.ml(239):7729-7915
                                         (seq
                                           (after typing/typeclass.ml(239):7729-7814
                                             (apply
                                               (field 11
                                                 (field 2 (global Types!)))
                                               (function param param
                                                 (funct-body typing/typeclass.ml(239):7739-7791
                                                   (let
                                                     (ty =a (field 2 param))
                                                     (before typing/typeclass.ml(239):7760-7790
                                                       (after typing/typeclass.ml(239):7760-7790
                                                         (apply
                                                           (field 44
                                                             (global Ctype!))
                                                           rv ty))))))
                                               (field 1 sign)))
                                           (before typing/typeclass.ml(241):7822-7915
                                             (after typing/typeclass.ml(241):7822-7915
                                               (apply
                                                 (field 14
                                                   (global Stdlib__list!))
                                                 (function param
                                                   (funct-body typing/typeclass.ml(241):7832-7891
                                                     (let
                                                       (tl =a (field 1 param))
                                                       (before typing/typeclass.ml(241):7848-7890
                                                         (after typing/typeclass.ml(241):7848-7890
                                                           (apply
                                                             (field 14
                                                               (global Stdlib__list!))
                                                             (after typing/typeclass.ml(241):7858-7887
                                                               (apply
                                                                 (field 44
                                                                   (global Ctype!))
                                                                 rv))
                                                             tl))))))
                                                 (field 3 sign)))))))))
                                case tag 2:
                                 (let
                                   (cty =a (field 2 param)
                                    ty =a (field 1 param))
                                   (before typing/typeclass.ml(244):7952-8015
                                     (seq
                                       (after typing/typeclass.ml(244):7952-7982
                                         (apply (field 44 (global Ctype!)) rv
                                           ty))
                                       (before typing/typeclass.ml(245):7990-8015
                                         (after typing/typeclass.ml(245):7990-8015
                                           (apply limited_generalize rv cty))))))))))
                        (let
                          (rc =
                             (function node
                               (funct-body typing/typeclass.ml(248)<ghost>:8050-8193
                                 (before typing/typeclass.ml(249):8059-8193
                                   (seq
                                     (after typing/typeclass.ml(249):8059-8121
                                       (apply (field 7 (global Cmt_format!))
                                         (makeblock 4 node)))
                                     (before typing/typeclass.ml(250):8125-8193
                                       (seq
                                         (after typing/typeclass.ml(250):8125-8161
                                           (apply (field 0 (global Stypes!))
                                             (makeblock 2 node)))
                                         (before typing/typeclass.ml(251):8189-8193
                                           node)))))))
                           enter_met_env =
                             (function check loc lab kind ty val_env met_env
                               par_env
                               (funct-body typing/typeclass.ml(260)<ghost>:8429-9062
                                 (before typing/typeclass.ml(261):8480-9062
                                   (let
                                     (*match* =
                                        (after typing/typeclass.ml(262):8504-8670
                                          (apply (field 63 (global Env!)) 0a
                                            lab
                                            (makeblock 0 ty [4: 0a] loc 0a)
                                            val_env))
                                      val_env =a (field 1 *match*)
                                      id =a (field 0 *match*))
                                     (before typing/typeclass.ml(268):8678-9062
                                       (makeblock 0 id val_env
                                         (after typing/typeclass.ml(269):8695-8857
                                           (apply (field 47 (global Env!))
                                             check id
                                             (makeblock 0 ty kind loc 0a)
                                             met_env))
                                         (after typing/typeclass.ml(272):8862-9061
                                           (apply (field 47 (global Env!)) 0a
                                             id
                                             (makeblock 0 ty [4: 0a] loc 0a)
                                             par_env))))))))
                           enter_val =
                             (function cl_num vars inh lab mut virt ty
                               val_env met_env par_env loc
                               (funct-body typing/typeclass.ml(278)<ghost>:9130-9979
                                 (before typing/typeclass.ml(279):9194-9979
                                   (catch
                                     (try
                                       (let
                                         (*match* =
                                            (after typing/typeclass.ml(281):9254-9273
                                              (apply
                                                (field 26
                                                  (field 2 (global Types!)))
                                                lab (field 0 vars)))
                                          ty' =a (field 3 *match*)
                                          virt' =a (field 2 *match*)
                                          mut' =a (field 1 *match*)
                                          id =a (field 0 *match*))
                                         (before typing/typeclass.ml(282):9283-9530
                                           (seq
                                             (if (!= mut' mut)
                                               (before typing/typeclass.ml(283):9311-9369
                                                 (raise
                                                   (after typing/typeclass.ml(283):9317-9369
                                                     (makeblock 0 Error loc
                                                       val_env
                                                       (makeblock 21 lab mut)))))
                                               0a)
                                             (before typing/typeclass.ml(284):9377-9530
                                               (seq
                                                 (after typing/typeclass.ml(284):9377-9437
                                                   (apply
                                                     (field 66
                                                       (global Ctype!))
                                                     val_env
                                                     (after typing/typeclass.ml(284):9397-9416
                                                       (apply
                                                         (field 46
                                                           (global Ctype!))
                                                         0a ty))
                                                     (after typing/typeclass.ml(284):9417-9437
                                                       (apply
                                                         (field 46
                                                           (global Ctype!))
                                                         0a ty'))))
                                                 (before typing/typeclass.ml(285):9445-9530
                                                   (let
                                                     (virt =
                                                        (if (== virt' 1a)
                                                          (before typing/typeclass.ml(286):9514-9519
                                                            virt')
                                                          (before typing/typeclass.ml(286):9525-9529
                                                            virt))
                                                      id =
                                                        (if (not inh)
                                                          (before typing/typeclass.ml(285):9462-9469
                                                            (makeblock 0 id))
                                                          (before typing/typeclass.ml(285):9475-9479
                                                            0a)))
                                                     (exit 21 virt id))))))))
                                      with exn
                                       (let (tag =a (field 0 exn))
                                         (if
                                           (== tag (field 1 (global Ctype!)))
                                           (let (tr =a (field 1 exn))
                                             (before typing/typeclass.ml(289):9572-9671
                                               (raise
                                                 (after typing/typeclass.ml(289):9578-9671
                                                   (makeblock 0 Error loc
                                                     val_env
                                                     (makeblock 1
                                                       "instance variable"
                                                       lab tr))))))
                                           (if
                                             (== exn
                                               (field 7 (global Stdlib!)))
                                             (before typing/typeclass.ml(291):9691-9701
                                               (let (virt =a virt id = 0a)
                                                 (exit 21 virt id)))
                                             (reraise exn)))))
                                    with (21 virt id)
                                     (before typing/typeclass.ml(293):9709-9979
                                       (let
                                         (result =
                                            (if id
                                              (let (id =a (field 0 id))
                                                (before typing/typeclass.ml(294):9768-9799
                                                  (makeblock 0 id val_env
                                                    met_env par_env)))
                                              (before typing/typeclass.ml(296):9822-9915
                                                (after typing/typeclass.ml(296):9822-9915
                                                  (apply enter_met_env 0a
                                                    (field 0
                                                      (global Location!))
                                                    lab
                                                    (makeblock 1 mut cl_num)
                                                    ty val_env met_env
                                                    par_env))))
                                          id =a (field 0 result))
                                         (before typing/typeclass.ml(299):9923-9979
                                           (seq
                                             (setfield_ptr 0 vars
                                               (after typing/typeclass.ml(299):9931-9969
                                                 (apply
                                                   (field 3
                                                     (field 2
                                                       (global Types!)))
                                                   lab
                                                   (makeblock 0 id mut virt
                                                     ty)
                                                   (field 0 vars))))
                                             (before typing/typeclass.ml(300):9973-9979
                                               result)))))))))
                           concr_vals =
                             (function vars
                               (funct-body typing/typeclass.ml(302)<ghost>:9996-10107
                                 (before typing/typeclass.ml(303):10005-10107
                                   (after typing/typeclass.ml(303):10005-10107
                                     (apply
                                       (field 12 (field 2 (global Types!)))
                                       (function id param s
                                         (funct-body typing/typeclass.ml(304):10019-10086
                                           (let (vf =a (field 1 param))
                                             (before typing/typeclass.ml(304):10043-10085
                                               (if (== vf 0a)
                                                 (before typing/typeclass.ml(304):10064-10065
                                                   s)
                                                 (before typing/typeclass.ml(304):10071-10085
                                                   (after typing/typeclass.ml(304):10071-10085
                                                     (apply
                                                       (field 3
                                                         (field 8
                                                           (global Types!)))
                                                       id s))))))))
                                       vars
                                       (field 0 (field 8 (global Types!))))))))
                           inheritance =
                             (function self_type env ovf concr_meths
                               warn_vals loc parent
                               (funct-body typing/typeclass.ml(307)<ghost>:10125-11777
                                 (before typing/typeclass.ml(308):10180-11777
                                   (let
                                     (*match* =
                                        (after typing/typeclass.ml(308):10186-10210
                                          (apply scrape_class_type parent)))
                                     (catch
                                       (switch* *match*
                                        case tag 0: (exit 30)
                                        case tag 1:
                                         (let (cl_sig =a (field 0 *match*))
                                           (before typing/typeclass.ml(312):10271-11711
                                             (seq
                                               (try
                                                 (after typing/typeclass.ml(313):10289-10331
                                                   (apply
                                                     (field 66
                                                       (global Ctype!))
                                                     env self_type
                                                     (field 0 cl_sig)))
                                                with exn
                                                 (let (tag =a (field 0 exn))
                                                   (if
                                                     (== tag
                                                       (field 1
                                                         (global Ctype!)))
                                                     (let
                                                       (trace =a
                                                          (field 1 exn))
                                                       (before typing/typeclass.ml(315):10372-10600
                                                         (catch
                                                           (if trace
                                                             (let
                                                               (*match* =a
                                                                  (field 0
                                                                    trace))
                                                               (switch *match*
                                                                case tag 0:
                                                                 (let
                                                                   (*match* =a
                                                                    (field 1
                                                                    trace))
                                                                   (if
                                                                    *match*
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*))
                                                                    (switch *match*
                                                                    case tag 4:
                                                                    (let
                                                                    (rem =a
                                                                    (field 1
                                                                    *match*)
                                                                    n =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(318):10510-10572
                                                                    (raise
                                                                    (after typing/typeclass.ml(318):10515-10572
                                                                    (makeblock 0
                                                                    Error loc
                                                                    env
                                                                    (makeblock 1
                                                                    "method"
                                                                    n rem))))))
                                                                    default:
                                                                    (exit 28)))
                                                                    (exit 28)))
                                                                default:
                                                                 (exit 28)))
                                                             (exit 28))
                                                          with (28)
                                                           (before typing/typeclass.ml(319):10588-10600
                                                             (raise
                                                               (after typing/typeclass.ml(319):10588-10600
                                                                 (makeblock 0
                                                                   (global Assert_failure!)
                                                                   [0:
                                                                    "typing/typeclass.ml"
                                                                    319 15])))))))
                                                     (reraise exn))))
                                               (before typing/typeclass.ml(323):10642-11711
                                                 (let
                                                   (over_meths =
                                                      (after typing/typeclass.ml(323):10659-10700
                                                        (apply
                                                          (field 7
                                                            (field 8
                                                              (global Types!)))
                                                          (field 2 cl_sig)
                                                          concr_meths)))
                                                   (before typing/typeclass.ml(324):10710-11711
                                                     (let
                                                       (concr_vals =
                                                          (after typing/typeclass.ml(324):10727-10754
                                                            (apply concr_vals
                                                              (field 1
                                                                cl_sig))))
                                                       (before typing/typeclass.ml(325):10764-11711
                                                         (let
                                                           (over_vals =
                                                              (after typing/typeclass.ml(325):10780-10812
                                                                (apply
                                                                  (field 7
                                                                    (field 8
                                                                    (global Types!)))
                                                                  concr_vals
                                                                  warn_vals)))
                                                           (before typing/typeclass.ml(326):10822-11711
                                                             (seq
                                                               (catch
                                                                 (if ovf
                                                                   (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    ovf))
                                                                    (if
                                                                    *match*
                                                                    (before typing/typeclass.ml(328):10875-11372
                                                                    (let
                                                                    (cname =
                                                                    (catch
                                                                    (switch* parent
                                                                    case tag 0:
                                                                    (let
                                                                    (p =a
                                                                    (field 0
                                                                    parent))
                                                                    (before typing/typeclass.ml(330):10955-10966
                                                                    (after typing/typeclass.ml(330):10955-10966
                                                                    (apply
                                                                    (field 6
                                                                    (global Path!))
                                                                    0a p))))
                                                                    case tag 1:
                                                                    (exit 26)
                                                                    case tag 2:
                                                                    (exit 26))
                                                                    with (26)
                                                                    (before typing/typeclass.ml(331):10986-10997
                                                                    "inherited")))
                                                                    (before typing/typeclass.ml(333):11021-11372
                                                                    (seq
                                                                    (if
                                                                    (not
                                                                    (after typing/typeclass.ml(333):11028-11055
                                                                    (apply
                                                                    (field 1
                                                                    (field 8
                                                                    (global Types!)))
                                                                    over_meths)))
                                                                    (before typing/typeclass.ml(334):11073-11177
                                                                    (after typing/typeclass.ml(334):11073-11177
                                                                    (apply
                                                                    (field 34
                                                                    (global Location!))
                                                                    loc
                                                                    (makeblock 2
                                                                    (makeblock 0
                                                                    cname
                                                                    (after typing/typeclass.ml(335):11150-11175
                                                                    (apply
                                                                    (field 21
                                                                    (field 8
                                                                    (global Types!)))
                                                                    over_meths)))))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(336):11189-11371
                                                                    (if
                                                                    (not
                                                                    (after typing/typeclass.ml(336):11196-11222
                                                                    (apply
                                                                    (field 1
                                                                    (field 8
                                                                    (global Types!)))
                                                                    over_vals)))
                                                                    (before typing/typeclass.ml(337):11240-11371
                                                                    (after typing/typeclass.ml(337):11240-11371
                                                                    (apply
                                                                    (field 34
                                                                    (global Location!))
                                                                    loc
                                                                    (makeblock 5
                                                                    (makeblock 0
                                                                    cname
                                                                    (after typing/typeclass.ml(339):11345-11369
                                                                    (apply
                                                                    (field 21
                                                                    (field 8
                                                                    (global Types!)))
                                                                    over_vals)))))))
                                                                    0a))))))
                                                                    (before typing/typeclass.ml(341):11408-11461
                                                                    (if
                                                                    (&&
                                                                    (after typing/typeclass.ml(341):11408-11433
                                                                    (apply
                                                                    (field 1
                                                                    (field 8
                                                                    (global Types!)))
                                                                    over_meths))
                                                                    (after typing/typeclass.ml(341):11437-11461
                                                                    (apply
                                                                    (field 1
                                                                    (field 8
                                                                    (global Types!)))
                                                                    over_vals)))
                                                                    (before typing/typeclass.ml(342):11473-11519
                                                                    (raise
                                                                    (after typing/typeclass.ml(342):11479-11519
                                                                    (makeblock 0
                                                                    Error loc
                                                                    env
                                                                    [22:
                                                                    "" ""]))))
                                                                    (exit 27)))))
                                                                   (exit 27))
                                                                with (27)
                                                                 (before typing/typeclass.ml(343):11533-11535
                                                                   0a))
                                                               (before typing/typeclass.ml(346):11554-11711
                                                                 (let
                                                                   (concr_meths =
                                                                    (after typing/typeclass.ml(346):11572-11613
                                                                    (apply
                                                                    (field 6
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 2
                                                                    cl_sig)
                                                                    concr_meths))
                                                                    warn_vals =
                                                                    (after typing/typeclass.ml(347):11636-11668
                                                                    (apply
                                                                    (field 6
                                                                    (field 8
                                                                    (global Types!)))
                                                                    concr_vals
                                                                    warn_vals)))
                                                                   (before typing/typeclass.ml(349):11679-11711
                                                                    (makeblock 0
                                                                    cl_sig
                                                                    concr_meths
                                                                    warn_vals)))))))))))))))
                                        case tag 2: (exit 30))
                                      with (30)
                                       (before typing/typeclass.ml(352):11728-11777
                                         (raise
                                           (after typing/typeclass.ml(352):11733-11777
                                             (makeblock 0 Error loc env
                                               (makeblock 2 parent))))))))))
                           virtual_method =
                             (function val_env meths self_type lab priv sty
                               loc
                               (funct-body typing/typeclass.ml(354)<ghost>:11798-12212
                                 (before typing/typeclass.ml(355):11843-12212
                                   (let
                                     (*match* =
                                        (after typing/typeclass.ml(356):11863-11920
                                          (apply (field 75 (global Ctype!))
                                            val_env lab priv meths self_type))
                                      ty' =a (field 1 *match*))
                                     (before typing/typeclass.ml(358):11928-12212
                                       (let
                                         (sty =
                                            (after typing/typeclass.ml(358):11938-11967
                                              (apply
                                                (field 14
                                                  (field 4
                                                    (global Ast_helper!)))
                                                sty)))
                                         (before typing/typeclass.ml(359):11973-12212
                                           (let
                                             (cty =
                                                (after typing/typeclass.ml(359):11983-12019
                                                  (apply
                                                    (field 1
                                                      (global Typetexp!))
                                                    val_env 0a sty)))
                                             (before typing/typeclass.ml(360):12025-12212
                                               (let (ty = (field 1 cty))
                                                 (before typing/typeclass.ml(361):12053-12212
                                                   (seq
                                                     (try
                                                       (after typing/typeclass.ml(362):12067-12093
                                                         (apply
                                                           (field 66
                                                             (global Ctype!))
                                                           val_env ty ty'))
                                                      with exn
                                                       (let
                                                         (tag =a
                                                            (field 0 exn))
                                                         (if
                                                           (== tag
                                                             (field 1
                                                               (global Ctype!)))
                                                           (let
                                                             (trace =a
                                                                (field 1 exn))
                                                             (before typing/typeclass.ml(363):12128-12198
                                                               (raise
                                                                 (after typing/typeclass.ml(363):12133-12198
                                                                   (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 1
                                                                    "method"
                                                                    lab
                                                                    trace))))))
                                                           (reraise exn))))
                                                     (before typing/typeclass.ml(365):12209-12212
                                                       cty)))))))))))))
                           delayed_meth_specs = (makemutable 0 0a)
                           declare_method =
                             (function val_env meths self_type lab priv sty
                               loc
                               (funct-body typing/typeclass.ml(369)<ghost>:12266-13353
                                 (before typing/typeclass.ml(370):12311-13353
                                   (let
                                     (*match* =
                                        (after typing/typeclass.ml(371):12331-12388
                                          (apply (field 75 (global Ctype!))
                                            val_env lab priv meths self_type))
                                      ty' =a (field 1 *match*))
                                     (before typing/typeclass.ml(373):12396-13353
                                       (let
                                         (unif =
                                            (function ty
                                              (funct-body typing/typeclass.ml(373)<ghost>:12405-12547
                                                (before typing/typeclass.ml(374):12414-12547
                                                  (try
                                                    (after typing/typeclass.ml(374):12418-12444
                                                      (apply
                                                        (field 66
                                                          (global Ctype!))
                                                        val_env ty ty'))
                                                   with exn
                                                    (let
                                                      (tag =a (field 0 exn))
                                                      (if
                                                        (== tag
                                                          (field 1
                                                            (global Ctype!)))
                                                        (let
                                                          (trace =a
                                                             (field 1 exn))
                                                          (before typing/typeclass.ml(375):12477-12547
                                                            (raise
                                                              (after typing/typeclass.ml(375):12482-12547
                                                                (makeblock 0
                                                                  Error loc
                                                                  val_env
                                                                  (makeblock 1
                                                                    "method"
                                                                    lab
                                                                    trace))))))
                                                        (reraise exn))))))))
                                         (before typing/typeclass.ml(377):12555-13353
                                           (let
                                             (sty =
                                                (after typing/typeclass.ml(377):12565-12594
                                                  (apply
                                                    (field 14
                                                      (field 4
                                                        (global Ast_helper!)))
                                                    sty)))
                                             (before typing/typeclass.ml(378):12600-13353
                                               (let
                                                 (*match* = (field 0 sty)
                                                  *match* = *match*
                                                  *match* = priv)
                                                 (catch
                                                   (switch *match*
                                                    case tag 8:
                                                     (let
                                                       (*match* =a
                                                          (field 0 *match*))
                                                       (if *match* (exit 35)
                                                         (if *match*
                                                           (let
                                                             (sty' =a
                                                                (field 1
                                                                  *match*))
                                                             (before typing/typeclass.ml(382):12817-13231
                                                               (let
                                                                 (returned_cty =
                                                                    (after typing/typeclass.ml(382):12836-12880
                                                                    (apply
                                                                    ctyp 0a
                                                                    (after typing/typeclass.ml(382):12850-12868
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    0a))
                                                                    val_env
                                                                    loc)))
                                                                 (before typing/typeclass.ml(383):12890-13231
                                                                   (seq
                                                                    (setfield_ptr 0
                                                                    delayed_meth_specs
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(384):12918-13182
                                                                    (apply
                                                                    (field 15
                                                                    (global Warnings!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(384):12935-13182
                                                                    (before typing/typeclass.ml(385):12958-13170
                                                                    (let
                                                                    (cty =
                                                                    (after typing/typeclass.ml(385):12968-13007
                                                                    (apply
                                                                    (field 2
                                                                    (global Typetexp!))
                                                                    val_env
                                                                    sty')))
                                                                    (before typing/typeclass.ml(386):13023-13170
                                                                    (let
                                                                    (ty =
                                                                    (field 1
                                                                    cty))
                                                                    (before typing/typeclass.ml(387):13061-13170
                                                                    (seq
                                                                    (after typing/typeclass.ml(387):13061-13068
                                                                    (apply
                                                                    unif ty))
                                                                    (before typing/typeclass.ml(388):13082-13170
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    returned_cty
                                                                    (makeblock 8
                                                                    0a cty))
                                                                    (before typing/typeclass.ml(389):13141-13169
                                                                    (setfield_ptr 1
                                                                    returned_cty
                                                                    ty))))))))))))))
                                                                    (field 0
                                                                    delayed_meth_specs)))
                                                                    (before typing/typeclass.ml(392):13219-13231
                                                                    returned_cty))))))
                                                           (exit 35))))
                                                    default: (exit 35))
                                                  with (35)
                                                   (before typing/typeclass.ml(394):13247-13353
                                                     (let
                                                       (cty =
                                                          (after typing/typeclass.ml(394):13257-13293
                                                            (apply
                                                              (field 1
                                                                (global Typetexp!))
                                                              val_env 0a sty)))
                                                       (before typing/typeclass.ml(395):13303-13353
                                                         (let
                                                           (ty =
                                                              (field 1 cty))
                                                           (before typing/typeclass.ml(396):13335-13353
                                                             (seq
                                                               (after typing/typeclass.ml(396):13335-13342
                                                                 (apply unif
                                                                   ty))
                                                               (before typing/typeclass.ml(397):13350-13353
                                                                 cty))))))))))))))))))
                           type_constraint =
                             (function val_env sty sty' loc
                               (funct-body typing/typeclass.ml(399)<ghost>:13375-13719
                                 (before typing/typeclass.ml(400):13400-13719
                                   (let
                                     (cty =
                                        (after typing/typeclass.ml(400):13411-13447
                                          (apply (field 1 (global Typetexp!))
                                            val_env 0a sty)))
                                     (before typing/typeclass.ml(401):13453-13719
                                       (let (ty = (field 1 cty))
                                         (before typing/typeclass.ml(402):13481-13719
                                           (let
                                             (cty' =
                                                (after typing/typeclass.ml(402):13492-13529
                                                  (apply
                                                    (field 1
                                                      (global Typetexp!))
                                                    val_env 0a sty')))
                                             (before typing/typeclass.ml(403):13535-13719
                                               (let (ty' = (field 1 cty'))
                                                 (before typing/typeclass.ml(404):13565-13719
                                                   (seq
                                                     (try
                                                       (after typing/typeclass.ml(405):13579-13605
                                                         (apply
                                                           (field 66
                                                             (global Ctype!))
                                                           val_env ty ty'))
                                                      with exn
                                                       (let
                                                         (tag =a
                                                            (field 0 exn))
                                                         (if
                                                           (== tag
                                                             (field 1
                                                               (global Ctype!)))
                                                           (let
                                                             (trace =a
                                                                (field 1 exn))
                                                             (before typing/typeclass.ml(406):13640-13697
                                                               (raise
                                                                 (after typing/typeclass.ml(406):13645-13697
                                                                   (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 0
                                                                    trace))))))
                                                           (reraise exn))))
                                                     (before typing/typeclass.ml(408):13708-13719
                                                       (makeblock 0 cty cty'))))))))))))))
                           make_method =
                             (function loc cl_num expr
                               (funct-body typing/typeclass.ml(410)<ghost>:13737-13939
                                 (before typing/typeclass.ml(411):13757-13939
                                   (let
                                     (mkid =
                                        (function s
                                          (funct-body typing/typeclass.ml(412)<ghost>:13791-13806
                                            (before typing/typeclass.ml(412):13795-13806
                                              (after typing/typeclass.ml(412):13795-13806
                                                (apply
                                                  (field 7
                                                    (global Typedtree!))
                                                  s loc))))))
                                     (before typing/typeclass.ml(413):13812-13939
                                       (after typing/typeclass.ml(413):13812-13939
                                         (apply
                                           (field 5
                                             (field 6 (global Ast_helper!)))
                                           (makeblock 0 (field 1 expr)) 0a 0a
                                           0a
                                           (after typing/typeclass.ml(414):13857-13930
                                             (apply
                                               (field 4
                                                 (field 5
                                                   (global Ast_helper!)))
                                               (makeblock 0 loc) 0a
                                               (after typing/typeclass.ml(414):13873-13903
                                                 (apply
                                                   (field 3
                                                     (field 5
                                                       (global Ast_helper!)))
                                                   (makeblock 0 loc) 0a
                                                   (after typing/typeclass.ml(414):13887-13902
                                                     (apply mkid "self-*"))))
                                               (after typing/typeclass.ml(414):13904-13929
                                                 (apply mkid
                                                   (after typing/typeclass.ml(414):13910-13928
                                                     (apply
                                                       (field 27
                                                         (global Stdlib!))
                                                       "self-" cl_num))))))
                                           expr)))))))
                           add_val =
                             (function lab param val_sig
                               (funct-body typing/typeclass.ml(419)<ghost>:13988-14214
                                 (let
                                   (ty =a (field 2 param)
                                    virt =a (field 1 param)
                                    mut =a (field 0 param))
                                   (before typing/typeclass.ml(420):14020-14214
                                     (let
                                       (virt =
                                          (try
                                            (let
                                              (*match* =
                                                 (after typing/typeclass.ml(422):14072-14093
                                                   (apply
                                                     (field 26
                                                       (field 2
                                                         (global Types!)))
                                                     lab val_sig))
                                               virt' =a (field 1 *match*))
                                              (before typing/typeclass.ml(423):14103-14143
                                                (if (== virt' 1a)
                                                  (before typing/typeclass.ml(423):14128-14133
                                                    virt')
                                                  (before typing/typeclass.ml(423):14139-14143
                                                    virt))))
                                           with exn
                                            (if
                                              (== exn
                                                (field 7 (global Stdlib!)))
                                              (before typing/typeclass.ml(424):14166-14170
                                                virt)
                                              (reraise exn))))
                                       (before typing/typeclass.ml(426):14178-14214
                                         (after typing/typeclass.ml(426):14178-14214
                                           (apply
                                             (field 3
                                               (field 2 (global Types!)))
                                             lab (makeblock 0 mut virt ty)
                                             val_sig)))))))))
                          (letrec
                            (class_type_field
                               (function env self_type meths arg ctf
                                 (funct-body typing/typeclass.ml(428)<ghost>:14241-14390
                                   (before typing/typeclass.ml(429):14273-14390
                                     (after typing/typeclass.ml(429):14273-14390
                                       (apply
                                         (field 10
                                           (global Builtin_attributes!))
                                         0a (field 2 ctf)
                                         (function param
                                           (funct-body typing/typeclass.ml(430):14330-14390
                                             (before typing/typeclass.ml(430):14341-14389
                                               (after typing/typeclass.ml(430):14341-14389
                                                 (apply class_type_field_aux
                                                   env self_type meths arg
                                                   ctf))))))))))
                              class_type_field_aux
                                (function env self_type meths param ctf
                                  (funct-body typing/typeclass.ml(432)<ghost>:14417-16232
                                    (let
                                      (inher =a (field 3 param)
                                       concr_meths =a (field 2 param)
                                       val_sig =a (field 1 param)
                                       fields =a (field 0 param))
                                      (before typing/typeclass.ml(435):14488-16232
                                        (let (loc = (field 1 ctf))
                                          (before typing/typeclass.ml(436):14516-16232
                                            (let
                                              (mkctf =
                                                 (function desc
                                                   (funct-body typing/typeclass.ml(436)<ghost>:14526-14609
                                                     (before typing/typeclass.ml(437):14537-14609
                                                       (makeblock 0 desc loc
                                                         (field 2 ctf))))))
                                              (before typing/typeclass.ml(439):14617-16232
                                                (let
                                                  (*match* = (field 0 ctf))
                                                  (switch* *match*
                                                   case tag 0:
                                                    (let
                                                      (sparent =a
                                                         (field 0 *match*))
                                                      (before typing/typeclass.ml(441):14676-15161
                                                        (let
                                                          (parent =
                                                             (after typing/typeclass.ml(441):14689-14711
                                                               (apply
                                                                 class_type
                                                                 env sparent)))
                                                          (before typing/typeclass.ml(442):14721-15161
                                                            (let
                                                              (inher =
                                                                 (let
                                                                   (*match* =
                                                                    (field 1
                                                                    parent))
                                                                   (catch
                                                                    (switch* *match*
                                                                    case tag 0:
                                                                    (let
                                                                    (tl =a
                                                                    (field 1
                                                                    *match*)
                                                                    p =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(444):14805-14821
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    p tl)
                                                                    inher)))
                                                                    case tag 1:
                                                                    (exit 48)
                                                                    case tag 2:
                                                                    (exit 48))
                                                                    with (48)
                                                                    (before typing/typeclass.ml(445):14837-14842
                                                                    inher))))
                                                              (before typing/typeclass.ml(447):14858-15161
                                                                (let
                                                                  (*match* =
                                                                    (after typing/typeclass.ml(448):14897-14996
                                                                    (apply
                                                                    inheritance
                                                                    self_type
                                                                    env 0a
                                                                    concr_meths
                                                                    (field 0
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 1
                                                                    sparent)
                                                                    (field 1
                                                                    parent)))
                                                                   concr_meths =a
                                                                    (field 1
                                                                    *match*)
                                                                   cl_sig =a
                                                                    (field 0
                                                                    *match*))
                                                                  (before typing/typeclass.ml(451):15012-15161
                                                                    (let
                                                                    (val_sig =
                                                                    (after typing/typeclass.ml(452):15034-15076
                                                                    (apply
                                                                    (field 12
                                                                    (field 2
                                                                    (global Types!)))
                                                                    add_val
                                                                    (field 1
                                                                    cl_sig)
                                                                    val_sig)))
                                                                    (before typing/typeclass.ml(453):15086-15161
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(453):15087-15114
                                                                    (apply
                                                                    mkctf
                                                                    (makeblock 0
                                                                    parent)))
                                                                    fields)
                                                                    val_sig
                                                                    concr_meths
                                                                    inher)))))))))))
                                                   case tag 1:
                                                    (let
                                                      (*match* =a
                                                         (field 0 *match*)
                                                       sty =a
                                                         (field 3 *match*)
                                                       virt =a
                                                         (field 2 *match*)
                                                       mut =a
                                                         (field 1 *match*)
                                                       *match* =a
                                                         (field 0 *match*)
                                                       lab =a
                                                         (field 0 *match*))
                                                      (before typing/typeclass.ml(457):15213-15410
                                                        (let
                                                          (cty =
                                                             (after typing/typeclass.ml(457):15223-15255
                                                               (apply
                                                                 (field 1
                                                                   (global Typetexp!))
                                                                 env 0a sty)))
                                                          (before typing/typeclass.ml(458):15265-15410
                                                            (let
                                                              (ty =
                                                                 (field 1
                                                                   cty))
                                                              (before typing/typeclass.ml(459):15297-15410
                                                                (makeblock 0
                                                                  (makeblock 0
                                                                    (after typing/typeclass.ml(459):15298-15336
                                                                    (apply
                                                                    mkctf
                                                                    (makeblock 1
                                                                    (makeblock 0
                                                                    lab mut
                                                                    virt cty))))
                                                                    fields)
                                                                  (after typing/typeclass.ml(460):15354-15389
                                                                    (apply
                                                                    add_val
                                                                    lab
                                                                    (makeblock 0
                                                                    mut virt
                                                                    ty)
                                                                    val_sig))
                                                                  concr_meths
                                                                  inher)))))))
                                                   case tag 2:
                                                    (let
                                                      (*match* =a
                                                         (field 0 *match*)
                                                       sty =a
                                                         (field 3 *match*)
                                                       virt =a
                                                         (field 2 *match*)
                                                       priv =a
                                                         (field 1 *match*)
                                                       *match* =a
                                                         (field 0 *match*)
                                                       lab =a
                                                         (field 0 *match*))
                                                      (before typing/typeclass.ml(463):15467-15785
                                                        (let
                                                          (cty =
                                                             (after typing/typeclass.ml(464):15485-15546
                                                               (apply
                                                                 declare_method
                                                                 env meths
                                                                 self_type
                                                                 lab priv sty
                                                                 (field 1
                                                                   ctf))))
                                                          (before typing/typeclass.ml(465):15556-15785
                                                            (let
                                                              (concr_meths =
                                                                 (if virt
                                                                   (before typing/typeclass.ml(467):15620-15645
                                                                    (after typing/typeclass.ml(467):15620-15645
                                                                    (apply
                                                                    (field 3
                                                                    (field 8
                                                                    (global Types!)))
                                                                    lab
                                                                    concr_meths)))
                                                                   (before typing/typeclass.ml(468):15667-15678
                                                                    concr_meths)))
                                                              (before typing/typeclass.ml(470):15694-15785
                                                                (makeblock 0
                                                                  (makeblock 0
                                                                    (after typing/typeclass.ml(470):15695-15737
                                                                    (apply
                                                                    mkctf
                                                                    (makeblock 2
                                                                    (makeblock 0
                                                                    lab priv
                                                                    virt cty))))
                                                                    fields)
                                                                  val_sig
                                                                  concr_meths
                                                                  inher)))))))
                                                   case tag 3:
                                                    (let
                                                      (*match* =a
                                                         (field 0 *match*)
                                                       sty' =a
                                                         (field 1 *match*)
                                                       sty =a
                                                         (field 0 *match*))
                                                      (before typing/typeclass.ml(474):15828-15982
                                                        (let
                                                          (*match* =
                                                             (after typing/typeclass.ml(474):15846-15888
                                                               (apply
                                                                 type_constraint
                                                                 env sty sty'
                                                                 (field 1
                                                                   ctf)))
                                                           cty' =a
                                                             (field 1
                                                               *match*)
                                                           cty =a
                                                             (field 0
                                                               *match*))
                                                          (before typing/typeclass.ml(475):15898-15982
                                                            (makeblock 0
                                                              (makeblock 0
                                                                (after typing/typeclass.ml(475):15899-15934
                                                                  (apply
                                                                    mkctf
                                                                    (makeblock 3
                                                                    (makeblock 0
                                                                    cty cty'))))
                                                                fields)
                                                              val_sig
                                                              concr_meths
                                                              inher)))))
                                                   case tag 4:
                                                    (let
                                                      (x =a (field 0 *match*))
                                                      (before typing/typeclass.ml(479):16014-16133
                                                        (seq
                                                          (after typing/typeclass.ml(479):16014-16052
                                                            (apply
                                                              (field 9
                                                                (global Builtin_attributes!))
                                                              0a x))
                                                          (before typing/typeclass.ml(480):16060-16133
                                                            (makeblock 0
                                                              (makeblock 0
                                                                (after typing/typeclass.ml(480):16061-16085
                                                                  (apply
                                                                    mkctf
                                                                    (makeblock 4
                                                                    x)))
                                                                fields)
                                                              val_sig
                                                              concr_meths
                                                              inher)))))
                                                   case tag 5:
                                                    (let
                                                      (ext =a
                                                         (field 0 *match*))
                                                      (before typing/typeclass.ml(484):16167-16232
                                                        (raise
                                                          (after typing/typeclass.ml(484):16173-16232
                                                            (makeblock 0
                                                              Error_forward
                                                              (after typing/typeclass.ml(484):16188-16231
                                                                (apply
                                                                  (field 8
                                                                    (global Builtin_attributes!))
                                                                  ext)))))))))))))))))
                              class_signature
                                (function env param
                                  (funct-body typing/typeclass.ml(486)<ghost>:16254-17413
                                    (let
                                      (sign =a (field 1 param)
                                       sty =a (field 0 param))
                                      (before typing/typeclass.ml(487):16298-17413
                                        (let
                                          (meths =
                                             (makemutable 0
                                               (field 0
                                                 (field 1 (global Types!)))))
                                          (before typing/typeclass.ml(488):16331-17413
                                            (let
                                              (self_cty =
                                                 (after typing/typeclass.ml(488):16346-16378
                                                   (apply
                                                     (field 1
                                                       (global Typetexp!))
                                                     env 0a sty)))
                                              (before typing/typeclass.ml(489):16384-17413
                                                (let
                                                  (self_cty =
                                                     (let (init = self_cty)
                                                       (makemutable 0
                                                         (field 0 init)
                                                         (after typing/typeclass.ml(490):16431-16471
                                                           (apply
                                                             (field 60
                                                               (global Ctype!))
                                                             env
                                                             (field 1
                                                               self_cty)))
                                                         (field 2 init)
                                                         (field 3 init)
                                                         (field 4 init))))
                                                  (before typing/typeclass.ml(491):16479-17413
                                                    (let
                                                      (self_type =
                                                         (field 1 self_cty))
                                                      (before typing/typeclass.ml(495):16644-17413
                                                        (let
                                                          (dummy_obj =
                                                             (after typing/typeclass.ml(495):16660-16675
                                                               (apply
                                                                 (field 18
                                                                   (global Ctype!))
                                                                 0a 0a)))
                                                          (before typing/typeclass.ml(496):16681-17413
                                                            (seq
                                                              (after typing/typeclass.ml(496):16681-16783
                                                                (apply
                                                                  (field 66
                                                                    (global Ctype!))
                                                                  env
                                                                  (after typing/typeclass.ml(496):16697-16753
                                                                    (apply
                                                                    (field 71
                                                                    (global Ctype!))
                                                                    env
                                                                    dummy_method
                                                                    0a
                                                                    dummy_obj))
                                                                  (after typing/typeclass.ml(497):16758-16783
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    [2: 0a]))))
                                                              (before typing/typeclass.ml(498):16787-17413
                                                                (seq
                                                                  (try
                                                                    (after typing/typeclass.ml(499):16801-16836
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env
                                                                    self_type
                                                                    dummy_obj))
                                                                   with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (before typing/typeclass.ml(501):16865-16926
                                                                    (raise
                                                                    (after typing/typeclass.ml(501):16870-16926
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    sty) env
                                                                    (makeblock 5
                                                                    self_type)))))
                                                                    (reraise
                                                                    exn))))
                                                                  (before typing/typeclass.ml(505):16963-17413
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(506):17015-17199
                                                                    (apply
                                                                    (field 10
                                                                    (global Builtin_attributes!))
                                                                    0a 0a
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(507):17057-17199
                                                                    (before typing/typeclass.ml(508):17077-17191
                                                                    (after typing/typeclass.ml(508):17077-17191
                                                                    (apply
                                                                    (field 20
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(508):17092-17130
                                                                    (apply
                                                                    class_type_field
                                                                    env
                                                                    self_type
                                                                    meths))
                                                                    (makeblock 0
                                                                    0a
                                                                    (field 0
                                                                    (field 2
                                                                    (global Types!)))
                                                                    (field 0
                                                                    (field 8
                                                                    (global Types!)))
                                                                    0a) sign)))))))
                                                                    inher =a
                                                                    (field 3
                                                                    *match*)
                                                                    concr_meths =a
                                                                    (field 2
                                                                    *match*)
                                                                    val_sig =a
                                                                    (field 1
                                                                    *match*)
                                                                    rev_fields =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(513):17207-17413
                                                                    (let
                                                                    (cty =
                                                                    (makeblock 0
                                                                    self_type
                                                                    val_sig
                                                                    concr_meths
                                                                    inher))
                                                                    (before typing/typeclass.ml(518):17326-17413
                                                                    (makeblock 0
                                                                    self_cty
                                                                    (after typing/typeclass.ml(519):17368-17387
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__list!))
                                                                    rev_fields))
                                                                    cty)))))))))))))))))))))))
                              class_type
                                (function env scty
                                  (funct-body typing/typeclass.ml(523)<ghost>:17430-17536
                                    (before typing/typeclass.ml(524):17443-17536
                                      (after typing/typeclass.ml(524):17443-17536
                                        (apply
                                          (field 10
                                            (global Builtin_attributes!))
                                          0a (field 2 scty)
                                          (function param
                                            (funct-body typing/typeclass.ml(525):17501-17536
                                              (before typing/typeclass.ml(525):17512-17535
                                                (after typing/typeclass.ml(525):17512-17535
                                                  (apply class_type_aux env
                                                    scty))))))))))
                              class_type_aux
                                (function env scty
                                  (funct-body typing/typeclass.ml(527)<ghost>:17557-19650
                                    (before typing/typeclass.ml(528):17570-19650
                                      (let
                                        (cltyp =
                                           (function desc typ
                                             (funct-body typing/typeclass.ml(528)<ghost>:17580-17749
                                               (before typing/typeclass.ml(529):17595-17749
                                                 (makeblock 0 desc typ env
                                                   (field 1 scty)
                                                   (field 2 scty))))))
                                        (before typing/typeclass.ml(537):17757-19650
                                          (let (*match* = (field 0 scty))
                                            (switch* *match*
                                             case tag 0:
                                              (let
                                                (styl =a (field 1 *match*)
                                                 lid =a (field 0 *match*))
                                                (before typing/typeclass.ml(539):17820-18827
                                                  (let
                                                    (*match* =
                                                       (after typing/typeclass.ml(539):17839-17889
                                                         (apply
                                                           (field 26
                                                             (global Typetexp!))
                                                           env (field 1 scty)
                                                           (field 0 lid)))
                                                     decl =a
                                                       (field 1 *match*)
                                                     path =a
                                                       (field 0 *match*))
                                                    (before typing/typeclass.ml(540):17899-18827
                                                      (seq
                                                        (if
                                                          (after typing/typeclass.ml(540):17902-17940
                                                            (apply
                                                              (field 0
                                                                (global Path!))
                                                              (field 2 decl)
                                                              unbound_class))
                                                          (before typing/typeclass.ml(541):17954-18016
                                                            (raise
                                                              (after typing/typeclass.ml(541):17959-18016
                                                                (makeblock 0
                                                                  Error
                                                                  (field 1
                                                                    scty)
                                                                  env
                                                                  (makeblock 7
                                                                    (field 0
                                                                    lid))))))
                                                          0a)
                                                        (before typing/typeclass.ml(542):18024-18827
                                                          (let
                                                            (*match* =
                                                               (after typing/typeclass.ml(543):18053-18105
                                                                 (apply
                                                                   (field 55
                                                                    (global Ctype!))
                                                                   (field 0
                                                                    decl)
                                                                   (field 1
                                                                    decl)))
                                                             clty =a
                                                               (field 1
                                                                 *match*)
                                                             params =a
                                                               (field 0
                                                                 *match*))
                                                            (before typing/typeclass.ml(545):18121-18827
                                                              (seq
                                                                (if
                                                                  (!=
                                                                    (after typing/typeclass.ml(545):18124-18142
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    params))
                                                                    (after typing/typeclass.ml(545):18146-18162
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    styl)))
                                                                  (before typing/typeclass.ml(546):18176-18353
                                                                    (raise
                                                                    (after typing/typeclass.ml(546):18181-18353
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    scty) env
                                                                    (makeblock 11 (*,int,int)
                                                                    (field 0
                                                                    lid)
                                                                    (after typing/typeclass.ml(547):18263-18281
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    params))
                                                                    (after typing/typeclass.ml(548):18334-18350
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    styl)))))))
                                                                  0a)
                                                                (before typing/typeclass.ml(549):18361-18827
                                                                  (let
                                                                    (ctys =
                                                                    (after typing/typeclass.ml(549):18372-18717
                                                                    (apply
                                                                    (field 23
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    sty ty
                                                                    (funct-body typing/typeclass.ml(550):18390-18699
                                                                    (before typing/typeclass.ml(551):18415-18689
                                                                    (let
                                                                    (cty' =
                                                                    (after typing/typeclass.ml(551):18426-18458
                                                                    (apply
                                                                    (field 1
                                                                    (global Typetexp!))
                                                                    env 0a
                                                                    sty)))
                                                                    (before typing/typeclass.ml(552):18472-18689
                                                                    (let
                                                                    (ty' =
                                                                    (field 1
                                                                    cty'))
                                                                    (before typing/typeclass.ml(553):18510-18689
                                                                    (seq
                                                                    (try
                                                                    (after typing/typeclass.ml(554):18531-18553
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env ty'
                                                                    ty))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (let
                                                                    (trace =a
                                                                    (field 1
                                                                    exn))
                                                                    (before typing/typeclass.ml(555):18598-18655
                                                                    (raise
                                                                    (after typing/typeclass.ml(555):18603-18655
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    sty) env
                                                                    (makeblock 12
                                                                    trace))))))
                                                                    (reraise
                                                                    exn))))
                                                                    (before typing/typeclass.ml(557):18685-18689
                                                                    cty')))))))))
                                                                    styl
                                                                    params)))
                                                                    (before typing/typeclass.ml(560):18733-18827
                                                                    (let
                                                                    (typ =
                                                                    (makeblock 0
                                                                    path
                                                                    params
                                                                    clty))
                                                                    (before typing/typeclass.ml(561):18784-18827
                                                                    (after typing/typeclass.ml(561):18784-18827
                                                                    (apply
                                                                    cltyp
                                                                    (makeblock 0
                                                                    path lid
                                                                    ctys)
                                                                    typ))))))))))))))))
                                             case tag 1:
                                              (let
                                                (pcsig =a (field 0 *match*))
                                                (before typing/typeclass.ml(564):18863-18991
                                                  (let
                                                    (clsig =
                                                       (after typing/typeclass.ml(564):18875-18900
                                                         (apply
                                                           class_signature
                                                           env pcsig)))
                                                    (before typing/typeclass.ml(565):18910-18991
                                                      (let
                                                        (typ =
                                                           (makeblock 1
                                                             (field 2 clsig)))
                                                        (before typing/typeclass.ml(566):18959-18991
                                                          (after typing/typeclass.ml(566):18959-18991
                                                            (apply cltyp
                                                              (makeblock 1
                                                                clsig)
                                                              typ))))))))
                                             case tag 2:
                                              (let
                                                (scty =a (field 2 *match*)
                                                 sty =a (field 1 *match*)
                                                 l =a (field 0 *match*))
                                                (before typing/typeclass.ml(569):19032-19382
                                                  (let
                                                    (cty =
                                                       (after typing/typeclass.ml(569):19042-19074
                                                         (apply
                                                           (field 1
                                                             (global Typetexp!))
                                                           env 0a sty)))
                                                    (before typing/typeclass.ml(570):19084-19382
                                                      (let
                                                        (ty = (field 1 cty))
                                                        (before typing/typeclass.ml(571):19116-19382
                                                          (let
                                                            (ty =
                                                               (if
                                                                 (after typing/typeclass.ml(572):19136-19155
                                                                   (apply
                                                                    (field 52
                                                                    (global Btype!))
                                                                    l))
                                                                 (before typing/typeclass.ml(573):19169-19225
                                                                   (after typing/typeclass.ml(573):19169-19225
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    (makeblock 3
                                                                    (field 27
                                                                    (global Predef!))
                                                                    (makeblock 0
                                                                    ty 0a)
                                                                    (makemutable 0
                                                                    0a)))))
                                                                 (before typing/typeclass.ml(574):19239-19241
                                                                   ty)))
                                                            (before typing/typeclass.ml(575):19251-19382
                                                              (let
                                                                (clty =
                                                                   (after typing/typeclass.ml(575):19262-19281
                                                                    (apply
                                                                    class_type
                                                                    env scty)))
                                                                (before typing/typeclass.ml(576):19291-19382
                                                                  (let
                                                                    (typ =
                                                                    (makeblock 2
                                                                    l ty
                                                                    (field 1
                                                                    clty)))
                                                                    (before typing/typeclass.ml(577):19345-19382
                                                                    (after typing/typeclass.ml(577):19345-19382
                                                                    (apply
                                                                    cltyp
                                                                    (makeblock 2
                                                                    l cty
                                                                    clty)
                                                                    typ))))))))))))))
                                             case tag 3:
                                              (let (ext =a (field 0 *match*))
                                                (before typing/typeclass.ml(585):19585-19650
                                                  (raise
                                                    (after typing/typeclass.ml(585):19591-19650
                                                      (makeblock 0
                                                        Error_forward
                                                        (after typing/typeclass.ml(585):19606-19649
                                                          (apply
                                                            (field 8
                                                              (global Builtin_attributes!))
                                                            ext)))))))
                                             case tag 4:
                                              (let
                                                (e =a (field 1 *match*)
                                                 od =a (field 0 *match*))
                                                (before typing/typeclass.ml(580):19415-19551
                                                  (let
                                                    (*match* =
                                                       (after typing/typeclass.ml(580):19434-19457
                                                         (apply
                                                           (field 0
                                                             type_open_descr)
                                                           0a env od))
                                                     newenv =a
                                                       (field 1 *match*)
                                                     od =a (field 0 *match*))
                                                    (before typing/typeclass.ml(581):19467-19551
                                                      (let
                                                        (clty =
                                                           (after typing/typeclass.ml(581):19478-19497
                                                             (apply
                                                               class_type
                                                               newenv e)))
                                                        (before typing/typeclass.ml(582):19507-19551
                                                          (after typing/typeclass.ml(582):19507-19551
                                                            (apply cltyp
                                                              (makeblock 3 od
                                                                clty)
                                                              (field 1 clty)))))))))))))))))
                            (let
                              (class_type =
                                 (function env scty
                                   (funct-body typing/typeclass.ml(587)<ghost>:19667-19829
                                     (before typing/typeclass.ml(588):19680-19829
                                       (seq
                                         (setfield_ptr 0 delayed_meth_specs
                                           0a)
                                         (before typing/typeclass.ml(589):19708-19829
                                           (let
                                             (cty =
                                                (after typing/typeclass.ml(589):19718-19737
                                                  (apply class_type env scty)))
                                             (before typing/typeclass.ml(590):19743-19829
                                               (seq
                                                 (after typing/typeclass.ml(590):19743-19794
                                                   (apply
                                                     (field 14
                                                       (global Stdlib__list!))
                                                     (function prim stub
                                                       (let
                                                         (lzarg = prim
                                                          tag =a
                                                            (caml_obj_tag
                                                              lzarg))
                                                         (if (== tag 250)
                                                           (field 0 lzarg)
                                                           (if (== tag 246)
                                                             (apply
                                                               (field 1
                                                                 (global CamlinternalLazy!))
                                                               lzarg)
                                                             lzarg))))
                                                     (after typing/typeclass.ml(590):19764-19794
                                                       (apply
                                                         (field 8
                                                           (global Stdlib__list!))
                                                         (field 0
                                                           delayed_meth_specs)))))
                                                 (before typing/typeclass.ml(591):19798-19829
                                                   (seq
                                                     (setfield_ptr 0
                                                       delayed_meth_specs 0a)
                                                     (before typing/typeclass.ml(592):19826-19829
                                                       cty))))))))))))
                              (letrec
                                (class_field
                                   (function self_loc cl_num self_type meths
                                     vars arg cf
                                     (funct-body typing/typeclass.ml(596)<ghost>:19886-20060
                                       (before typing/typeclass.ml(597):19934-20060
                                         (after typing/typeclass.ml(597):19934-20060
                                           (apply
                                             (field 10
                                               (global Builtin_attributes!))
                                             0a (field 2 cf)
                                             (function param
                                               (funct-body typing/typeclass.ml(598):19989-20060
                                                 (before typing/typeclass.ml(598):20000-20059
                                                   (after typing/typeclass.ml(598):20000-20059
                                                     (apply class_field_aux
                                                       self_loc cl_num
                                                       self_type meths vars
                                                       arg cf))))))))))
                                  class_field_aux
                                    (function self_loc cl_num self_type meths
                                      vars param cf
                                      (funct-body typing/typeclass.ml(600)<ghost>:20082-28157
                                        (let
                                          (local_vals =a (field 8 param)
                                           local_meths =a (field 7 param)
                                           inher =a (field 6 param)
                                           warn_vals =a (field 5 param)
                                           concr_meths =a (field 4 param)
                                           fields =a (field 3 param)
                                           par_env =a (field 2 param)
                                           met_env =a (field 1 param)
                                           val_env =a (field 0 param))
                                          (before typing/typeclass.ml(603):20227-28157
                                            (let (loc = (field 1 cf))
                                              (before typing/typeclass.ml(604):20253-28157
                                                (let
                                                  (mkcf =
                                                     (function desc
                                                       (funct-body typing/typeclass.ml(604)<ghost>:20262-20340
                                                         (before typing/typeclass.ml(605):20273-20340
                                                           (makeblock 0 desc
                                                             loc
                                                             (field 2 cf))))))
                                                  (before typing/typeclass.ml(607):20348-28157
                                                    (let
                                                      (*match* = (field 0 cf))
                                                      (switch* *match*
                                                       case tag 0:
                                                        (let
                                                          (super =a
                                                             (field 2
                                                               *match*)
                                                           sparent =a
                                                             (field 1
                                                               *match*)
                                                           ovf =a
                                                             (field 0
                                                               *match*))
                                                          (before typing/typeclass.ml(609):20418-22140
                                                            (let
                                                              (parent =
                                                                 (after typing/typeclass.ml(609):20431-20472
                                                                   (apply
                                                                    class_expr
                                                                    cl_num
                                                                    val_env
                                                                    par_env
                                                                    sparent)))
                                                              (before typing/typeclass.ml(610):20482-22140
                                                                (let
                                                                  (inher =
                                                                    (let
                                                                    (*match* =
                                                                    (field 2
                                                                    parent))
                                                                    (catch
                                                                    (switch* *match*
                                                                    case tag 0:
                                                                    (let
                                                                    (tl =a
                                                                    (field 1
                                                                    *match*)
                                                                    p =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(612):20563-20579
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    p tl)
                                                                    inher)))
                                                                    case tag 1:
                                                                    (exit 90)
                                                                    case tag 2:
                                                                    (exit 90))
                                                                    with (90)
                                                                    (before typing/typeclass.ml(613):20595-20600
                                                                    inher))))
                                                                  (before typing/typeclass.ml(615):20616-22140
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(616):20663-20766
                                                                    (apply
                                                                    inheritance
                                                                    self_type
                                                                    val_env
                                                                    (makeblock 0
                                                                    ovf)
                                                                    concr_meths
                                                                    warn_vals
                                                                    (field 1
                                                                    sparent)
                                                                    (field 2
                                                                    parent)))
                                                                    warn_vals =a
                                                                    (field 2
                                                                    *match*)
                                                                    concr_meths =a
                                                                    (field 1
                                                                    *match*)
                                                                    cl_sig =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(620):20804-22140
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(621):20856-21273
                                                                    (apply
                                                                    (field 12
                                                                    (field 2
                                                                    (global Types!)))
                                                                    (function
                                                                    lab info
                                                                    param
                                                                    (funct-body typing/typeclass.ml(622):20876-21214
                                                                    (let
                                                                    (inh_vars =a
                                                                    (field 3
                                                                    param)
                                                                    par_env =a
                                                                    (field 2
                                                                    param)
                                                                    met_env =a
                                                                    (field 1
                                                                    param)
                                                                    val_env =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(623):20944-21213
                                                                    (let
                                                                    (ty =a
                                                                    (field 2
                                                                    info)
                                                                    vr =a
                                                                    (field 1
                                                                    info)
                                                                    mut =a
                                                                    (field 0
                                                                    info))
                                                                    (before typing/typeclass.ml(624):20983-21213
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(625):21036-21133
                                                                    (apply
                                                                    enter_val
                                                                    cl_num
                                                                    vars 1a
                                                                    lab mut
                                                                    vr ty
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    (field 1
                                                                    sparent)))
                                                                    par_env =a
                                                                    (field 3
                                                                    *match*)
                                                                    met_env =a
                                                                    (field 2
                                                                    *match*)
                                                                    val_env =a
                                                                    (field 1
                                                                    *match*)
                                                                    id =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(628):21163-21213
                                                                    (makeblock 0
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    lab id)
                                                                    inh_vars))))))))))
                                                                    (field 1
                                                                    cl_sig)
                                                                    (makeblock 0
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    0a)))
                                                                    inh_vars =a
                                                                    (field 3
                                                                    *match*)
                                                                    par_env =a
                                                                    (field 2
                                                                    *match*)
                                                                    met_env =a
                                                                    (field 1
                                                                    *match*)
                                                                    val_env =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(632):21328-22140
                                                                    (let
                                                                    (inh_meths =
                                                                    (after typing/typeclass.ml(633):21352-21445
                                                                    (apply
                                                                    (field 15
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (function
                                                                    lab rem
                                                                    (funct-body typing/typeclass.ml(633):21363-21414
                                                                    (before typing/typeclass.ml(633):21379-21413
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    lab
                                                                    (after typing/typeclass.ml(633):21385-21407
                                                                    (apply
                                                                    (field 10
                                                                    (global Ident!))
                                                                    lab)))
                                                                    rem))))
                                                                    (field 2
                                                                    cl_sig)
                                                                    0a)))
                                                                    (before typing/typeclass.ml(637):21479-22140
                                                                    (catch
                                                                    (if super
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    super)
                                                                    name =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(642):21648-21941
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(643):21701-21876
                                                                    (apply
                                                                    enter_met_env
                                                                    (makeblock 0
                                                                    (function
                                                                    s
                                                                    (funct-body typing/typeclass.ml(643):21722-21759
                                                                    (before typing/typeclass.ml(643):21732-21758
                                                                    (makeblock 20
                                                                    s)))))
                                                                    (field 1
                                                                    sparent)
                                                                    name
                                                                    (makeblock 3
                                                                    inh_meths
                                                                    cl_num)
                                                                    self_type
                                                                    val_env
                                                                    met_env
                                                                    par_env))
                                                                    par_env =a
                                                                    (field 3
                                                                    *match*)
                                                                    met_env =a
                                                                    (field 2
                                                                    *match*)
                                                                    val_env =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/typeclass.ml(647):21904-21941
                                                                    (let
                                                                    (super =
                                                                    (makeblock 0
                                                                    name)
                                                                    par_env =a
                                                                    par_env
                                                                    met_env =a
                                                                    met_env
                                                                    val_env =a
                                                                    val_env)
                                                                    (exit 69
                                                                    super
                                                                    par_env
                                                                    met_env
                                                                    val_env))))))
                                                                    (before typing/typeclass.ml(640):21574-21606
                                                                    (let
                                                                    (super =
                                                                    0a
                                                                    par_env =a
                                                                    par_env
                                                                    met_env =a
                                                                    met_env
                                                                    val_env =a
                                                                    val_env)
                                                                    (exit 69
                                                                    super
                                                                    par_env
                                                                    met_env
                                                                    val_env))))
                                                                    with (69 super par_env met_env val_env)
                                                                    (before typing/typeclass.ml(649):21957-22140
                                                                    (makeblock 0
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    (makeblock 0
                                                                    (makemutable 246
                                                                    (function
                                                                    param
                                                                    (after typing/typeclass.ml(650):21997-22059
                                                                    (apply
                                                                    mkcf
                                                                    (makeblock 0
                                                                    ovf
                                                                    parent
                                                                    super
                                                                    inh_vars
                                                                    inh_meths)))))
                                                                    fields)
                                                                    concr_meths
                                                                    warn_vals
                                                                    inher
                                                                    local_meths
                                                                    local_vals)))))))))))))))
                                                       case tag 1:
                                                        (let
                                                          (*match* =a
                                                             (field 0
                                                               *match*)
                                                           *match* =a
                                                             (field 2
                                                               *match*)
                                                           mut =a
                                                             (field 1
                                                               *match*)
                                                           lab =a
                                                             (field 0
                                                               *match*))
                                                          (switch* *match*
                                                           case tag 0:
                                                            (let
                                                              (styp =a
                                                                 (field 0
                                                                   *match*))
                                                              (before typing/typeclass.ml(655):22192-22840
                                                                (seq
                                                                  (if
                                                                    (field 0
                                                                    (field 47
                                                                    (global Clflags!)))
                                                                    (before typing/typeclass.ml(655):22219-22237
                                                                    (after typing/typeclass.ml(655):22219-22237
                                                                    (apply
                                                                    (field 7
                                                                    (global Ctype!))
                                                                    0a))) 0a)
                                                                  (before typing/typeclass.ml(656):22245-22840
                                                                    (let
                                                                    (cty =
                                                                    (after typing/typeclass.ml(656):22255-22301
                                                                    (apply
                                                                    (field 1
                                                                    (global Typetexp!))
                                                                    val_env
                                                                    0a styp)))
                                                                    (before typing/typeclass.ml(657):22311-22840
                                                                    (let
                                                                    (ty =
                                                                    (field 1
                                                                    cty))
                                                                    (before typing/typeclass.ml(658):22343-22840
                                                                    (seq
                                                                    (if
                                                                    (field 0
                                                                    (field 47
                                                                    (global Clflags!)))
                                                                    (before typing/typeclass.ml(658):22370-22449
                                                                    (seq
                                                                    (after typing/typeclass.ml(659):22384-22400
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(660):22410-22439
                                                                    (after typing/typeclass.ml(660):22410-22439
                                                                    (apply
                                                                    (field 41
                                                                    (global Ctype!))
                                                                    ty)))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(662):22457-22840
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(663):22504-22592
                                                                    (apply
                                                                    enter_val
                                                                    cl_num
                                                                    vars 0a
                                                                    (field 0
                                                                    lab) mut
                                                                    0a ty
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    loc))
                                                                    par_env =a
                                                                    (field 3
                                                                    *match*)
                                                                    met_env' =a
                                                                    (field 2
                                                                    *match*)
                                                                    val_env =a
                                                                    (field 1
                                                                    *match*)
                                                                    id =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(666):22608-22840
                                                                    (makeblock 0
                                                                    val_env
                                                                    met_env'
                                                                    par_env
                                                                    (makeblock 0
                                                                    (makemutable 246
                                                                    (function
                                                                    param
                                                                    (after typing/typeclass.ml(667):22649-22747
                                                                    (apply
                                                                    mkcf
                                                                    (makeblock 1
                                                                    lab mut
                                                                    id
                                                                    (makeblock 0
                                                                    cty)
                                                                    (==
                                                                    met_env
                                                                    met_env'))))))
                                                                    fields)
                                                                    concr_meths
                                                                    warn_vals
                                                                    inher
                                                                    local_meths
                                                                    local_vals)))))))))))))
                                                           case tag 1:
                                                            (let
                                                              (mut =a mut
                                                               lab =a lab
                                                               sexp =a
                                                                 (field 1
                                                                   *match*)
                                                               ovf =a
                                                                 (field 0
                                                                   *match*))
                                                              (before typing/typeclass.ml(673):22900-24017
                                                                (seq
                                                                  (if
                                                                    (after typing/typeclass.ml(673):22903-22931
                                                                    (apply
                                                                    (field 2
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    local_vals))
                                                                    (before typing/typeclass.ml(674):22945-23013
                                                                    (raise
                                                                    (after typing/typeclass.ml(674):22950-23013
                                                                    (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 23
                                                                    "instance variable"
                                                                    (field 0
                                                                    lab))))))
                                                                    0a)
                                                                  (before typing/typeclass.ml(675):23021-24017
                                                                    (seq
                                                                    (if
                                                                    (after typing/typeclass.ml(675):23024-23051
                                                                    (apply
                                                                    (field 2
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    warn_vals))
                                                                    (before typing/typeclass.ml(675):23057-23200
                                                                    (if
                                                                    (== ovf
                                                                    1a)
                                                                    (before typing/typeclass.ml(677):23101-23190
                                                                    (after typing/typeclass.ml(677):23101-23190
                                                                    (apply
                                                                    (field 34
                                                                    (global Location!))
                                                                    (field 1
                                                                    lab)
                                                                    (makeblock 5
                                                                    (makeblock 0
                                                                    (field 0
                                                                    lab) 0a)))))
                                                                    0a))
                                                                    (before typing/typeclass.ml(679):23206-23357
                                                                    (if
                                                                    (== ovf
                                                                    0a)
                                                                    (before typing/typeclass.ml(681):23253-23347
                                                                    (raise
                                                                    (after typing/typeclass.ml(681):23258-23347
                                                                    (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 22
                                                                    "instance variable"
                                                                    (field 0
                                                                    lab))))))
                                                                    0a)))
                                                                    (before typing/typeclass.ml(684):23365-24017
                                                                    (seq
                                                                    (if
                                                                    (field 0
                                                                    (field 47
                                                                    (global Clflags!)))
                                                                    (before typing/typeclass.ml(684):23392-23410
                                                                    (after typing/typeclass.ml(684):23392-23410
                                                                    (apply
                                                                    (field 7
                                                                    (global Ctype!))
                                                                    0a))) 0a)
                                                                    (before typing/typeclass.ml(685):23418-24017
                                                                    (let
                                                                    (exp =
                                                                    (after typing/typeclass.ml(685):23428-23449
                                                                    (apply
                                                                    (field 9
                                                                    (global Typecore!))
                                                                    val_env
                                                                    sexp)))
                                                                    (before typing/typeclass.ml(686):23459-24017
                                                                    (seq
                                                                    (if
                                                                    (field 0
                                                                    (field 47
                                                                    (global Clflags!)))
                                                                    (before typing/typeclass.ml(686):23486-23576
                                                                    (seq
                                                                    (after typing/typeclass.ml(687):23500-23516
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(688):23526-23565
                                                                    (after typing/typeclass.ml(688):23526-23565
                                                                    (apply
                                                                    (field 41
                                                                    (global Ctype!))
                                                                    (field 3
                                                                    exp))))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(690):23584-24017
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(691):23631-23730
                                                                    (apply
                                                                    enter_val
                                                                    cl_num
                                                                    vars 0a
                                                                    (field 0
                                                                    lab) mut
                                                                    1a
                                                                    (field 3
                                                                    exp)
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    loc))
                                                                    par_env =a
                                                                    (field 3
                                                                    *match*)
                                                                    met_env' =a
                                                                    (field 2
                                                                    *match*)
                                                                    val_env =a
                                                                    (field 1
                                                                    *match*)
                                                                    id =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(694):23746-24017
                                                                    (makeblock 0
                                                                    val_env
                                                                    met_env'
                                                                    par_env
                                                                    (makeblock 0
                                                                    (makemutable 246
                                                                    (function
                                                                    param
                                                                    (after typing/typeclass.ml(695):23787-23893
                                                                    (apply
                                                                    mkcf
                                                                    (makeblock 1
                                                                    lab mut
                                                                    id
                                                                    (makeblock 1
                                                                    ovf exp)
                                                                    (==
                                                                    met_env
                                                                    met_env'))))))
                                                                    fields)
                                                                    concr_meths
                                                                    (after typing/typeclass.ml(698):23932-23959
                                                                    (apply
                                                                    (field 3
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    warn_vals))
                                                                    inher
                                                                    local_meths
                                                                    (after typing/typeclass.ml(699):23988-24016
                                                                    (apply
                                                                    (field 3
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    local_vals)))))))))))))))))))
                                                       case tag 2:
                                                        (let
                                                          (*match* =a
                                                             (field 0
                                                               *match*)
                                                           *match* =a
                                                             (field 2
                                                               *match*)
                                                           priv =a
                                                             (field 1
                                                               *match*)
                                                           lab =a
                                                             (field 0
                                                               *match*))
                                                          (switch* *match*
                                                           case tag 0:
                                                            (let
                                                              (sty =a
                                                                 (field 0
                                                                   *match*))
                                                              (before typing/typeclass.ml(702):24072-24321
                                                                (let
                                                                  (cty =
                                                                    (after typing/typeclass.ml(702):24082-24141
                                                                    (apply
                                                                    virtual_method
                                                                    val_env
                                                                    meths
                                                                    self_type
                                                                    (field 0
                                                                    lab) priv
                                                                    sty loc)))
                                                                  (before typing/typeclass.ml(703):24151-24321
                                                                    (makeblock 0
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    (makeblock 0
                                                                    (makemutable 246
                                                                    (function
                                                                    param
                                                                    (after typing/typeclass.ml(704):24192-24240
                                                                    (apply
                                                                    mkcf
                                                                    (makeblock 2
                                                                    lab priv
                                                                    (makeblock 0
                                                                    cty))))))
                                                                    fields)
                                                                    concr_meths
                                                                    warn_vals
                                                                    inher
                                                                    local_meths
                                                                    local_vals)))))
                                                           case tag 1:
                                                            (let
                                                              (priv =a priv
                                                               lab =a lab
                                                               expr =a
                                                                 (field 1
                                                                   *match*)
                                                               ovf =a
                                                                 (field 0
                                                                   *match*))
                                                              (before typing/typeclass.ml(709):24386-26931
                                                                (let
                                                                  (expr =
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    expr))
                                                                    (catch
                                                                    (switch *match*
                                                                    case tag 29:
                                                                    (before typing/typeclass.ml(711):24456-24460
                                                                    expr)
                                                                    default:
                                                                    (exit
                                                                    109))
                                                                    with (109)
                                                                    (before typing/typeclass.ml(712):24476-24524
                                                                    (after typing/typeclass.ml(712):24476-24524
                                                                    (apply
                                                                    (field 31
                                                                    (field 6
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    (field 1
                                                                    expr)) 0a
                                                                    expr 0a))))))
                                                                  (before typing/typeclass.ml(714):24540-26931
                                                                    (seq
                                                                    (if
                                                                    (after typing/typeclass.ml(714):24543-24572
                                                                    (apply
                                                                    (field 2
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    local_meths))
                                                                    (before typing/typeclass.ml(715):24586-24643
                                                                    (raise
                                                                    (after typing/typeclass.ml(715):24591-24643
                                                                    (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 23
                                                                    "method"
                                                                    (field 0
                                                                    lab))))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(716):24651-26931
                                                                    (seq
                                                                    (if
                                                                    (after typing/typeclass.ml(716):24654-24683
                                                                    (apply
                                                                    (field 2
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    concr_meths))
                                                                    (before typing/typeclass.ml(716):24689-24806
                                                                    (if
                                                                    (== ovf
                                                                    1a)
                                                                    (before typing/typeclass.ml(718):24733-24796
                                                                    (after typing/typeclass.ml(718):24733-24796
                                                                    (apply
                                                                    (field 34
                                                                    (global Location!))
                                                                    loc
                                                                    (makeblock 2
                                                                    (makeblock 0
                                                                    (field 0
                                                                    lab) 0a)))))
                                                                    0a))
                                                                    (before typing/typeclass.ml(719):24812-24929
                                                                    (if
                                                                    (== ovf
                                                                    0a)
                                                                    (before typing/typeclass.ml(721):24859-24919
                                                                    (raise
                                                                    (after typing/typeclass.ml(721):24864-24919
                                                                    (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 22
                                                                    "method"
                                                                    (field 0
                                                                    lab))))))
                                                                    0a)))
                                                                    (before typing/typeclass.ml(723):24937-26931
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(724):24959-25020
                                                                    (apply
                                                                    (field 75
                                                                    (global Ctype!))
                                                                    val_env
                                                                    (field 0
                                                                    lab) priv
                                                                    meths
                                                                    self_type))
                                                                    ty =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/typeclass.ml(726):25036-26931
                                                                    (seq
                                                                    (try
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    expr))
                                                                    (catch
                                                                    (switch *match*
                                                                    case tag 29:
                                                                    (let
                                                                    (sty =a
                                                                    (field 1
                                                                    *match*)
                                                                    sbody =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(728):25116-25908
                                                                    (seq
                                                                    (if sty
                                                                    (let
                                                                    (sty =a
                                                                    (field 0
                                                                    sty))
                                                                    (before typing/typeclass.ml(730):25198-25409
                                                                    (let
                                                                    (sty =
                                                                    (after typing/typeclass.ml(730):25208-25237
                                                                    (apply
                                                                    (field 14
                                                                    (field 4
                                                                    (global Ast_helper!)))
                                                                    sty)))
                                                                    (before typing/typeclass.ml(731):25261-25409
                                                                    (let
                                                                    (cty' =
                                                                    (after typing/typeclass.ml(731):25272-25317
                                                                    (apply
                                                                    (field 1
                                                                    (global Typetexp!))
                                                                    val_env
                                                                    0a sty)))
                                                                    (before typing/typeclass.ml(732):25341-25409
                                                                    (let
                                                                    (ty' =
                                                                    (field 1
                                                                    cty'))
                                                                    (before typing/typeclass.ml(733):25383-25409
                                                                    (after typing/typeclass.ml(733):25383-25409
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    ty' ty))))))))))
                                                                    (before typing/typeclass.ml(728):25145-25147
                                                                    0a))
                                                                    (before typing/typeclass.ml(735):25435-25908
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    (after typing/typeclass.ml(735):25447-25462
                                                                    (apply
                                                                    (field 24
                                                                    (global Ctype!))
                                                                    ty))))
                                                                    (catch
                                                                    (switch *match*
                                                                    case tag 0:
                                                                    (before typing/typeclass.ml(737):25509-25673
                                                                    (let
                                                                    (ty' =
                                                                    (after typing/typeclass.ml(737):25519-25534
                                                                    (apply
                                                                    (field 18
                                                                    (global Ctype!))
                                                                    0a 0a)))
                                                                    (before typing/typeclass.ml(738):25552-25673
                                                                    (seq
                                                                    (after typing/typeclass.ml(738):25552-25606
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    (after typing/typeclass.ml(738):25572-25603
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    (makeblock 10
                                                                    ty' 0a)))
                                                                    ty))
                                                                    (before typing/typeclass.ml(739):25622-25673
                                                                    (after typing/typeclass.ml(739):25622-25673
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    (after typing/typeclass.ml(739):25642-25669
                                                                    (apply
                                                                    (field 10
                                                                    (global Typecore!))
                                                                    val_env
                                                                    sbody))
                                                                    ty')))))))
                                                                    case tag 10:
                                                                    (let
                                                                    (tl =a
                                                                    (field 1
                                                                    *match*)
                                                                    ty1 =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(741):25719-25864
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(741):25733-25765
                                                                    (apply
                                                                    (field 56
                                                                    (global Ctype!))
                                                                    0a 0a tl
                                                                    ty1))
                                                                    ty1' =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/typeclass.ml(742):25783-25864
                                                                    (let
                                                                    (ty2 =
                                                                    (after typing/typeclass.ml(742):25793-25818
                                                                    (apply
                                                                    (field 10
                                                                    (global Typecore!))
                                                                    val_env
                                                                    sbody)))
                                                                    (before typing/typeclass.ml(743):25836-25864
                                                                    (after typing/typeclass.ml(743):25836-25864
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    ty2 ty1'))))))))
                                                                    default:
                                                                    (exit
                                                                    104))
                                                                    with (104)
                                                                    (before typing/typeclass.ml(744):25882-25894
                                                                    (raise
                                                                    (after typing/typeclass.ml(744):25882-25894
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/typeclass.ml"
                                                                    744 17]))))))))))
                                                                    default:
                                                                    (exit
                                                                    105))
                                                                    with (105)
                                                                    (before typing/typeclass.ml(746):25922-25934
                                                                    (raise
                                                                    (after typing/typeclass.ml(746):25922-25934
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/typeclass.ml"
                                                                    746 13]))))))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (let
                                                                    (trace =a
                                                                    (field 1
                                                                    exn))
                                                                    (before typing/typeclass.ml(748):25975-26069
                                                                    (raise
                                                                    (after typing/typeclass.ml(748):25980-26069
                                                                    (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 1
                                                                    "method"
                                                                    (field 0
                                                                    lab)
                                                                    trace))))))
                                                                    (reraise
                                                                    exn))))
                                                                    (before typing/typeclass.ml(751):26087-26931
                                                                    (let
                                                                    (meth_expr =
                                                                    (after typing/typeclass.ml(751):26103-26135
                                                                    (apply
                                                                    make_method
                                                                    self_loc
                                                                    cl_num
                                                                    expr)))
                                                                    (before typing/typeclass.ml(753):26192-26931
                                                                    (let
                                                                    (vars_local =
                                                                    (field 0
                                                                    vars))
                                                                    (before typing/typeclass.ml(755):26225-26931
                                                                    (let
                                                                    (field =
                                                                    (after typing/typeclass.ml(756):26245-26767
                                                                    (apply
                                                                    (field 15
                                                                    (global Warnings!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(757):26272-26767
                                                                    (before typing/typeclass.ml(759):26341-26755
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(759):26355-26380
                                                                    (apply
                                                                    (field 26
                                                                    (field 1
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    (field 0
                                                                    meths)))
                                                                    ty =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/typeclass.ml(760):26397-26755
                                                                    (let
                                                                    (meth_type =
                                                                    (after typing/typeclass.ml(760):26413-26509
                                                                    (apply
                                                                    (field 0
                                                                    (global Typecore!))
                                                                    0a
                                                                    (after typing/typeclass.ml(760):26425-26509
                                                                    (apply
                                                                    (field 5
                                                                    (global Btype!))
                                                                    (makeblock 1
                                                                    0a
                                                                    self_type
                                                                    ty 0a))))))
                                                                    (before typing/typeclass.ml(763):26526-26755
                                                                    (seq
                                                                    (after typing/typeclass.ml(763):26526-26553
                                                                    (apply
                                                                    (field 10
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(764):26568-26755
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    vars
                                                                    vars_local)
                                                                    (before typing/typeclass.ml(765):26601-26755
                                                                    (let
                                                                    (texp =
                                                                    (after typing/typeclass.ml(765):26612-26651
                                                                    (apply
                                                                    (field 8
                                                                    (global Typecore!))
                                                                    0a
                                                                    met_env
                                                                    meth_expr
                                                                    meth_type)))
                                                                    (before typing/typeclass.ml(766):26668-26755
                                                                    (seq
                                                                    (after typing/typeclass.ml(766):26668-26684
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(767):26699-26755
                                                                    (after typing/typeclass.ml(767):26699-26755
                                                                    (apply
                                                                    mkcf
                                                                    (makeblock 2
                                                                    lab priv
                                                                    (makeblock 1
                                                                    ovf texp))))))))))))))))))))))
                                                                    (before typing/typeclass.ml(770):26783-26931
                                                                    (makeblock 0
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    (makeblock 0
                                                                    field
                                                                    fields)
                                                                    (after typing/typeclass.ml(771):26833-26862
                                                                    (apply
                                                                    (field 3
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    concr_meths))
                                                                    warn_vals
                                                                    inher
                                                                    (after typing/typeclass.ml(772):26889-26918
                                                                    (apply
                                                                    (field 3
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    lab)
                                                                    local_meths))
                                                                    local_vals)))))))))))))))))))))
                                                       case tag 3:
                                                        (let
                                                          (*match* =a
                                                             (field 0
                                                               *match*)
                                                           sty' =a
                                                             (field 1
                                                               *match*)
                                                           sty =a
                                                             (field 0
                                                               *match*))
                                                          (before typing/typeclass.ml(775):26973-27188
                                                            (let
                                                              (*match* =
                                                                 (after typing/typeclass.ml(775):26991-27027
                                                                   (apply
                                                                    type_constraint
                                                                    val_env
                                                                    sty sty'
                                                                    loc))
                                                               cty' =a
                                                                 (field 1
                                                                   *match*)
                                                               cty =a
                                                                 (field 0
                                                                   *match*))
                                                              (before typing/typeclass.ml(776):27037-27188
                                                                (makeblock 0
                                                                  val_env
                                                                  met_env
                                                                  par_env
                                                                  (makeblock 0
                                                                    (makemutable 246
                                                                    (function
                                                                    param
                                                                    (after typing/typeclass.ml(777):27078-27113
                                                                    (apply
                                                                    mkcf
                                                                    (makeblock 3
                                                                    cty cty')))))
                                                                    fields)
                                                                  concr_meths
                                                                  warn_vals
                                                                  inher
                                                                  local_meths
                                                                  local_vals)))))
                                                       case tag 4:
                                                        (let
                                                          (expr =a
                                                             (field 0
                                                               *match*))
                                                          (before typing/typeclass.ml(781):27224-27844
                                                            (let
                                                              (expr =
                                                                 (after typing/typeclass.ml(781):27235-27267
                                                                   (apply
                                                                    make_method
                                                                    self_loc
                                                                    cl_num
                                                                    expr)))
                                                              (before typing/typeclass.ml(782):27277-27844
                                                                (let
                                                                  (vars_local =
                                                                    (field 0
                                                                    vars))
                                                                  (before typing/typeclass.ml(783):27309-27844
                                                                    (let
                                                                    (field =
                                                                    (makemutable 246
                                                                    (function
                                                                    param
                                                                    (seq
                                                                    (after typing/typeclass.ml(785):27350-27377
                                                                    (apply
                                                                    (field 10
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(786):27389-27717
                                                                    (let
                                                                    (meth_type =
                                                                    (after typing/typeclass.ml(786):27405-27559
                                                                    (apply
                                                                    (field 0
                                                                    (global Typecore!))
                                                                    0a
                                                                    (after typing/typeclass.ml(786):27417-27559
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    (makeblock 1
                                                                    0a
                                                                    self_type
                                                                    (after typing/typeclass.ml(789):27509-27540
                                                                    (apply
                                                                    (field 46
                                                                    (global Ctype!))
                                                                    0a
                                                                    (field 6
                                                                    (global Predef!))))
                                                                    0a))))))
                                                                    (before typing/typeclass.ml(791):27573-27717
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    vars
                                                                    vars_local)
                                                                    (before typing/typeclass.ml(792):27603-27717
                                                                    (let
                                                                    (texp =
                                                                    (after typing/typeclass.ml(792):27614-27648
                                                                    (apply
                                                                    (field 8
                                                                    (global Typecore!))
                                                                    0a
                                                                    met_env
                                                                    expr
                                                                    meth_type)))
                                                                    (before typing/typeclass.ml(793):27662-27717
                                                                    (seq
                                                                    (after typing/typeclass.ml(793):27662-27678
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(794):27690-27717
                                                                    (after typing/typeclass.ml(794):27690-27717
                                                                    (apply
                                                                    mkcf
                                                                    (makeblock 4
                                                                    texp))))))))))))))))
                                                                    (before typing/typeclass.ml(796):27739-27844
                                                                    (makeblock 0
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    (makeblock 0
                                                                    field
                                                                    fields)
                                                                    concr_meths
                                                                    warn_vals
                                                                    inher
                                                                    local_meths
                                                                    local_vals)))))))))
                                                       case tag 5:
                                                        (let
                                                          (x =a
                                                             (field 0
                                                               *match*))
                                                          (before typing/typeclass.ml(799):27874-28060
                                                            (seq
                                                              (after typing/typeclass.ml(799):27874-27912
                                                                (apply
                                                                  (field 9
                                                                    (global Builtin_attributes!))
                                                                  0a x))
                                                              (before typing/typeclass.ml(800):27920-28060
                                                                (makeblock 0
                                                                  val_env
                                                                  met_env
                                                                  par_env
                                                                  (makeblock 0
                                                                    (makemutable 246
                                                                    (function
                                                                    param
                                                                    (after typing/typeclass.ml(801):27961-27985
                                                                    (apply
                                                                    mkcf
                                                                    (makeblock 5
                                                                    x)))))
                                                                    fields)
                                                                  concr_meths
                                                                  warn_vals
                                                                  inher
                                                                  local_meths
                                                                  local_vals)))))
                                                       case tag 6:
                                                        (let
                                                          (ext =a
                                                             (field 0
                                                               *match*))
                                                          (before typing/typeclass.ml(804):28092-28157
                                                            (raise
                                                              (after typing/typeclass.ml(804):28098-28157
                                                                (makeblock 0
                                                                  Error_forward
                                                                  (after typing/typeclass.ml(804):28113-28156
                                                                    (apply
                                                                    (field 8
                                                                    (global Builtin_attributes!))
                                                                    ext)))))))))))))))))
                                  class_structure
                                    (function cl_num final val_env met_env
                                      loc param
                                      (funct-body typing/typeclass.ml(815)<ghost>:28685-33382
                                        (let
                                          (str =a (field 1 param)
                                           spat =a (field 0 param))
                                          (before typing/typeclass.ml(818):28804-33382
                                            (let (par_env = met_env)
                                              (before typing/typeclass.ml(821):28895-33382
                                                (let
                                                  (self_loc =
                                                     (let
                                                       (init = (field 1 spat))
                                                       (makeblock 0
                                                         (field 0 init)
                                                         (field 1 init) 1a)))
                                                  (before typing/typeclass.ml(823):28963-33382
                                                    (let
                                                      (self_type =
                                                         (after typing/typeclass.ml(823):28979-29009
                                                           (apply
                                                             (field 21
                                                               (global Ctype!))
                                                             (after typing/typeclass.ml(823):28992-29009
                                                               (apply
                                                                 (field 18
                                                                   (global Ctype!))
                                                                 0a 0a)))))
                                                      (before typing/typeclass.ml(828):29153-33382
                                                        (seq
                                                          (if (not final)
                                                            (before typing/typeclass.ml(829):29175-29293
                                                              (after typing/typeclass.ml(829):29175-29293
                                                                (apply
                                                                  (field 66
                                                                    (global Ctype!))
                                                                  val_env
                                                                  (after typing/typeclass.ml(830):29201-29261
                                                                    (apply
                                                                    (field 71
                                                                    (global Ctype!))
                                                                    val_env
                                                                    dummy_method
                                                                    0a
                                                                    self_type))
                                                                  (after typing/typeclass.ml(831):29268-29293
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    [2: 0a])))))
                                                            0a)
                                                          (before typing/typeclass.ml(834):29352-33382
                                                            (let
                                                              (private_self =
                                                                 (if final
                                                                   (before typing/typeclass.ml(834):29385-29400
                                                                    (after typing/typeclass.ml(834):29385-29400
                                                                    (apply
                                                                    (field 18
                                                                    (global Ctype!))
                                                                    0a 0a)))
                                                                   (before typing/typeclass.ml(834):29406-29415
                                                                    self_type)))
                                                              (before typing/typeclass.ml(837):29442-33382
                                                                (let
                                                                  (*match* =
                                                                    (after typing/typeclass.ml(838):29499-29565
                                                                    (apply
                                                                    (field 6
                                                                    (global Typecore!))
                                                                    cl_num
                                                                    private_self
                                                                    val_env
                                                                    met_env
                                                                    par_env
                                                                    spat))
                                                                   par_env =a
                                                                    (field 5
                                                                    *match*)
                                                                   meth_env =a
                                                                    (field 4
                                                                    *match*)
                                                                   val_env =a
                                                                    (field 3
                                                                    *match*)
                                                                   vars =a
                                                                    (field 2
                                                                    *match*)
                                                                   meths =a
                                                                    (field 1
                                                                    *match*)
                                                                   pat =a
                                                                    (field 0
                                                                    *match*))
                                                                  (before typing/typeclass.ml(840):29573-33382
                                                                    (let
                                                                    (public_self =
                                                                    (field 3
                                                                    pat))
                                                                    (before typing/typeclass.ml(843):29659-33382
                                                                    (let
                                                                    (ty =
                                                                    (if final
                                                                    (before typing/typeclass.ml(844):29686-29734
                                                                    (after typing/typeclass.ml(844):29686-29734
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    (makeblock 4
                                                                    (after typing/typeclass.ml(844):29708-29722
                                                                    (apply
                                                                    (field 18
                                                                    (global Ctype!))
                                                                    0a 0a))
                                                                    (makemutable 0
                                                                    0a)))))
                                                                    (before typing/typeclass.ml(845):29744-29753
                                                                    self_type)))
                                                                    (before typing/typeclass.ml(846):29759-33382
                                                                    (seq
                                                                    (try
                                                                    (after typing/typeclass.ml(846):29769-29803
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    public_self
                                                                    ty))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (before typing/typeclass.ml(848):29836-29904
                                                                    (raise
                                                                    (after typing/typeclass.ml(848):29841-29904
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    spat)
                                                                    val_env
                                                                    (makeblock 5
                                                                    public_self)))))
                                                                    (reraise
                                                                    exn))))
                                                                    (before typing/typeclass.ml(850):29914-33382
                                                                    (let
                                                                    (get_methods =
                                                                    (function
                                                                    ty
                                                                    (funct-body typing/typeclass.ml(850)<ghost>:29930-30032
                                                                    (before typing/typeclass.ml(851):29939-30032
                                                                    (field 0
                                                                    (after typing/typeclass.ml(851):29944-30031
                                                                    (apply
                                                                    (field 26
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(852):29978-30030
                                                                    (apply
                                                                    (field 25
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(852):29999-30029
                                                                    (apply
                                                                    (field 60
                                                                    (global Ctype!))
                                                                    val_env
                                                                    ty)))))))))))
                                                                    (before typing/typeclass.ml(853):30038-33382
                                                                    (seq
                                                                    (if final
                                                                    (before typing/typeclass.ml(853):30052-30415
                                                                    (after typing/typeclass.ml(853):30052-30415
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(856):30136-30377
                                                                    (let
                                                                    (ty =a
                                                                    (field 2
                                                                    param)
                                                                    kind =a
                                                                    (field 1
                                                                    param)
                                                                    lab =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(857):30166-30376
                                                                    (let
                                                                    (k =
                                                                    (if
                                                                    (==
                                                                    (after typing/typeclass.ml(858):30187-30213
                                                                    (apply
                                                                    (field 13
                                                                    (global Btype!))
                                                                    kind))
                                                                    0a)
                                                                    (before typing/typeclass.ml(858):30230-30236
                                                                    1a)
                                                                    (before typing/typeclass.ml(858):30242-30249
                                                                    0a)))
                                                                    (before typing/typeclass.ml(859):30261-30376
                                                                    (try
                                                                    (after typing/typeclass.ml(859):30265-30345
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    ty
                                                                    (after typing/typeclass.ml(860):30300-30345
                                                                    (apply
                                                                    (field 71
                                                                    (global Ctype!))
                                                                    val_env
                                                                    lab k
                                                                    self_type))))
                                                                    with exn
                                                                    (before typing/typeclass.ml(861):30364-30376
                                                                    (raise
                                                                    (after typing/typeclass.ml(861):30364-30376
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/typeclass.ml"
                                                                    861 18])))))))))))
                                                                    (after typing/typeclass.ml(862):30384-30409
                                                                    (apply
                                                                    get_methods
                                                                    public_self)))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(866):30451-33382
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(867):30529-30791
                                                                    (apply
                                                                    (field 10
                                                                    (global Builtin_attributes!))
                                                                    0a 0a
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(868):30571-30791
                                                                    (before typing/typeclass.ml(869):30591-30783
                                                                    (after typing/typeclass.ml(869):30591-30783
                                                                    (apply
                                                                    (field 20
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(869):30606-30656
                                                                    (apply
                                                                    class_field
                                                                    self_loc
                                                                    cl_num
                                                                    self_type
                                                                    meths
                                                                    vars))
                                                                    (makeblock 0
                                                                    val_env
                                                                    meth_env
                                                                    par_env
                                                                    0a
                                                                    (field 0
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    (field 8
                                                                    (global Types!)))
                                                                    0a
                                                                    (field 0
                                                                    (field 8
                                                                    (global Types!)))
                                                                    (field 0
                                                                    (field 8
                                                                    (global Types!))))
                                                                    str)))))))
                                                                    inher =a
                                                                    (field 6
                                                                    *match*)
                                                                    concr_meths =a
                                                                    (field 4
                                                                    *match*)
                                                                    fields =a
                                                                    (field 3
                                                                    *match*))
                                                                    (before typing/typeclass.ml(875):30799-33382
                                                                    (seq
                                                                    (after typing/typeclass.ml(875):30799-30846
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    self_type
                                                                    (after typing/typeclass.ml(875):30829-30846
                                                                    (apply
                                                                    (field 18
                                                                    (global Ctype!))
                                                                    0a 0a))))
                                                                    (before typing/typeclass.ml(876):30850-33382
                                                                    (let
                                                                    (sign =
                                                                    (makeblock 0
                                                                    public_self
                                                                    (after typing/typeclass.ml(878):30908-30964
                                                                    (apply
                                                                    (field 32
                                                                    (field 2
                                                                    (global Types!)))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(878):30917-30958
                                                                    (let
                                                                    (ty =a
                                                                    (field 3
                                                                    param)
                                                                    vr =a
                                                                    (field 2
                                                                    param)
                                                                    mut =a
                                                                    (field 1
                                                                    param))
                                                                    (before typing/typeclass.ml(878):30944-30957
                                                                    (makeblock 0
                                                                    mut vr
                                                                    ty)))))
                                                                    (field 0
                                                                    vars)))
                                                                    concr_meths
                                                                    inher))
                                                                    (before typing/typeclass.ml(881):31028-33382
                                                                    (let
                                                                    (methods =
                                                                    (after typing/typeclass.ml(881):31042-31063
                                                                    (apply
                                                                    get_methods
                                                                    self_type)))
                                                                    (before typing/typeclass.ml(882):31069-33382
                                                                    (let
                                                                    (priv_meths =
                                                                    (after typing/typeclass.ml(883):31090-31174
                                                                    (apply
                                                                    (field 35
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(883):31102-31160
                                                                    (let
                                                                    (kind =a
                                                                    (field 1
                                                                    param))
                                                                    (before typing/typeclass.ml(883):31121-31159
                                                                    (!=
                                                                    (after typing/typeclass.ml(883):31121-31147
                                                                    (apply
                                                                    (field 13
                                                                    (global Btype!))
                                                                    kind))
                                                                    0a)))))
                                                                    methods)))
                                                                    (before typing/typeclass.ml(885):31180-33382
                                                                    (seq
                                                                    (if final
                                                                    (before typing/typeclass.ml(885):31194-32174
                                                                    (seq
                                                                    (if
                                                                    (not
                                                                    (after typing/typeclass.ml(888):31320-31350
                                                                    (apply
                                                                    (field 29
                                                                    (global Ctype!))
                                                                    self_type)))
                                                                    (before typing/typeclass.ml(889):31362-31417
                                                                    (raise
                                                                    (after typing/typeclass.ml(889):31367-31417
                                                                    (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 24
                                                                    self_type)))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(890):31423-32168
                                                                    (let
                                                                    (mets =
                                                                    (after typing/typeclass.ml(890):31434-31483
                                                                    (apply
                                                                    virtual_methods
                                                                    (let
                                                                    (init =
                                                                    sign)
                                                                    (makeblock 0
                                                                    self_type
                                                                    (field 1
                                                                    init)
                                                                    (field 2
                                                                    init)
                                                                    (field 3
                                                                    init))))))
                                                                    (before typing/typeclass.ml(891):31491-32168
                                                                    (let
                                                                    (vals =
                                                                    (after typing/typeclass.ml(892):31508-31621
                                                                    (apply
                                                                    (field 12
                                                                    (field 2
                                                                    (global Types!)))
                                                                    (function
                                                                    name
                                                                    param l
                                                                    (funct-body typing/typeclass.ml(893):31526-31595
                                                                    (let
                                                                    (vr =a
                                                                    (field 1
                                                                    param))
                                                                    (before typing/typeclass.ml(893):31557-31594
                                                                    (if
                                                                    (== vr
                                                                    0a)
                                                                    (before typing/typeclass.ml(893):31578-31587
                                                                    (makeblock 0
                                                                    name l))
                                                                    (before typing/typeclass.ml(893):31593-31594
                                                                    l))))))
                                                                    (field 1
                                                                    sign) 0a)))
                                                                    (before typing/typeclass.ml(895):31629-32168
                                                                    (seq
                                                                    (if
                                                                    (||
                                                                    (!= mets
                                                                    0a)
                                                                    (!= vals
                                                                    0a))
                                                                    (before typing/typeclass.ml(896):31668-31734
                                                                    (raise
                                                                    (after typing/typeclass.ml(896):31673-31734
                                                                    (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 10
                                                                    1a final
                                                                    mets
                                                                    vals)))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(897):31740-32168
                                                                    (let
                                                                    (self_methods =
                                                                    (after typing/typeclass.ml(898):31765-31917
                                                                    (apply
                                                                    (field 21
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param rem
                                                                    (funct-body typing/typeclass.ml(899):31789-31882
                                                                    (let
                                                                    (ty =a
                                                                    (field 2
                                                                    param)
                                                                    kind =a
                                                                    (field 1
                                                                    param)
                                                                    lab =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(900):31826-31881
                                                                    (after typing/typeclass.ml(900):31826-31881
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    (makeblock 5
                                                                    lab
                                                                    (after typing/typeclass.ml(900):31850-31870
                                                                    (apply
                                                                    (field 36
                                                                    (global Btype!))
                                                                    kind)) ty
                                                                    rem)))))))
                                                                    methods
                                                                    (after typing/typeclass.ml(901):31899-31917
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    0a)))))
                                                                    (before typing/typeclass.ml(902):31925-32167
                                                                    (try
                                                                    (seq
                                                                    (after typing/typeclass.ml(903):31941-32029
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    private_self
                                                                    (after typing/typeclass.ml(904):31982-32029
                                                                    (apply
                                                                    (field 17
                                                                    (global Ctype!))
                                                                    (makeblock 4
                                                                    self_methods
                                                                    (makemutable 0
                                                                    0a))))))
                                                                    (before typing/typeclass.ml(905):32037-32078
                                                                    (after typing/typeclass.ml(905):32037-32078
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    public_self
                                                                    self_type))))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (let
                                                                    (trace =a
                                                                    (field 1
                                                                    exn))
                                                                    (before typing/typeclass.ml(906):32109-32159
                                                                    (raise
                                                                    (after typing/typeclass.ml(906):32114-32159
                                                                    (makeblock 0
                                                                    Error loc
                                                                    val_env
                                                                    (makeblock 20
                                                                    trace))))))
                                                                    (reraise
                                                                    exn)))))))))))))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(911):32244-33382
                                                                    (seq
                                                                    (let
                                                                    (ms =
                                                                    (field 0
                                                                    meths))
                                                                    (before typing/typeclass.ml(914):32341-32612
                                                                    (seq
                                                                    (after typing/typeclass.ml(914):32341-32398
                                                                    (apply
                                                                    (field 11
                                                                    (field 1
                                                                    (global Types!)))
                                                                    (function
                                                                    param
                                                                    param
                                                                    (funct-body typing/typeclass.ml(914):32352-32395
                                                                    (let
                                                                    (ty =a
                                                                    (field 1
                                                                    param))
                                                                    (before typing/typeclass.ml(914):32369-32394
                                                                    (after typing/typeclass.ml(914):32369-32394
                                                                    (apply
                                                                    (field 42
                                                                    (global Ctype!))
                                                                    ty))))))
                                                                    ms))
                                                                    (before typing/typeclass.ml(915):32404-32612
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    meths
                                                                    (after typing/typeclass.ml(916):32419-32480
                                                                    (apply
                                                                    (field 32
                                                                    (field 1
                                                                    (global Types!)))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(916):32429-32477
                                                                    (let
                                                                    (ty =a
                                                                    (field 1
                                                                    param)
                                                                    id =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(916):32445-32476
                                                                    (makeblock 0
                                                                    id
                                                                    (after typing/typeclass.ml(916):32450-32475
                                                                    (apply
                                                                    (field 47
                                                                    (global Ctype!))
                                                                    ty)))))))
                                                                    ms)))
                                                                    (before typing/typeclass.ml(918):32540-32612
                                                                    (after typing/typeclass.ml(918):32540-32612
                                                                    (apply
                                                                    (field 11
                                                                    (field 1
                                                                    (global Types!)))
                                                                    (function
                                                                    param
                                                                    param
                                                                    (funct-body typing/typeclass.ml(918):32551-32609
                                                                    (let
                                                                    (ty =a
                                                                    (field 1
                                                                    param))
                                                                    (before typing/typeclass.ml(918):32568-32608
                                                                    (after typing/typeclass.ml(918):32568-32608
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    ty
                                                                    (after typing/typeclass.ml(918):32591-32608
                                                                    (apply
                                                                    (field 18
                                                                    (global Ctype!))
                                                                    0a 0a))))))))
                                                                    ms))))))))
                                                                    (before typing/typeclass.ml(920):32622-33382
                                                                    (let
                                                                    (fields =
                                                                    (after typing/typeclass.ml(920):32635-32672
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    prim stub
                                                                    (let
                                                                    (lzarg =
                                                                    prim
                                                                    tag =a
                                                                    (caml_obj_tag
                                                                    lzarg))
                                                                    (if
                                                                    (== tag
                                                                    250)
                                                                    (field 0
                                                                    lzarg)
                                                                    (if
                                                                    (== tag
                                                                    246)
                                                                    (apply
                                                                    (field 1
                                                                    (global CamlinternalLazy!))
                                                                    lzarg)
                                                                    lzarg))))
                                                                    (after typing/typeclass.ml(920):32655-32672
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__list!))
                                                                    fields)))))
                                                                    (before typing/typeclass.ml(921):32678-33382
                                                                    (let
                                                                    (meths =
                                                                    (after typing/typeclass.ml(921):32690-32733
                                                                    (apply
                                                                    (field 32
                                                                    (field 1
                                                                    (global Types!)))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(921):32700-32726
                                                                    (let
                                                                    (id =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(921):32723-32725
                                                                    id))))
                                                                    (field 0
                                                                    meths))))
                                                                    (before typing/typeclass.ml(924):32786-33382
                                                                    (let
                                                                    (pub_meths' =
                                                                    (after typing/typeclass.ml(925):32807-32908
                                                                    (apply
                                                                    (field 35
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(925):32819-32876
                                                                    (let
                                                                    (kind =a
                                                                    (field 1
                                                                    param))
                                                                    (before typing/typeclass.ml(925):32838-32875
                                                                    (==
                                                                    (after typing/typeclass.ml(925):32838-32864
                                                                    (apply
                                                                    (field 13
                                                                    (global Btype!))
                                                                    kind))
                                                                    0a)))))
                                                                    (after typing/typeclass.ml(926):32883-32908
                                                                    (apply
                                                                    get_methods
                                                                    public_self)))))
                                                                    (before typing/typeclass.ml(927):32914-33382
                                                                    (let
                                                                    (names =
                                                                    (after typing/typeclass.ml(927):32926-32953
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(927):32935-32953
                                                                    (let
                                                                    (x =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(927):32951-32952
                                                                    x)))))))
                                                                    (before typing/typeclass.ml(928):32959-33382
                                                                    (let
                                                                    (l1 =
                                                                    (after typing/typeclass.ml(928):32968-32984
                                                                    (apply
                                                                    names
                                                                    priv_meths))
                                                                    l2 =
                                                                    (after typing/typeclass.ml(928):32994-33010
                                                                    (apply
                                                                    names
                                                                    pub_meths')))
                                                                    (before typing/typeclass.ml(929):33016-33382
                                                                    (let
                                                                    (added =
                                                                    (after typing/typeclass.ml(929):33028-33067
                                                                    (apply
                                                                    (field 35
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    x
                                                                    (funct-body typing/typeclass.ml(929):33040-33064
                                                                    (before typing/typeclass.ml(929):33050-33063
                                                                    (after typing/typeclass.ml(929):33050-33063
                                                                    (apply
                                                                    (field 31
                                                                    (global Stdlib__list!))
                                                                    x l1)))))
                                                                    l2)))
                                                                    (before typing/typeclass.ml(930):33073-33382
                                                                    (seq
                                                                    (if
                                                                    (!= added
                                                                    0a)
                                                                    (before typing/typeclass.ml(931):33097-33164
                                                                    (after typing/typeclass.ml(931):33097-33164
                                                                    (apply
                                                                    (field 34
                                                                    (global Location!))
                                                                    loc
                                                                    (makeblock 6
                                                                    added))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(932):33168-33382
                                                                    (let
                                                                    (sign =
                                                                    (if final
                                                                    (before typing/typeclass.ml(932):33193-33197
                                                                    sign)
                                                                    (before typing/typeclass.ml(933):33209-33276
                                                                    (let
                                                                    (init =
                                                                    sign)
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(933):33238-33275
                                                                    (apply
                                                                    (field 60
                                                                    (global Ctype!))
                                                                    val_env
                                                                    public_self))
                                                                    (field 1
                                                                    init)
                                                                    (field 2
                                                                    init)
                                                                    (field 3
                                                                    init))))))
                                                                    (before typing/typeclass.ml(934):33282-33382
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    pat
                                                                    fields
                                                                    sign
                                                                    meths)
                                                                    sign)))))))))))))))))))))))))))))))))))))))))))))))))))))))))
                                  class_expr
                                    (function cl_num val_env met_env scl
                                      (funct-body typing/typeclass.ml(940)<ghost>:33443-33583
                                        (before typing/typeclass.ml(941):33474-33583
                                          (after typing/typeclass.ml(941):33474-33583
                                            (apply
                                              (field 10
                                                (global Builtin_attributes!))
                                              0a (field 2 scl)
                                              (function param
                                                (funct-body typing/typeclass.ml(942):33530-33583
                                                  (before typing/typeclass.ml(942):33541-33582
                                                    (after typing/typeclass.ml(942):33541-33582
                                                      (apply class_expr_aux
                                                        cl_num val_env
                                                        met_env scl))))))))))
                                  class_expr_aux
                                    (function cl_num val_env met_env scl
                                      (funct-body typing/typeclass.ml(944)<ghost>:33604-46224
                                        (before typing/typeclass.ml(945):33635-46224
                                          (let (*match* = (field 0 scl))
                                            (switch* *match*
                                             case tag 0:
                                              (let
                                                (styl =a (field 1 *match*)
                                                 lid =a (field 0 *match*))
                                                (before typing/typeclass.ml(947):33695-35166
                                                  (let
                                                    (*match* =
                                                       (after typing/typeclass.ml(947):33714-33761
                                                         (apply
                                                           (field 22
                                                             (global Typetexp!))
                                                           val_env
                                                           (field 1 scl)
                                                           (field 0 lid)))
                                                     decl =a
                                                       (field 1 *match*)
                                                     path =a
                                                       (field 0 *match*))
                                                    (before typing/typeclass.ml(948):33771-35166
                                                      (seq
                                                        (if
                                                          (after typing/typeclass.ml(948):33774-33811
                                                            (apply
                                                              (field 0
                                                                (global Path!))
                                                              (field 2 decl)
                                                              unbound_class))
                                                          (before typing/typeclass.ml(949):33825-33884
                                                            (raise
                                                              (after typing/typeclass.ml(949):33830-33884
                                                                (makeblock 0
                                                                  Error
                                                                  (field 1
                                                                    scl)
                                                                  val_env
                                                                  (makeblock 6
                                                                    (field 0
                                                                    lid))))))
                                                          0a)
                                                        (before typing/typeclass.ml(950):33892-35166
                                                          (let
                                                            (tyl =
                                                               (after typing/typeclass.ml(950):33902-33985
                                                                 (apply
                                                                   (field 16
                                                                    (global Stdlib__list!))
                                                                   (function
                                                                    sty
                                                                    (funct-body typing/typeclass.ml(951):33921-33970
                                                                    (before typing/typeclass.ml(951):33933-33969
                                                                    (after typing/typeclass.ml(951):33933-33969
                                                                    (apply
                                                                    (field 1
                                                                    (global Typetexp!))
                                                                    val_env
                                                                    0a sty)))))
                                                                   styl)))
                                                            (before typing/typeclass.ml(954):34001-35166
                                                              (let
                                                                (*match* =
                                                                   (after typing/typeclass.ml(955):34030-34080
                                                                    (apply
                                                                    (field 55
                                                                    (global Ctype!))
                                                                    (field 0
                                                                    decl)
                                                                    (field 1
                                                                    decl)))
                                                                 clty =a
                                                                   (field 1
                                                                    *match*)
                                                                 params =a
                                                                   (field 0
                                                                    *match*))
                                                                (before typing/typeclass.ml(957):34096-35166
                                                                  (let
                                                                    (clty' =
                                                                    (after typing/typeclass.ml(957):34108-34146
                                                                    (apply
                                                                    abbreviate_class_type
                                                                    path
                                                                    params
                                                                    clty)))
                                                                    (before typing/typeclass.ml(958):34156-35166
                                                                    (seq
                                                                    (if
                                                                    (!=
                                                                    (after typing/typeclass.ml(958):34159-34177
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    params))
                                                                    (after typing/typeclass.ml(958):34181-34196
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    tyl)))
                                                                    (before typing/typeclass.ml(959):34210-34388
                                                                    (raise
                                                                    (after typing/typeclass.ml(959):34215-34388
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    scl)
                                                                    val_env
                                                                    (makeblock 11 (*,int,int)
                                                                    (field 0
                                                                    lid)
                                                                    (after typing/typeclass.ml(960):34299-34317
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    params))
                                                                    (after typing/typeclass.ml(961):34370-34385
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    tyl)))))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(962):34396-35166
                                                                    (seq
                                                                    (after typing/typeclass.ml(962):34396-34632
                                                                    (apply
                                                                    (field 22
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    cty' ty
                                                                    (funct-body typing/typeclass.ml(963):34415-34613
                                                                    (before typing/typeclass.ml(964):34441-34612
                                                                    (let
                                                                    (ty' =
                                                                    (field 1
                                                                    cty'))
                                                                    (before typing/typeclass.ml(965):34480-34612
                                                                    (try
                                                                    (after typing/typeclass.ml(965):34484-34510
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    val_env
                                                                    ty' ty))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (let
                                                                    (trace =a
                                                                    (field 1
                                                                    exn))
                                                                    (before typing/typeclass.ml(966):34550-34612
                                                                    (raise
                                                                    (after typing/typeclass.ml(966):34555-34612
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 3
                                                                    cty')
                                                                    val_env
                                                                    (makeblock 12
                                                                    trace))))))
                                                                    (reraise
                                                                    exn)))))))))
                                                                    tyl
                                                                    params))
                                                                    (before typing/typeclass.ml(968):34640-35166
                                                                    (let
                                                                    (cl =
                                                                    (after typing/typeclass.ml(969):34657-34852
                                                                    (apply rc
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    path lid
                                                                    tyl)
                                                                    (field 1
                                                                    scl)
                                                                    clty'
                                                                    val_env
                                                                    (field 2
                                                                    scl)))))
                                                                    (before typing/typeclass.ml(976):34868-35166
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(976):34896-34920
                                                                    (apply
                                                                    extract_constraints
                                                                    clty))
                                                                    concrs =a
                                                                    (field 2
                                                                    *match*)
                                                                    meths =a
                                                                    (field 1
                                                                    *match*)
                                                                    vals =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(977):34930-35166
                                                                    (after typing/typeclass.ml(977):34930-35166
                                                                    (apply rc
                                                                    (makeblock 0
                                                                    (makeblock 5
                                                                    cl 0a
                                                                    vals
                                                                    meths
                                                                    concrs)
                                                                    (field 1
                                                                    scl)
                                                                    clty'
                                                                    val_env
                                                                    0a)))))))))))))))))))))))
                                             case tag 1:
                                              (let
                                                (cl_str =a (field 0 *match*))
                                                (before typing/typeclass.ml(984):35201-35487
                                                  (let
                                                    (*match* =
                                                       (after typing/typeclass.ml(985):35226-35289
                                                         (apply
                                                           class_structure
                                                           cl_num 0a val_env
                                                           met_env
                                                           (field 1 scl)
                                                           cl_str))
                                                     ty =a (field 1 *match*)
                                                     desc =a
                                                       (field 0 *match*))
                                                    (before typing/typeclass.ml(986):35299-35487
                                                      (after typing/typeclass.ml(986):35299-35487
                                                        (apply rc
                                                          (makeblock 0
                                                            (makeblock 1
                                                              desc)
                                                            (field 1 scl)
                                                            (makeblock 1 ty)
                                                            val_env
                                                            (field 2 scl))))))))
                                             case tag 2:
                                              (let
                                                (*match* =a (field 1 *match*)
                                                 l =a (field 0 *match*))
                                                (if *match*
                                                  (let
                                                    (sbody =a
                                                       (field 3 *match*)
                                                     spat =a
                                                       (field 2 *match*)
                                                     default =a
                                                       (field 0 *match*))
                                                    (before typing/typeclass.ml(993):35540-36529
                                                      (let
                                                        (loc =
                                                           (field 1 default))
                                                        (before typing/typeclass.ml(994):35576-36529
                                                          (let
                                                            (scases =
                                                               (makeblock 0
                                                                 (after typing/typeclass.ml(996):35628-35854
                                                                   (apply
                                                                    (field 39
                                                                    (field 6
                                                                    (global Ast_helper!)))
                                                                    (after typing/typeclass.ml(997):35647-35790
                                                                    (apply
                                                                    (field 8
                                                                    (field 5
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    loc) 0a
                                                                    (after typing/typeclass.ml(998):35680-35736
                                                                    (apply
                                                                    (field 6
                                                                    (global Typedtree!))
                                                                    [1:
                                                                    [0:
                                                                    "*predef*"]
                                                                    "Some"]))
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(999):35756-35788
                                                                    (apply
                                                                    (field 3
                                                                    (field 5
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    loc) 0a
                                                                    (after typing/typeclass.ml(999):35770-35787
                                                                    (apply
                                                                    (field 6
                                                                    (global Typedtree!))
                                                                    "*sth*")))))))
                                                                    0a
                                                                    (after typing/typeclass.ml(1000):35801-35854
                                                                    (apply
                                                                    (field 2
                                                                    (field 6
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    loc) 0a
                                                                    (after typing/typeclass.ml(1000):35817-35853
                                                                    (apply
                                                                    (field 6
                                                                    (global Typedtree!))
                                                                    [0:
                                                                    "*sth*"]))))))
                                                                 (makeblock 0
                                                                   (after typing/typeclass.ml(1002):35865-36010
                                                                    (apply
                                                                    (field 39
                                                                    (field 6
                                                                    (global Ast_helper!)))
                                                                    (after typing/typeclass.ml(1003):35884-35992
                                                                    (apply
                                                                    (field 8
                                                                    (field 5
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    loc) 0a
                                                                    (after typing/typeclass.ml(1004):35917-35973
                                                                    (apply
                                                                    (field 6
                                                                    (global Typedtree!))
                                                                    [1:
                                                                    [0:
                                                                    "*predef*"]
                                                                    "None"]))
                                                                    0a)) 0a
                                                                    default))
                                                                   0a)))
                                                            (before typing/typeclass.ml(1009):36036-36529
                                                              (let
                                                                (smatch =
                                                                   (after typing/typeclass.ml(1010):36057-36143
                                                                    (apply
                                                                    (field 8
                                                                    (field 6
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    loc) 0a
                                                                    (after typing/typeclass.ml(1010):36073-36126
                                                                    (apply
                                                                    (field 2
                                                                    (field 6
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    loc) 0a
                                                                    (after typing/typeclass.ml(1010):36089-36125
                                                                    (apply
                                                                    (field 6
                                                                    (global Typedtree!))
                                                                    [0:
                                                                    "*opt*"]))))
                                                                    scases)))
                                                                (before typing/typeclass.ml(1013):36159-36529
                                                                  (let
                                                                    (sfun =
                                                                    (after typing/typeclass.ml(1014):36178-36338
                                                                    (apply
                                                                    (field 4
                                                                    (field 23
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    (field 1
                                                                    scl)) 0a
                                                                    l 0a
                                                                    (after typing/typeclass.ml(1016):36230-36262
                                                                    (apply
                                                                    (field 3
                                                                    (field 5
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    loc) 0a
                                                                    (after typing/typeclass.ml(1016):36244-36261
                                                                    (apply
                                                                    (field 6
                                                                    (global Typedtree!))
                                                                    "*opt*"))))
                                                                    (after typing/typeclass.ml(1017):36273-36338
                                                                    (apply
                                                                    (field 6
                                                                    (field 23
                                                                    (global Ast_helper!)))
                                                                    (makeblock 0
                                                                    (field 1
                                                                    scl)) 0a
                                                                    0a
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1017):36313-36330
                                                                    (apply
                                                                    (field 0
                                                                    (field 20
                                                                    (global Ast_helper!)))
                                                                    0a 0a 0a
                                                                    0a spat
                                                                    smatch))
                                                                    0a)
                                                                    sbody)))))
                                                                    (before typing/typeclass.ml(1021):36491-36529
                                                                    (after typing/typeclass.ml(1021):36491-36529
                                                                    (apply
                                                                    class_expr
                                                                    cl_num
                                                                    val_env
                                                                    met_env
                                                                    sfun))))))))))))
                                                  (let
                                                    (l =a l
                                                     scl' =a
                                                       (field 3 *match*)
                                                     spat =a
                                                       (field 2 *match*))
                                                    (before typing/typeclass.ml(1023):36573-38301
                                                      (seq
                                                        (if
                                                          (field 0
                                                            (field 47
                                                              (global Clflags!)))
                                                          (before typing/typeclass.ml(1023):36600-36618
                                                            (after typing/typeclass.ml(1023):36600-36618
                                                              (apply
                                                                (field 7
                                                                  (global Ctype!))
                                                                0a)))
                                                          0a)
                                                        (before typing/typeclass.ml(1024):36626-38301
                                                          (let
                                                            (*match* =
                                                               (after typing/typeclass.ml(1025):36669-36730
                                                                 (apply
                                                                   (field 5
                                                                    (global Typecore!))
                                                                   cl_num
                                                                   val_env
                                                                   met_env l
                                                                   spat))
                                                             met_env =a
                                                               (field 3
                                                                 *match*)
                                                             val_env' =a
                                                               (field 2
                                                                 *match*)
                                                             pv =a
                                                               (field 1
                                                                 *match*)
                                                             pat =a
                                                               (field 0
                                                                 *match*))
                                                            (before typing/typeclass.ml(1027):36746-38301
                                                              (seq
                                                                (if
                                                                  (field 0
                                                                    (field 47
                                                                    (global Clflags!)))
                                                                  (before typing/typeclass.ml(1027):36773-36892
                                                                    (seq
                                                                    (after typing/typeclass.ml(1028):36787-36803
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1029):36813-36882
                                                                    (after typing/typeclass.ml(1029):36813-36882
                                                                    (apply
                                                                    (field 15
                                                                    (global Typecore!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1029):36826-36878
                                                                    (let
                                                                    (ty =a
                                                                    (field 3
                                                                    param))
                                                                    (before typing/typeclass.ml(1029):36848-36877
                                                                    (after typing/typeclass.ml(1029):36848-36877
                                                                    (apply
                                                                    (field 41
                                                                    (global Ctype!))
                                                                    ty))))))
                                                                    pat)))))
                                                                  0a)
                                                                (before typing/typeclass.ml(1031):36900-38301
                                                                  (let
                                                                    (pv =
                                                                    (after typing/typeclass.ml(1032):36917-37446
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1033):36936-37433
                                                                    (let
                                                                    (id' =a
                                                                    (field 1
                                                                    param)
                                                                    id =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1034):36976-37419
                                                                    (let
                                                                    (path =
                                                                    (makeblock 0
                                                                    id'))
                                                                    (before typing/typeclass.ml(1036):37067-37419
                                                                    (let
                                                                    (vd =
                                                                    (after typing/typeclass.ml(1036):37076-37104
                                                                    (apply
                                                                    (field 11
                                                                    (global Env!))
                                                                    path
                                                                    val_env')))
                                                                    (before typing/typeclass.ml(1037):37120-37419
                                                                    (makeblock 0
                                                                    id
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    path
                                                                    (after typing/typeclass.ml(1039):37181-37223
                                                                    (apply
                                                                    (field 6
                                                                    (global Typedtree!))
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1039):37207-37222
                                                                    (apply
                                                                    (field 14
                                                                    (global Ident!))
                                                                    id)))))
                                                                    vd)
                                                                    (field 0
                                                                    (global Location!))
                                                                    0a
                                                                    (after typing/typeclass.ml(1041):37310-37336
                                                                    (apply
                                                                    (field 46
                                                                    (global Ctype!))
                                                                    0a
                                                                    (field 0
                                                                    vd)))
                                                                    val_env'
                                                                    0a))))))))))
                                                                    pv)))
                                                                    (before typing/typeclass.ml(1047):37462-38301
                                                                    (let
                                                                    (not_function =
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1047):37481-37540
                                                                    (catch
                                                                    (switch* param
                                                                    case tag 0:
                                                                    (exit
                                                                    135)
                                                                    case tag 1:
                                                                    (exit
                                                                    135)
                                                                    case tag 2:
                                                                    (before typing/typeclass.ml(1048):37515-37520
                                                                    0a))
                                                                    with (135)
                                                                    (before typing/typeclass.ml(1049):37536-37540
                                                                    1a)))))
                                                                    (before typing/typeclass.ml(1051):37556-38301
                                                                    (let
                                                                    (partial =
                                                                    (let
                                                                    (dummy =
                                                                    (after typing/typeclass.ml(1052):37590-37638
                                                                    (apply
                                                                    (field 9
                                                                    (global Typecore!))
                                                                    val_env
                                                                    (after typing/typeclass.ml(1052):37607-37638
                                                                    (apply
                                                                    (field 38
                                                                    (field 6
                                                                    (global Ast_helper!)))
                                                                    0a 0a 0a)))))
                                                                    (before typing/typeclass.ml(1053):37650-37762
                                                                    (after typing/typeclass.ml(1053):37650-37762
                                                                    (apply
                                                                    (field 7
                                                                    (global Typecore!))
                                                                    0a
                                                                    val_env
                                                                    (field 3
                                                                    pat)
                                                                    (field 1
                                                                    pat)
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    pat 0a
                                                                    dummy)
                                                                    0a))))))
                                                                    (before typing/typeclass.ml(1056):37778-38301
                                                                    (seq
                                                                    (after typing/typeclass.ml(1056):37778-37805
                                                                    (apply
                                                                    (field 10
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1057):37813-38301
                                                                    (let
                                                                    (cl =
                                                                    (after typing/typeclass.ml(1057):37822-37861
                                                                    (apply
                                                                    class_expr
                                                                    cl_num
                                                                    val_env'
                                                                    met_env
                                                                    scl')))
                                                                    (before typing/typeclass.ml(1058):37871-38301
                                                                    (seq
                                                                    (after typing/typeclass.ml(1058):37871-37887
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1059):37895-38301
                                                                    (seq
                                                                    (if
                                                                    (&&
                                                                    (after typing/typeclass.ml(1059):37898-37917
                                                                    (apply
                                                                    (field 52
                                                                    (global Btype!))
                                                                    l))
                                                                    (after typing/typeclass.ml(1059):37921-37944
                                                                    (apply
                                                                    not_function
                                                                    (field 2
                                                                    cl))))
                                                                    (before typing/typeclass.ml(1060):37958-38040
                                                                    (after typing/typeclass.ml(1060):37958-38040
                                                                    (apply
                                                                    (field 34
                                                                    (global Location!))
                                                                    (field 1
                                                                    pat) 7a)))
                                                                    0a)
                                                                    (before typing/typeclass.ml(1062):38048-38301
                                                                    (after typing/typeclass.ml(1062):38048-38301
                                                                    (apply rc
                                                                    (makeblock 0
                                                                    (makeblock 2
                                                                    l pat pv
                                                                    cl
                                                                    partial)
                                                                    (field 1
                                                                    scl)
                                                                    (makeblock 2
                                                                    l
                                                                    (after typing/typeclass.ml(1065):38175-38202
                                                                    (apply
                                                                    (field 46
                                                                    (global Ctype!))
                                                                    0a
                                                                    (field 3
                                                                    pat)))
                                                                    (field 2
                                                                    cl))
                                                                    val_env
                                                                    (field 2
                                                                    scl))))))))))))))))))))))))))))
                                             case tag 3:
                                              (let
                                                (sargs =a (field 1 *match*)
                                                 scl' =a (field 0 *match*))
                                                (before typing/typeclass.ml(1070):38339-42873
                                                  (seq
                                                    (if (!= sargs 0a) 0a
                                                      (raise
                                                        (after typing/typeclass.ml(1070):38339-38359
                                                          (makeblock 0
                                                            (global Assert_failure!)
                                                            [0:
                                                             "typing/typeclass.ml"
                                                             1070 6]))))
                                                    (before typing/typeclass.ml(1071):38367-42873
                                                      (seq
                                                        (if
                                                          (field 0
                                                            (field 47
                                                              (global Clflags!)))
                                                          (before typing/typeclass.ml(1071):38394-38412
                                                            (after typing/typeclass.ml(1071):38394-38412
                                                              (apply
                                                                (field 7
                                                                  (global Ctype!))
                                                                0a)))
                                                          0a)
                                                        (before typing/typeclass.ml(1072):38420-42873
                                                          (let
                                                            (cl =
                                                               (after typing/typeclass.ml(1072):38429-38467
                                                                 (apply
                                                                   class_expr
                                                                   cl_num
                                                                   val_env
                                                                   met_env
                                                                   scl')))
                                                            (before typing/typeclass.ml(1073):38477-42873
                                                              (seq
                                                                (if
                                                                  (field 0
                                                                    (field 47
                                                                    (global Clflags!)))
                                                                  (before typing/typeclass.ml(1073):38504-38593
                                                                    (seq
                                                                    (after typing/typeclass.ml(1074):38518-38534
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1075):38544-38582
                                                                    (after typing/typeclass.ml(1075):38544-38582
                                                                    (apply
                                                                    generalize_class_type
                                                                    0a
                                                                    (field 2
                                                                    cl))))))
                                                                  0a)
                                                                (before typing/typeclass.ml(1077):38601-42873
                                                                  (letrec
                                                                    (
                                                                    nonopt_labels
                                                                    (function
                                                                    ls ty_fun
                                                                    (funct-body typing/typeclass.ml(1077)<ghost>:38623-38829
                                                                    (before typing/typeclass.ml(1078):38643-38829
                                                                    (catch
                                                                    (switch* ty_fun
                                                                    case tag 0:
                                                                    (exit
                                                                    176)
                                                                    case tag 1:
                                                                    (exit
                                                                    176)
                                                                    case tag 2:
                                                                    (let
                                                                    (ty_res =a
                                                                    (field 2
                                                                    ty_fun)
                                                                    l =a
                                                                    (field 0
                                                                    ty_fun))
                                                                    (before typing/typeclass.ml(1080):38711-38808
                                                                    (if
                                                                    (after typing/typeclass.ml(1080):38714-38733
                                                                    (apply
                                                                    (field 52
                                                                    (global Btype!))
                                                                    l))
                                                                    (before typing/typeclass.ml(1080):38739-38762
                                                                    (after typing/typeclass.ml(1080):38739-38762
                                                                    (apply
                                                                    nonopt_labels
                                                                    ls
                                                                    ty_res)))
                                                                    (before typing/typeclass.ml(1081):38780-38808
                                                                    (after typing/typeclass.ml(1081):38780-38808
                                                                    (apply
                                                                    nonopt_labels
                                                                    (makeblock 0
                                                                    l ls)
                                                                    ty_res)))))))
                                                                    with (176)
                                                                    (before typing/typeclass.ml(1082):38827-38829
                                                                    ls))))))
                                                                    (before typing/typeclass.ml(1084):38845-42873
                                                                    (let
                                                                    (ignore_labels =
                                                                    (||
                                                                    (field 0
                                                                    (field 27
                                                                    (global Clflags!)))
                                                                    (let
                                                                    (labels =
                                                                    (after typing/typeclass.ml(1086):38914-38941
                                                                    (apply
                                                                    nonopt_labels
                                                                    0a
                                                                    (field 2
                                                                    cl))))
                                                                    (before typing/typeclass.ml(1087):38953-39352
                                                                    (&&
                                                                    (==
                                                                    (after typing/typeclass.ml(1087):38953-38971
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    labels))
                                                                    (after typing/typeclass.ml(1087):38974-38991
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    sargs)))
                                                                    (&&
                                                                    (after typing/typeclass.ml(1088):39003-39048
                                                                    (apply
                                                                    (field 27
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1088):39016-39042
                                                                    (let
                                                                    (l =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1088):39030-39041
                                                                    (== l 0a)))))
                                                                    sargs))
                                                                    (&&
                                                                    (after typing/typeclass.ml(1089):39060-39102
                                                                    (apply
                                                                    (field 28
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    l
                                                                    (funct-body typing/typeclass.ml(1089):39072-39095
                                                                    (before typing/typeclass.ml(1089):39082-39094
                                                                    (!= l 0a))))
                                                                    labels))
                                                                    (seq
                                                                    (after typing/typeclass.ml(1091):39130-39324
                                                                    (apply
                                                                    (field 34
                                                                    (global Location!))
                                                                    (field 1
                                                                    cl)
                                                                    (makeblock 1
                                                                    (after typing/typeclass.ml(1094):39227-39323
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (field 8
                                                                    (global Printtyp!))
                                                                    (after typing/typeclass.ml(1095):39287-39322
                                                                    (apply
                                                                    (field 35
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1095):39300-39314
                                                                    (apply
                                                                    (function
                                                                    prim prim
                                                                    stub
                                                                    (caml_notequal
                                                                    prim
                                                                    prim))
                                                                    0a))
                                                                    labels)))))))
                                                                    (before typing/typeclass.ml(1096):39336-39340
                                                                    1a)))))))))
                                                                    (before typing/typeclass.ml(1099):39368-42873
                                                                    (letrec
                                                                    (type_args
                                                                    (function
                                                                    args
                                                                    omitted
                                                                    ty_fun
                                                                    ty_fun0
                                                                    sargs
                                                                    more_sargs
                                                                    (funct-body typing/typeclass.ml(1099)<ghost>:39386-42431
                                                                    (before typing/typeclass.ml(1100):39441-42431
                                                                    (let
                                                                    (*match* =
                                                                    ty_fun
                                                                    *match* =
                                                                    ty_fun0)
                                                                    (catch
                                                                    (switch* *match*
                                                                    case tag 0:
                                                                    (exit
                                                                    175)
                                                                    case tag 1:
                                                                    (exit
                                                                    175)
                                                                    case tag 2:
                                                                    (let
                                                                    (ty_fun =a
                                                                    (field 2
                                                                    *match*)
                                                                    ty =a
                                                                    (field 1
                                                                    *match*)
                                                                    l =a
                                                                    (field 0
                                                                    *match*))
                                                                    (switch* *match*
                                                                    case tag 0:
                                                                    (exit
                                                                    175)
                                                                    case tag 1:
                                                                    (exit
                                                                    175)
                                                                    case tag 2:
                                                                    (let
                                                                    (ty_fun0 =a
                                                                    (field 2
                                                                    *match*)
                                                                    ty0 =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1102):39548-39579
                                                                    (if
                                                                    (||
                                                                    (!= sargs
                                                                    0a)
                                                                    (!=
                                                                    more_sargs
                                                                    0a))
                                                                    (before typing/typeclass.ml(1103):39595-41946
                                                                    (let
                                                                    (name =
                                                                    (after typing/typeclass.ml(1103):39606-39624
                                                                    (apply
                                                                    (field 53
                                                                    (global Btype!))
                                                                    l))
                                                                    optional =
                                                                    (after typing/typeclass.ml(1104):39652-39671
                                                                    (apply
                                                                    (field 52
                                                                    (global Btype!))
                                                                    l)))
                                                                    (before typing/typeclass.ml(1105):39687-41946
                                                                    (catch
                                                                    (if
                                                                    (&&
                                                                    ignore_labels
                                                                    (not
                                                                    (after typing/typeclass.ml(1106):39754-39775
                                                                    (apply
                                                                    (field 52
                                                                    (global Btype!))
                                                                    l))))
                                                                    (before typing/typeclass.ml(1106):39781-40352
                                                                    (let
                                                                    (*match* =
                                                                    sargs
                                                                    *match* =
                                                                    more_sargs)
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*)
                                                                    sarg0 =a
                                                                    (field 1
                                                                    *match*)
                                                                    l' =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1109):39891-39950
                                                                    (raise
                                                                    (after typing/typeclass.ml(1109):39896-39950
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    sarg0)
                                                                    val_env
                                                                    (makeblock 4
                                                                    l'))))))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (more_sargs =a
                                                                    (field 1
                                                                    *match*)
                                                                    *match* =a
                                                                    (field 0
                                                                    *match*)
                                                                    sarg0 =a
                                                                    (field 1
                                                                    *match*)
                                                                    l' =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1111):40019-40278
                                                                    (if
                                                                    (&&
                                                                    (after typing/typeclass.ml(1111):40022-40029
                                                                    (caml_notequal
                                                                    l l'))
                                                                    (!= l'
                                                                    0a))
                                                                    (before typing/typeclass.ml(1112):40074-40167
                                                                    (raise
                                                                    (after typing/typeclass.ml(1112):40079-40167
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    sarg0)
                                                                    val_env
                                                                    (makeblock 4
                                                                    l')))))
                                                                    (before typing/typeclass.ml(1114):40193-40278
                                                                    (let
                                                                    (arg =
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1115):40241-40277
                                                                    (apply
                                                                    (field 11
                                                                    (global Typecore!))
                                                                    val_env
                                                                    sarg0 ty
                                                                    ty0)))
                                                                    more_sargs =a
                                                                    more_sargs
                                                                    sargs =
                                                                    0a)
                                                                    (exit 165
                                                                    arg
                                                                    more_sargs
                                                                    sargs))))))
                                                                    (before typing/typeclass.ml(1117):40322-40334
                                                                    (raise
                                                                    (after typing/typeclass.ml(1117):40322-40334
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/typeclass.ml"
                                                                    1117 20]))))))))
                                                                    (before typing/typeclass.ml(1118):40358-41759
                                                                    (try
                                                                    (catch
                                                                    (try
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1122):40513-40543
                                                                    (apply
                                                                    (field 55
                                                                    (global Btype!))
                                                                    name
                                                                    sargs))
                                                                    sargs2 =a
                                                                    (field 3
                                                                    *match*)
                                                                    sargs1 =a
                                                                    (field 2
                                                                    *match*)
                                                                    sarg0 =a
                                                                    (field 1
                                                                    *match*)
                                                                    l' =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1123):40567-40607
                                                                    (let
                                                                    (more_sargs =a
                                                                    more_sargs
                                                                    sargs =
                                                                    (after typing/typeclass.ml(1123):40579-40594
                                                                    (apply
                                                                    (field 36
                                                                    (global Stdlib!))
                                                                    sargs1
                                                                    sargs2))
                                                                    sarg0 =a
                                                                    sarg0
                                                                    l' =a l')
                                                                    (exit 154
                                                                    more_sargs
                                                                    sargs
                                                                    sarg0 l'))))
                                                                    with exn
                                                                    (if
                                                                    (== exn
                                                                    (field 7
                                                                    (global Stdlib!)))
                                                                    (before typing/typeclass.ml(1125):40664-40814
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1126):40720-40755
                                                                    (apply
                                                                    (field 55
                                                                    (global Btype!))
                                                                    name
                                                                    more_sargs))
                                                                    sargs2 =a
                                                                    (field 3
                                                                    *match*)
                                                                    sargs1 =a
                                                                    (field 2
                                                                    *match*)
                                                                    sarg0 =a
                                                                    (field 1
                                                                    *match*)
                                                                    l' =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1127):40779-40814
                                                                    (let
                                                                    (more_sargs =a
                                                                    sargs2
                                                                    sargs =
                                                                    (after typing/typeclass.ml(1127):40791-40805
                                                                    (apply
                                                                    (field 36
                                                                    (global Stdlib!))
                                                                    sargs
                                                                    sargs1))
                                                                    sarg0 =a
                                                                    sarg0
                                                                    l' =a l')
                                                                    (exit 154
                                                                    more_sargs
                                                                    sargs
                                                                    sarg0 l')))))
                                                                    (reraise
                                                                    exn)))
                                                                    with (154 more_sargs sargs sarg0 l')
                                                                    (before typing/typeclass.ml(1129):40850-41438
                                                                    (seq
                                                                    (if
                                                                    (&&
                                                                    (not
                                                                    optional)
                                                                    (after typing/typeclass.ml(1129):40869-40889
                                                                    (apply
                                                                    (field 52
                                                                    (global Btype!))
                                                                    l')))
                                                                    (before typing/typeclass.ml(1130):40913-41028
                                                                    (after typing/typeclass.ml(1130):40913-41028
                                                                    (apply
                                                                    (field 34
                                                                    (global Location!))
                                                                    (field 1
                                                                    sarg0)
                                                                    (makeblock 26
                                                                    (after typing/typeclass.ml(1131):40999-41027
                                                                    (apply
                                                                    (field 8
                                                                    (global Printtyp!))
                                                                    l))))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(1132):41046-41438
                                                                    (let
                                                                    (arg =
                                                                    (if
                                                                    (||
                                                                    (not
                                                                    optional)
                                                                    (after typing/typeclass.ml(1133):41100-41120
                                                                    (apply
                                                                    (field 52
                                                                    (global Btype!))
                                                                    l')))
                                                                    (before typing/typeclass.ml(1134):41144-41185
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1134):41149-41185
                                                                    (apply
                                                                    (field 11
                                                                    (global Typecore!))
                                                                    val_env
                                                                    sarg0 ty
                                                                    ty0))))
                                                                    (before typing/typeclass.ml(1136):41225-41438
                                                                    (let
                                                                    (ty' =
                                                                    (after typing/typeclass.ml(1136):41235-41265
                                                                    (apply
                                                                    (field 14
                                                                    (global Typecore!))
                                                                    val_env
                                                                    ty))
                                                                    ty0' =
                                                                    (after typing/typeclass.ml(1137):41295-41326
                                                                    (apply
                                                                    (field 14
                                                                    (global Typecore!))
                                                                    val_env
                                                                    ty0)))
                                                                    (before typing/typeclass.ml(1138):41348-41438
                                                                    (let
                                                                    (arg =
                                                                    (after typing/typeclass.ml(1138):41358-41394
                                                                    (apply
                                                                    (field 11
                                                                    (global Typecore!))
                                                                    val_env
                                                                    sarg0 ty'
                                                                    ty0')))
                                                                    (before typing/typeclass.ml(1139):41416-41438
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1139):41421-41438
                                                                    (apply
                                                                    (field 12
                                                                    (global Typecore!))
                                                                    arg)))))))))
                                                                    more_sargs =a
                                                                    more_sargs
                                                                    sargs =a
                                                                    sargs)
                                                                    (exit 165
                                                                    arg
                                                                    more_sargs
                                                                    sargs))))))
                                                                    with exn
                                                                    (if
                                                                    (== exn
                                                                    (field 7
                                                                    (global Stdlib!)))
                                                                    (before typing/typeclass.ml(1141):41487-41759
                                                                    (let
                                                                    (arg =
                                                                    (if
                                                                    (&&
                                                                    (after typing/typeclass.ml(1142):41525-41544
                                                                    (apply
                                                                    (field 52
                                                                    (global Btype!))
                                                                    l))
                                                                    (||
                                                                    (after typing/typeclass.ml(1143):41568-41596
                                                                    (apply
                                                                    (field 42
                                                                    (global Stdlib__list!))
                                                                    0a sargs))
                                                                    (after typing/typeclass.ml(1144):41623-41656
                                                                    (apply
                                                                    (field 42
                                                                    (global Stdlib__list!))
                                                                    0a
                                                                    more_sargs))))
                                                                    (before typing/typeclass.ml(1146):41697-41733
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1146):41702-41733
                                                                    (apply
                                                                    (field 13
                                                                    (global Typecore!))
                                                                    ty0
                                                                    (field 0
                                                                    (global Location!))))))
                                                                    (before typing/typeclass.ml(1147):41755-41759
                                                                    0a))
                                                                    more_sargs =a
                                                                    more_sargs
                                                                    sargs =a
                                                                    sargs)
                                                                    (exit 165
                                                                    arg
                                                                    more_sargs
                                                                    sargs)))
                                                                    (reraise
                                                                    exn)))))
                                                                    with (165 arg more_sargs sargs)
                                                                    (before typing/typeclass.ml(1149):41787-41946
                                                                    (let
                                                                    (omitted =
                                                                    (if
                                                                    (== arg
                                                                    0a)
                                                                    (before typing/typeclass.ml(1149):41820-41838
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    l ty0)
                                                                    omitted))
                                                                    (before typing/typeclass.ml(1149):41844-41851
                                                                    omitted)))
                                                                    (before typing/typeclass.ml(1150):41867-41946
                                                                    (after typing/typeclass.ml(1150):41867-41946
                                                                    (apply
                                                                    type_args
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    l arg)
                                                                    args)
                                                                    omitted
                                                                    ty_fun
                                                                    ty_fun0
                                                                    sargs
                                                                    more_sargs)))))))))
                                                                    (exit
                                                                    175)))))))
                                                                    with (175)
                                                                    (before typing/typeclass.ml(1153):41974-42431
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1153):41980-41998
                                                                    (apply
                                                                    (field 36
                                                                    (global Stdlib!))
                                                                    sargs
                                                                    more_sargs)))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*)
                                                                    sarg0 =a
                                                                    (field 1
                                                                    *match*)
                                                                    l =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1155):42051-42246
                                                                    (if
                                                                    (!=
                                                                    omitted
                                                                    0a)
                                                                    (before typing/typeclass.ml(1156):42091-42149
                                                                    (raise
                                                                    (after typing/typeclass.ml(1156):42096-42149
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    sarg0)
                                                                    val_env
                                                                    (makeblock 4
                                                                    l)))))
                                                                    (before typing/typeclass.ml(1158):42189-42246
                                                                    (raise
                                                                    (after typing/typeclass.ml(1158):42194-42246
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    cl)
                                                                    val_env
                                                                    (makeblock 3
                                                                    (field 2
                                                                    cl)))))))))
                                                                    (before typing/typeclass.ml(1160):42283-42431
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1160):42284-42297
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__list!))
                                                                    args))
                                                                    (after typing/typeclass.ml(1161):42316-42430
                                                                    (apply
                                                                    (field 20
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    ty_fun
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1162):42350-42395
                                                                    (let
                                                                    (ty =a
                                                                    (field 1
                                                                    param)
                                                                    l =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1162):42372-42394
                                                                    (makeblock 2
                                                                    l ty
                                                                    ty_fun)))))
                                                                    ty_fun0
                                                                    omitted)))))))))))))
                                                                    (before typing/typeclass.ml(1165):42447-42873
                                                                    (let
                                                                    (*match* =
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1166):42492-42526
                                                                    (apply
                                                                    (field 55
                                                                    (global Ctype!))
                                                                    0a
                                                                    (field 2
                                                                    cl)))
                                                                    ty_fun0 =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1167):42538-42680
                                                                    (if
                                                                    ignore_labels
                                                                    (before typing/typeclass.ml(1168):42570-42613
                                                                    (after typing/typeclass.ml(1168):42570-42613
                                                                    (apply
                                                                    type_args
                                                                    0a 0a
                                                                    (field 2
                                                                    cl)
                                                                    ty_fun0
                                                                    0a sargs)))
                                                                    (before typing/typeclass.ml(1170):42637-42680
                                                                    (after typing/typeclass.ml(1170):42637-42680
                                                                    (apply
                                                                    type_args
                                                                    0a 0a
                                                                    (field 2
                                                                    cl)
                                                                    ty_fun0
                                                                    sargs 0a))))))
                                                                    cty =a
                                                                    (field 1
                                                                    *match*)
                                                                    args =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1172):42696-42873
                                                                    (after typing/typeclass.ml(1172):42696-42873
                                                                    (apply rc
                                                                    (makeblock 0
                                                                    (makeblock 3
                                                                    cl args)
                                                                    (field 1
                                                                    scl) cty
                                                                    val_env
                                                                    (field 2
                                                                    scl))))))))))))))))))))))
                                             case tag 4:
                                              (let
                                                (scl' =a (field 2 *match*)
                                                 sdefs =a (field 1 *match*)
                                                 rec_flag =a
                                                   (field 0 *match*))
                                                (before typing/typeclass.ml(1179):42919-44596
                                                  (let
                                                    (*match* =
                                                       (after typing/typeclass.ml(1180):42949-43007
                                                         (apply
                                                           (field 3
                                                             (global Typecore!))
                                                           5a val_env
                                                           rec_flag sdefs 0a))
                                                     val_env =a
                                                       (field 1 *match*)
                                                     defs =a
                                                       (field 0 *match*))
                                                    (before typing/typeclass.ml(1181):43017-44596
                                                      (let
                                                        (*match* =
                                                           (after typing/typeclass.ml(1182):43047-44226
                                                             (apply
                                                               (field 21
                                                                 (global Stdlib__list!))
                                                               (function
                                                                 param param
                                                                 (funct-body typing/typeclass.ml(1183):43073-44159
                                                                   (let
                                                                    (met_env =a
                                                                    (field 1
                                                                    param)
                                                                    vals =a
                                                                    (field 0
                                                                    param)
                                                                    id =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1184):43130-44158
                                                                    (let
                                                                    (path =
                                                                    (makeblock 0
                                                                    id))
                                                                    (before typing/typeclass.ml(1186):43216-44158
                                                                    (let
                                                                    (vd =
                                                                    (after typing/typeclass.ml(1186):43225-43252
                                                                    (apply
                                                                    (field 11
                                                                    (global Env!))
                                                                    path
                                                                    val_env)))
                                                                    (before typing/typeclass.ml(1187):43269-44158
                                                                    (seq
                                                                    (after typing/typeclass.ml(1187):43269-43287
                                                                    (apply
                                                                    (field 7
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1188):43302-44158
                                                                    (let
                                                                    (expr =
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    path
                                                                    (after typing/typeclass.ml(1190):43373-43414
                                                                    (apply
                                                                    (field 6
                                                                    (global Typedtree!))
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1190):43398-43413
                                                                    (apply
                                                                    (field 14
                                                                    (global Ident!))
                                                                    id)))))
                                                                    vd)
                                                                    (field 0
                                                                    (global Location!))
                                                                    0a
                                                                    (after typing/typeclass.ml(1192):43504-43530
                                                                    (apply
                                                                    (field 46
                                                                    (global Ctype!))
                                                                    0a
                                                                    (field 0
                                                                    vd)))
                                                                    val_env
                                                                    0a))
                                                                    (before typing/typeclass.ml(1197):43650-44158
                                                                    (seq
                                                                    (after typing/typeclass.ml(1197):43650-43666
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1198):43681-44158
                                                                    (seq
                                                                    (after typing/typeclass.ml(1198):43681-43711
                                                                    (apply
                                                                    (field 39
                                                                    (global Ctype!))
                                                                    (field 3
                                                                    expr)))
                                                                    (before typing/typeclass.ml(1199):43726-44158
                                                                    (let
                                                                    (desc =
                                                                    (makeblock 0
                                                                    (field 3
                                                                    expr)
                                                                    (makeblock 1
                                                                    0a
                                                                    cl_num)
                                                                    (field 2
                                                                    vd) 0a))
                                                                    (before typing/typeclass.ml(1206):44016-44158
                                                                    (let
                                                                    (id' =
                                                                    (after typing/typeclass.ml(1206):44026-44060
                                                                    (apply
                                                                    (field 10
                                                                    (global Ident!))
                                                                    (after typing/typeclass.ml(1206):44045-44060
                                                                    (apply
                                                                    (field 14
                                                                    (global Ident!))
                                                                    id)))))
                                                                    (before typing/typeclass.ml(1207):44077-44158
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    id' expr)
                                                                    vals)
                                                                    (after typing/typeclass.ml(1209):44127-44157
                                                                    (apply
                                                                    (field 47
                                                                    (global Env!))
                                                                    0a id'
                                                                    desc
                                                                    met_env)))))))))))))))))))))))
                                                               (after typing/typeclass.ml(1210):44170-44202
                                                                 (apply
                                                                   (field 4
                                                                    (global Typedtree!))
                                                                   defs))
                                                               (makeblock 0
                                                                 0a met_env)))
                                                         met_env =a
                                                           (field 1 *match*)
                                                         vals =a
                                                           (field 0 *match*))
                                                        (before typing/typeclass.ml(1213):44242-44596
                                                          (let
                                                            (cl =
                                                               (after typing/typeclass.ml(1213):44251-44289
                                                                 (apply
                                                                   class_expr
                                                                   cl_num
                                                                   val_env
                                                                   met_env
                                                                   scl')))
                                                            (before typing/typeclass.ml(1214):44299-44596
                                                              (let
                                                                (*match* =
                                                                   (if
                                                                    (==
                                                                    rec_flag
                                                                    1a)
                                                                    (before typing/typeclass.ml(1215):44345-44382
                                                                    (after typing/typeclass.ml(1215):44345-44382
                                                                    (apply
                                                                    (field 32
                                                                    (global Typecore!))
                                                                    val_env
                                                                    defs)))
                                                                    0a))
                                                                (before typing/typeclass.ml(1217):44398-44596
                                                                  (after typing/typeclass.ml(1217):44398-44596
                                                                    (apply rc
                                                                    (makeblock 0
                                                                    (makeblock 4
                                                                    rec_flag
                                                                    defs vals
                                                                    cl)
                                                                    (field 1
                                                                    scl)
                                                                    (field 2
                                                                    cl)
                                                                    val_env
                                                                    (field 2
                                                                    scl))))))))))))))
                                             case tag 5:
                                              (let
                                                (scty =a (field 1 *match*)
                                                 scl' =a (field 0 *match*))
                                                (before typing/typeclass.ml(1224):44638-45671
                                                  (seq
                                                    (after typing/typeclass.ml(1224):44638-44662
                                                      (apply
                                                        (field 9
                                                          (global Ctype!))
                                                        0a))
                                                    (before typing/typeclass.ml(1225):44670-45671
                                                      (let
                                                        (context =
                                                           (after typing/typeclass.ml(1225):44684-44702
                                                             (apply
                                                               (field 8
                                                                 (global Typetexp!))
                                                               0a)))
                                                        (before typing/typeclass.ml(1226):44712-45671
                                                          (let
                                                            (cl =
                                                               (after typing/typeclass.ml(1226):44721-44759
                                                                 (apply
                                                                   class_expr
                                                                   cl_num
                                                                   val_env
                                                                   met_env
                                                                   scl')))
                                                            (before typing/typeclass.ml(1227):44769-45671
                                                              (seq
                                                                (after typing/typeclass.ml(1227):44769-44791
                                                                  (apply
                                                                    (field 9
                                                                    (global Typetexp!))
                                                                    context))
                                                                (before typing/typeclass.ml(1228):44799-45671
                                                                  (let
                                                                    (context =
                                                                    (after typing/typeclass.ml(1228):44813-44831
                                                                    (apply
                                                                    (field 8
                                                                    (global Typetexp!))
                                                                    0a)))
                                                                    (before typing/typeclass.ml(1229):44841-45671
                                                                    (let
                                                                    (clty =
                                                                    (after typing/typeclass.ml(1229):44852-44875
                                                                    (apply
                                                                    class_type
                                                                    val_env
                                                                    scty)))
                                                                    (before typing/typeclass.ml(1230):44885-45671
                                                                    (seq
                                                                    (after typing/typeclass.ml(1230):44885-44907
                                                                    (apply
                                                                    (field 9
                                                                    (global Typetexp!))
                                                                    context))
                                                                    (before typing/typeclass.ml(1231):44915-45671
                                                                    (seq
                                                                    (after typing/typeclass.ml(1231):44915-44931
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1233):44940-45671
                                                                    (seq
                                                                    (after typing/typeclass.ml(1233):44940-45029
                                                                    (apply
                                                                    limited_generalize
                                                                    (after typing/typeclass.ml(1233):44959-45008
                                                                    (apply
                                                                    (field 30
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(1233):44979-45007
                                                                    (apply
                                                                    (field 102
                                                                    (global Ctype!))
                                                                    (field 2
                                                                    cl)))))
                                                                    (field 2
                                                                    cl)))
                                                                    (before typing/typeclass.ml(1235):45037-45671
                                                                    (seq
                                                                    (after typing/typeclass.ml(1235):45037-45134
                                                                    (apply
                                                                    limited_generalize
                                                                    (after typing/typeclass.ml(1235):45056-45110
                                                                    (apply
                                                                    (field 30
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(1235):45076-45109
                                                                    (apply
                                                                    (field 102
                                                                    (global Ctype!))
                                                                    (field 1
                                                                    clty)))))
                                                                    (field 1
                                                                    clty)))
                                                                    (before typing/typeclass.ml(1238):45143-45671
                                                                    (seq
                                                                    (let
                                                                    (error =
                                                                    (after typing/typeclass.ml(1239):45163-45222
                                                                    (apply
                                                                    (field 0
                                                                    (global Includeclass!))
                                                                    val_env
                                                                    (field 2
                                                                    cl)
                                                                    (field 1
                                                                    clty))))
                                                                    (if error
                                                                    (before typing/typeclass.ml(1242):45271-45330
                                                                    (raise
                                                                    (after typing/typeclass.ml(1242):45276-45330
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    cl)
                                                                    val_env
                                                                    (makeblock 14
                                                                    error)))))
                                                                    (before typing/typeclass.ml(1241):45251-45253
                                                                    0a)))
                                                                    (before typing/typeclass.ml(1244):45348-45671
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1244):45376-45411
                                                                    (apply
                                                                    extract_constraints
                                                                    (field 1
                                                                    clty)))
                                                                    concrs =a
                                                                    (field 2
                                                                    *match*)
                                                                    meths =a
                                                                    (field 1
                                                                    *match*)
                                                                    vals =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1245):45421-45671
                                                                    (after typing/typeclass.ml(1245):45421-45671
                                                                    (apply rc
                                                                    (makeblock 0
                                                                    (makeblock 5
                                                                    cl
                                                                    (makeblock 0
                                                                    clty)
                                                                    vals
                                                                    meths
                                                                    concrs)
                                                                    (field 1
                                                                    scl)
                                                                    (field 1
                                                                    (after typing/typeclass.ml(1247):45544-45585
                                                                    (apply
                                                                    (field 55
                                                                    (global Ctype!))
                                                                    0a
                                                                    (field 1
                                                                    clty))))
                                                                    val_env
                                                                    (field 2
                                                                    scl))))))))))))))))))))))))))))))
                                             case tag 6:
                                              (let (ext =a (field 0 *match*))
                                                (before typing/typeclass.ml(1263):46159-46224
                                                  (raise
                                                    (after typing/typeclass.ml(1263):46165-46224
                                                      (makeblock 0
                                                        Error_forward
                                                        (after typing/typeclass.ml(1263):46180-46223
                                                          (apply
                                                            (field 8
                                                              (global Builtin_attributes!))
                                                            ext)))))))
                                             case tag 7:
                                              (let
                                                (e =a (field 1 *match*)
                                                 pod =a (field 0 *match*))
                                                (before typing/typeclass.ml(1252):45703-46127
                                                  (let
                                                    (used_slot =
                                                       (makemutable 0 0a))
                                                    (before typing/typeclass.ml(1253):45738-46127
                                                      (let
                                                        (*match* =
                                                           (after typing/typeclass.ml(1253):45762-45801
                                                             (apply
                                                               (field 0
                                                                 type_open_descr)
                                                               (makeblock 0
                                                                 used_slot)
                                                               val_env pod))
                                                         new_val_env =a
                                                           (field 1 *match*)
                                                         od =a
                                                           (field 0 *match*))
                                                        (before typing/typeclass.ml(1254):45811-46127
                                                          (let
                                                            (*match* =
                                                               (after typing/typeclass.ml(1254):45835-45874
                                                                 (apply
                                                                   (field 0
                                                                    type_open_descr)
                                                                   (makeblock 0
                                                                    used_slot)
                                                                   met_env
                                                                   pod))
                                                             new_met_env =a
                                                               (field 1
                                                                 *match*))
                                                            (before typing/typeclass.ml(1255):45884-46127
                                                              (let
                                                                (cl =
                                                                   (after typing/typeclass.ml(1255):45893-45936
                                                                    (apply
                                                                    class_expr
                                                                    cl_num
                                                                    new_val_env
                                                                    new_met_env
                                                                    e)))
                                                                (before typing/typeclass.ml(1256):45946-46127
                                                                  (after typing/typeclass.ml(1256):45946-46127
                                                                    (apply rc
                                                                    (makeblock 0
                                                                    (makeblock 6
                                                                    od cl)
                                                                    (field 1
                                                                    scl)
                                                                    (field 2
                                                                    cl)
                                                                    val_env
                                                                    (field 2
                                                                    scl))))))))))))))))))))
                                (let
                                  (var_option =
                                     (after typing/typeclass.ml(1270):46417-46456
                                       (apply (field 10 (global Predef!))
                                         (after typing/typeclass.ml(1270):46436-46456
                                           (apply (field 6 (global Btype!))
                                             0a 0a)))))
                                  (letrec
                                    (approx_declaration
                                       (function cl
                                         (funct-body typing/typeclass.ml(1272)<ghost>:46485-46854
                                           (before typing/typeclass.ml(1273):46492-46854
                                             (let (*match* = (field 0 cl))
                                               (switch *match*
                                                case tag 2:
                                                 (let
                                                   (cl =a (field 3 *match*)
                                                    l =a (field 0 *match*))
                                                   (before typing/typeclass.ml(1275):46550-46717
                                                     (let
                                                       (arg =
                                                          (if
                                                            (after typing/typeclass.ml(1276):46571-46590
                                                              (apply
                                                                (field 52
                                                                  (global Btype!))
                                                                l))
                                                            (before typing/typeclass.ml(1276):46596-46621
                                                              (after typing/typeclass.ml(1276):46596-46621
                                                                (apply
                                                                  (field 46
                                                                    (global Ctype!))
                                                                  0a
                                                                  var_option)))
                                                            (before typing/typeclass.ml(1277):46635-46650
                                                              (after typing/typeclass.ml(1277):46635-46650
                                                                (apply
                                                                  (field 18
                                                                    (global Ctype!))
                                                                  0a 0a)))))
                                                       (before typing/typeclass.ml(1278):46660-46717
                                                         (after typing/typeclass.ml(1278):46660-46717
                                                           (apply
                                                             (field 17
                                                               (global Ctype!))
                                                             (makeblock 1 l
                                                               arg
                                                               (after typing/typeclass.ml(1278):46689-46710
                                                                 (apply
                                                                   approx_declaration
                                                                   cl))
                                                               0a)))))))
                                                case tag 4:
                                                 (let
                                                   (cl =a (field 2 *match*))
                                                   (before typing/typeclass.ml(1280):46750-46771
                                                     (after typing/typeclass.ml(1280):46750-46771
                                                       (apply
                                                         approx_declaration
                                                         cl))))
                                                case tag 5:
                                                 (let
                                                   (cl =a (field 0 *match*))
                                                   (before typing/typeclass.ml(1282):46808-46829
                                                     (after typing/typeclass.ml(1282):46808-46829
                                                       (apply
                                                         approx_declaration
                                                         cl))))
                                                default:
                                                 (before typing/typeclass.ml(1283):46839-46854
                                                   (after typing/typeclass.ml(1283):46839-46854
                                                     (apply
                                                       (field 18
                                                         (global Ctype!))
                                                       0a 0a)))))))))
                                    (letrec
                                      (approx_description
                                         (function ct
                                           (funct-body typing/typeclass.ml(1285)<ghost>:46883-47141
                                             (before typing/typeclass.ml(1286):46890-47141
                                               (let (*match* = (field 0 ct))
                                                 (switch *match*
                                                  case tag 2:
                                                   (let
                                                     (ct =a (field 2 *match*)
                                                      l =a (field 0 *match*))
                                                     (before typing/typeclass.ml(1288):46949-47116
                                                       (let
                                                         (arg =
                                                            (if
                                                              (after typing/typeclass.ml(1289):46970-46989
                                                                (apply
                                                                  (field 52
                                                                    (global Btype!))
                                                                  l))
                                                              (before typing/typeclass.ml(1289):46995-47020
                                                                (after typing/typeclass.ml(1289):46995-47020
                                                                  (apply
                                                                    (field 46
                                                                    (global Ctype!))
                                                                    0a
                                                                    var_option)))
                                                              (before typing/typeclass.ml(1290):47034-47049
                                                                (after typing/typeclass.ml(1290):47034-47049
                                                                  (apply
                                                                    (field 18
                                                                    (global Ctype!))
                                                                    0a 0a)))))
                                                         (before typing/typeclass.ml(1291):47059-47116
                                                           (after typing/typeclass.ml(1291):47059-47116
                                                             (apply
                                                               (field 17
                                                                 (global Ctype!))
                                                               (makeblock 1 l
                                                                 arg
                                                                 (after typing/typeclass.ml(1291):47088-47109
                                                                   (apply
                                                                    approx_description
                                                                    ct))
                                                                 0a)))))))
                                                  default:
                                                   (before typing/typeclass.ml(1292):47126-47141
                                                     (after typing/typeclass.ml(1292):47126-47141
                                                       (apply
                                                         (field 18
                                                           (global Ctype!))
                                                         0a 0a)))))))))
                                      (let
                                        (temp_abbrev =
                                           (function loc env id arity[int]
                                             (funct-body typing/typeclass.ml(1296)<ghost>:47194-47918
                                               (before typing/typeclass.ml(1297):47215-47918
                                                 (let
                                                   (params =
                                                      (makemutable 0 0a))
                                                   (before typing/typeclass.ml(1298):47240-47918
                                                     (seq
                                                       (for _i 1 to arity
                                                         (before typing/typeclass.ml(1299):47267-47303
                                                           (setfield_ptr 0
                                                             params
                                                             (makeblock 0
                                                               (after typing/typeclass.ml(1299):47277-47292
                                                                 (apply
                                                                   (field 18
                                                                    (global Ctype!))
                                                                   0a 0a))
                                                               (field 0
                                                                 params)))))
                                                       (before typing/typeclass.ml(1301):47314-47918
                                                         (let
                                                           (ty =
                                                              (after typing/typeclass.ml(1301):47323-47353
                                                                (apply
                                                                  (field 21
                                                                    (global Ctype!))
                                                                  (after typing/typeclass.ml(1301):47336-47353
                                                                    (apply
                                                                    (field 18
                                                                    (global Ctype!))
                                                                    0a 0a)))))
                                                           (before typing/typeclass.ml(1302):47359-47918
                                                             (let
                                                               (env =
                                                                  (after typing/typeclass.ml(1303):47373-47892
                                                                    (apply
                                                                    (field 48
                                                                    (global Env!))
                                                                    1a id
                                                                    (makeblock 0 (*,int,*,*,*,*,*,int,*,*,*,*)
                                                                    (field 0
                                                                    params)
                                                                    arity 0a
                                                                    1a
                                                                    (makeblock 0
                                                                    ty)
                                                                    (after typing/typeclass.ml(1309):47577-47616
                                                                    (apply
                                                                    (field 7
                                                                    (global Misc!))
                                                                    (field 1
                                                                    (field 3
                                                                    (global Types!)))
                                                                    arity))
                                                                    0a
                                                                    (field 38
                                                                    (global Btype!))
                                                                    loc 0a 0a
                                                                    (field 4
                                                                    (global Types!)))
                                                                    env)))
                                                               (before typing/typeclass.ml(1319):47900-47918
                                                                 (makeblock 0
                                                                   (field 0
                                                                    params)
                                                                   ty env))))))))))))
                                         initial_env =
                                           (function define_class approx
                                             param param
                                             (funct-body typing/typeclass.ml(1321)<ghost>:47936-49455
                                               (let
                                                 (cl_id =a (field 4 param)
                                                  obj_id =a (field 3 param)
                                                  ty_id =a (field 2 param)
                                                  id =a (field 1 param)
                                                  cl =a (field 0 param)
                                                  env =a (field 1 param)
                                                  res =a (field 0 param))
                                                 (before typing/typeclass.ml(1324):48038-49455
                                                   (let
                                                     (arity =[int]
                                                        (after typing/typeclass.ml(1324):48050-48075
                                                          (apply
                                                            (field 0
                                                              (global Stdlib__list!))
                                                            (field 1 cl))))
                                                     (before typing/typeclass.ml(1325):48081-49455
                                                       (let
                                                         (*match* =
                                                            (after typing/typeclass.ml(1325):48113-48152
                                                              (apply
                                                                temp_abbrev
                                                                (field 4 cl)
                                                                env obj_id
                                                                arity))
                                                          env =a
                                                            (field 2 *match*)
                                                          obj_ty =a
                                                            (field 1 *match*)
                                                          obj_params =a
                                                            (field 0 *match*))
                                                         (before typing/typeclass.ml(1326):48158-49455
                                                           (let
                                                             (*match* =
                                                                (after typing/typeclass.ml(1326):48188-48226
                                                                  (apply
                                                                    temp_abbrev
                                                                    (field 4
                                                                    cl) env
                                                                    cl_id
                                                                    arity))
                                                              env =a
                                                                (field 2
                                                                  *match*)
                                                              cl_ty =a
                                                                (field 1
                                                                  *match*)
                                                              cl_params =a
                                                                (field 0
                                                                  *match*))
                                                             (before typing/typeclass.ml(1329):48282-49455
                                                               (let
                                                                 (constr_type =
                                                                    (after typing/typeclass.ml(1329):48300-48318
                                                                    (apply
                                                                    approx
                                                                    (field 3
                                                                    cl))))
                                                                 (before typing/typeclass.ml(1330):48324-49455
                                                                   (seq
                                                                    (if
                                                                    (field 0
                                                                    (field 47
                                                                    (global Clflags!)))
                                                                    (before typing/typeclass.ml(1330):48351-48385
                                                                    (after typing/typeclass.ml(1330):48351-48385
                                                                    (apply
                                                                    (field 42
                                                                    (global Ctype!))
                                                                    constr_type)))
                                                                    0a)
                                                                    (before typing/typeclass.ml(1331):48389-49455
                                                                    (let
                                                                    (dummy_cty =
                                                                    (makeblock 1
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1333):48443-48458
                                                                    (apply
                                                                    (field 18
                                                                    (global Ctype!))
                                                                    0a 0a))
                                                                    (field 0
                                                                    (field 2
                                                                    (global Types!)))
                                                                    (field 0
                                                                    (field 8
                                                                    (global Types!)))
                                                                    0a)))
                                                                    (before typing/typeclass.ml(1338):48559-49455
                                                                    (let
                                                                    (dummy_class =
                                                                    (makemutable 0
                                                                    0a
                                                                    dummy_cty
                                                                    unbound_class
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    cl))
                                                                    (if
                                                                    *match*
                                                                    (before typing/typeclass.ml(1346):48840-48856
                                                                    (makeblock 0
                                                                    constr_type))
                                                                    (before typing/typeclass.ml(1345):48814-48818
                                                                    0a))) 0a
                                                                    (field 0
                                                                    (global Location!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1352):48938-49455
                                                                    (let
                                                                    (env =
                                                                    (after typing/typeclass.ml(1353):48952-49326
                                                                    (apply
                                                                    (field 54
                                                                    (global Env!))
                                                                    ty_id
                                                                    (makeblock 0
                                                                    0a
                                                                    dummy_cty
                                                                    unbound_class
                                                                    0a
                                                                    (field 0
                                                                    (global Location!))
                                                                    0a)
                                                                    (if
                                                                    define_class
                                                                    (before typing/typeclass.ml(1363):49259-49291
                                                                    (after typing/typeclass.ml(1363):49259-49291
                                                                    (apply
                                                                    (field 53
                                                                    (global Env!))
                                                                    id
                                                                    dummy_class
                                                                    env)))
                                                                    (before typing/typeclass.ml(1365):49315-49318
                                                                    env)))))
                                                                    (before typing/typeclass.ml(1368):49334-49455
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    cl id
                                                                    ty_id
                                                                    obj_id
                                                                    obj_params
                                                                    obj_ty
                                                                    cl_id
                                                                    cl_params
                                                                    cl_ty
                                                                    constr_type
                                                                    dummy_class)
                                                                    res) env)))))))))))))))))))))
                                         class_infos =
                                           (function define_class kind param
                                             param
                                             (funct-body typing/typeclass.ml(1374)<ghost>:49473-56491
                                               (let
                                                 (env =a (field 1 param)
                                                  res =a (field 0 param)
                                                  dummy_class =a
                                                    (field 10 param)
                                                  constr_type =a
                                                    (field 9 param)
                                                  cl_ty =a (field 8 param)
                                                  cl_params =a
                                                    (field 7 param)
                                                  cl_id =a (field 6 param)
                                                  obj_ty =a (field 5 param)
                                                  obj_params =a
                                                    (field 4 param)
                                                  obj_id =a (field 3 param)
                                                  ty_id =a (field 2 param)
                                                  id =a (field 1 param)
                                                  cl =a (field 0 param))
                                                 (before typing/typeclass.ml(1381):49625-56491
                                                   (seq
                                                     (after typing/typeclass.ml(1381):49625-49648
                                                       (apply
                                                         (field 5
                                                           (global Typetexp!))
                                                         0a))
                                                     (before typing/typeclass.ml(1382):49652-56491
                                                       (seq
                                                         (after typing/typeclass.ml(1382):49652-49676
                                                           (apply
                                                             (field 9
                                                               (global Ctype!))
                                                             0a))
                                                         (before typing/typeclass.ml(1385):49716-56491
                                                           (let
                                                             (ci_params =
                                                                (let
                                                                  (make_param =
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1386)<ghost>:49751-49900
                                                                    (let
                                                                    (v =a
                                                                    (field 1
                                                                    param)
                                                                    sty =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1387):49768-49900
                                                                    (try
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1388):49783-49808
                                                                    (apply
                                                                    (field 7
                                                                    (global Typetexp!))
                                                                    env sty))
                                                                    v)
                                                                    with exn
                                                                    (if
                                                                    (== exn
                                                                    (field 10
                                                                    (global Typetexp!)))
                                                                    (before typing/typeclass.ml(1390):49849-49900
                                                                    (raise
                                                                    (after typing/typeclass.ml(1390):49854-49900
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 1
                                                                    sty) env
                                                                    0a))))
                                                                    (reraise
                                                                    exn))))))))
                                                                  (before typing/typeclass.ml(1392):49914-49947
                                                                    (after typing/typeclass.ml(1392):49914-49947
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    make_param
                                                                    (field 1
                                                                    cl))))))
                                                             (before typing/typeclass.ml(1394):49955-56491
                                                               (let
                                                                 (params =
                                                                    (after typing/typeclass.ml(1394):49968-50018
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1394):49977-50008
                                                                    (let
                                                                    (cty =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1394):49994-50007
                                                                    (field 1
                                                                    cty)))))
                                                                    ci_params)))
                                                                 (before typing/typeclass.ml(1397):50084-56491
                                                                   (let
                                                                    (coercion_locs =
                                                                    (makemutable 0
                                                                    0a))
                                                                    (before typing/typeclass.ml(1400):50151-56491
                                                                    (let
                                                                    (*match* =
                                                                    (try
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    (field 21
                                                                    (global Typecore!))
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    obj_id)
                                                                    coercion_locs)
                                                                    (field 0
                                                                    (field 21
                                                                    (global Typecore!)))))
                                                                    (before typing/typeclass.ml(1404):50287-50395
                                                                    (let
                                                                    (res =
                                                                    (after typing/typeclass.ml(1404):50297-50317
                                                                    (apply
                                                                    kind env
                                                                    (field 3
                                                                    cl))))
                                                                    (before typing/typeclass.ml(1405):50327-50395
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    (field 21
                                                                    (global Typecore!))
                                                                    (after typing/typeclass.ml(1405):50353-50384
                                                                    (apply
                                                                    (field 5
                                                                    (global Stdlib__list!))
                                                                    (field 0
                                                                    (field 21
                                                                    (global Typecore!))))))
                                                                    (before typing/typeclass.ml(1406):50392-50395
                                                                    res))))))
                                                                    with exn
                                                                    (before typing/typeclass.ml(1408):50418-50457
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    (field 21
                                                                    (global Typecore!))
                                                                    0a)
                                                                    (before typing/typeclass.ml(1408):50448-50457
                                                                    (reraise
                                                                    (after typing/typeclass.ml(1408):50454-50457
                                                                    exn))))))
                                                                    typ =a
                                                                    (field 1
                                                                    *match*)
                                                                    expr =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1411):50466-56491
                                                                    (seq
                                                                    (after typing/typeclass.ml(1411):50466-50482
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1413):50487-56491
                                                                    (let
                                                                    (sty =
                                                                    (after typing/typeclass.ml(1413):50497-50516
                                                                    (apply
                                                                    (field 102
                                                                    (global Ctype!))
                                                                    typ)))
                                                                    (before typing/typeclass.ml(1416):50590-56491
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1416):50608-50654
                                                                    (apply
                                                                    (field 26
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(1416):50629-50654
                                                                    (apply
                                                                    (field 25
                                                                    (global Ctype!))
                                                                    sty))))
                                                                    fields =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1417):50660-56491
                                                                    (seq
                                                                    (after typing/typeclass.ml(1417):50660-50749
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1417):50670-50738
                                                                    (let
                                                                    (ty =a
                                                                    (field 2
                                                                    param)
                                                                    met =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1417):50691-50737
                                                                    (if
                                                                    (after typing/typeclass.ml(1417):50694-50712
                                                                    (caml_string_equal
                                                                    met
                                                                    dummy_method))
                                                                    (before typing/typeclass.ml(1417):50718-50737
                                                                    (after typing/typeclass.ml(1417):50718-50737
                                                                    (apply
                                                                    (field 39
                                                                    (global Ctype!))
                                                                    ty))) 0a)))))
                                                                    fields))
                                                                    (before typing/typeclass.ml(1420):50789-56491
                                                                    (let
                                                                    (rv =
                                                                    (after typing/typeclass.ml(1420):50798-50820
                                                                    (apply
                                                                    (field 30
                                                                    (global Ctype!))
                                                                    sty)))
                                                                    (before typing/typeclass.ml(1421):50826-56491
                                                                    (seq
                                                                    (after typing/typeclass.ml(1421):50826-50872
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1421):50836-50865
                                                                    (apply
                                                                    (field 44
                                                                    (global Ctype!))
                                                                    rv))
                                                                    params))
                                                                    (before typing/typeclass.ml(1422):50876-56491
                                                                    (seq
                                                                    (after typing/typeclass.ml(1422):50876-50901
                                                                    (apply
                                                                    limited_generalize
                                                                    rv typ))
                                                                    (before typing/typeclass.ml(1425):50957-56491
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1425):50987-51018
                                                                    (apply
                                                                    (field 55
                                                                    (global Ctype!))
                                                                    params
                                                                    typ))
                                                                    obj_type =a
                                                                    (field 1
                                                                    *match*)
                                                                    obj_params' =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1426):51024-56491
                                                                    (let
                                                                    (constr =
                                                                    (after typing/typeclass.ml(1426):51037-51084
                                                                    (apply
                                                                    (field 22
                                                                    (global Ctype!))
                                                                    (makeblock 0
                                                                    obj_id)
                                                                    obj_params)))
                                                                    (before typing/typeclass.ml(1427):51090-56491
                                                                    (seq
                                                                    (let
                                                                    (ty =
                                                                    (after typing/typeclass.ml(1428):51109-51133
                                                                    (apply
                                                                    (field 102
                                                                    (global Ctype!))
                                                                    obj_type)))
                                                                    (before typing/typeclass.ml(1429):51141-51766
                                                                    (seq
                                                                    (after typing/typeclass.ml(1429):51141-51170
                                                                    (apply
                                                                    (field 33
                                                                    (global Ctype!))
                                                                    ty))
                                                                    (before typing/typeclass.ml(1430):51176-51766
                                                                    (seq
                                                                    (if
                                                                    (not
                                                                    (after typing/typeclass.ml(1430):51183-51206
                                                                    (apply
                                                                    (field 29
                                                                    (global Ctype!))
                                                                    ty)))
                                                                    (before typing/typeclass.ml(1431):51218-51269
                                                                    (raise
                                                                    (after typing/typeclass.ml(1431):51223-51269
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 24
                                                                    ty)))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(1432):51275-51766
                                                                    (seq
                                                                    (try
                                                                    (after typing/typeclass.ml(1433):51291-51342
                                                                    (apply
                                                                    (field 22
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1433):51302-51319
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env))
                                                                    obj_params
                                                                    obj_params'))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (before typing/typeclass.ml(1435):51375-51571
                                                                    (raise
                                                                    (after typing/typeclass.ml(1435):51380-51571
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 13
                                                                    obj_id
                                                                    constr
                                                                    (after typing/typeclass.ml(1437):51476-51568
                                                                    (apply
                                                                    (field 22
                                                                    (global Ctype!))
                                                                    (makeblock 0
                                                                    obj_id)
                                                                    obj_params')))))))
                                                                    (reraise
                                                                    exn))))
                                                                    (before typing/typeclass.ml(1440):51585-51766
                                                                    (try
                                                                    (after typing/typeclass.ml(1441):51601-51626
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env ty
                                                                    constr))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (before typing/typeclass.ml(1443):51659-51758
                                                                    (raise
                                                                    (after typing/typeclass.ml(1443):51664-51758
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 8
                                                                    constr ty
                                                                    (after typing/typeclass.ml(1444):51727-51755
                                                                    (apply
                                                                    (field 60
                                                                    (global Ctype!))
                                                                    env
                                                                    constr)))))))
                                                                    (reraise
                                                                    exn))))))))))))
                                                                    (before typing/typeclass.ml(1449):51833-56491
                                                                    (seq
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1450):51871-51902
                                                                    (apply
                                                                    (field 55
                                                                    (global Ctype!))
                                                                    params
                                                                    typ))
                                                                    cl_type =a
                                                                    (field 1
                                                                    *match*)
                                                                    cl_params' =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1451):51910-52686
                                                                    (let
                                                                    (ty =
                                                                    (after typing/typeclass.ml(1451):51919-51942
                                                                    (apply
                                                                    (field 102
                                                                    (global Ctype!))
                                                                    cl_type)))
                                                                    (before typing/typeclass.ml(1452):51950-52686
                                                                    (seq
                                                                    (after typing/typeclass.ml(1452):51950-51979
                                                                    (apply
                                                                    (field 33
                                                                    (global Ctype!))
                                                                    ty))
                                                                    (before typing/typeclass.ml(1453):51985-52686
                                                                    (seq
                                                                    (after typing/typeclass.ml(1453):51985-52050
                                                                    (apply
                                                                    (field 31
                                                                    (global Ctype!))
                                                                    obj_id
                                                                    (after typing/typeclass.ml(1453):52014-52037
                                                                    (apply
                                                                    (field 30
                                                                    (global Ctype!))
                                                                    ty))
                                                                    cl_params
                                                                    ty))
                                                                    (before typing/typeclass.ml(1454):52056-52686
                                                                    (seq
                                                                    (try
                                                                    (after typing/typeclass.ml(1455):52072-52121
                                                                    (apply
                                                                    (field 22
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1455):52083-52100
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env))
                                                                    cl_params
                                                                    cl_params'))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (before typing/typeclass.ml(1457):52154-52458
                                                                    (raise
                                                                    (after typing/typeclass.ml(1457):52159-52458
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 13
                                                                    cl_id
                                                                    (after typing/typeclass.ml(1459):52246-52335
                                                                    (apply
                                                                    (field 22
                                                                    (global Ctype!))
                                                                    (makeblock 0
                                                                    cl_id)
                                                                    cl_params))
                                                                    (after typing/typeclass.ml(1461):52365-52455
                                                                    (apply
                                                                    (field 22
                                                                    (global Ctype!))
                                                                    (makeblock 0
                                                                    cl_id)
                                                                    cl_params')))))))
                                                                    (reraise
                                                                    exn))))
                                                                    (before typing/typeclass.ml(1464):52472-52686
                                                                    (try
                                                                    (after typing/typeclass.ml(1465):52488-52512
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env ty
                                                                    cl_ty))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (before typing/typeclass.ml(1467):52545-52678
                                                                    (let
                                                                    (constr =
                                                                    (after typing/typeclass.ml(1467):52558-52600
                                                                    (apply
                                                                    (field 22
                                                                    (global Ctype!))
                                                                    (makeblock 0
                                                                    cl_id)
                                                                    params)))
                                                                    (before typing/typeclass.ml(1468):52610-52678
                                                                    (raise
                                                                    (after typing/typeclass.ml(1468):52615-52678
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 8
                                                                    constr ty
                                                                    cl_ty)))))))
                                                                    (reraise
                                                                    exn))))))))))))))
                                                                    (before typing/typeclass.ml(1473):52735-56491
                                                                    (seq
                                                                    (try
                                                                    (after typing/typeclass.ml(1474):52749-52840
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env
                                                                    (after typing/typeclass.ml(1475):52771-52805
                                                                    (apply
                                                                    constructor_type
                                                                    constr
                                                                    obj_type))
                                                                    (after typing/typeclass.ml(1476):52812-52840
                                                                    (apply
                                                                    (field 46
                                                                    (global Ctype!))
                                                                    0a
                                                                    constr_type))))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 1
                                                                    (global Ctype!)))
                                                                    (let
                                                                    (trace =a
                                                                    (field 1
                                                                    exn))
                                                                    (before typing/typeclass.ml(1478):52873-52970
                                                                    (raise
                                                                    (after typing/typeclass.ml(1478):52878-52970
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 9
                                                                    (field 0
                                                                    (field 2
                                                                    cl))
                                                                    trace))))))
                                                                    (reraise
                                                                    exn))))
                                                                    (before typing/typeclass.ml(1483):53032-56491
                                                                    (let
                                                                    (cty_variance =
                                                                    (after typing/typeclass.ml(1483):53051-53091
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1483):53060-53084
                                                                    (before typing/typeclass.ml(1483):53070-53083
                                                                    (field 1
                                                                    (field 3
                                                                    (global Types!))))))
                                                                    params)))
                                                                    (before typing/typeclass.ml(1484):53097-56491
                                                                    (let
                                                                    (cltydef =
                                                                    (makeblock 0
                                                                    params
                                                                    (after typing/typeclass.ml(1485):53150-53164
                                                                    (apply
                                                                    class_body
                                                                    typ))
                                                                    (makeblock 0
                                                                    obj_id)
                                                                    cty_variance
                                                                    (field 4
                                                                    cl)
                                                                    (field 5
                                                                    cl))
                                                                    clty =
                                                                    (makemutable 0
                                                                    params
                                                                    typ
                                                                    (makeblock 0
                                                                    obj_id)
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    cl))
                                                                    (if
                                                                    *match*
                                                                    (before typing/typeclass.ml(1498):53537-53553
                                                                    (makeblock 0
                                                                    constr_type))
                                                                    (before typing/typeclass.ml(1497):53511-53515
                                                                    0a)))
                                                                    cty_variance
                                                                    (field 4
                                                                    cl)
                                                                    (field 5
                                                                    cl)))
                                                                    (before typing/typeclass.ml(1504):53647-56491
                                                                    (seq
                                                                    (setfield_ptr 1
                                                                    dummy_class
                                                                    typ)
                                                                    (before typing/typeclass.ml(1505):53678-56491
                                                                    (let
                                                                    (env =
                                                                    (after typing/typeclass.ml(1506):53692-53783
                                                                    (apply
                                                                    (field 54
                                                                    (global Env!))
                                                                    ty_id
                                                                    cltydef
                                                                    (if
                                                                    define_class
                                                                    (before typing/typeclass.ml(1507):53748-53773
                                                                    (after typing/typeclass.ml(1507):53748-53773
                                                                    (apply
                                                                    (field 53
                                                                    (global Env!))
                                                                    id clty
                                                                    env)))
                                                                    (before typing/typeclass.ml(1507):53779-53782
                                                                    env)))))
                                                                    (before typing/typeclass.ml(1510):53792-56491
                                                                    (seq
                                                                    (if
                                                                    (==
                                                                    (field 0
                                                                    cl) 1a)
                                                                    (before typing/typeclass.ml(1510):53823-54235
                                                                    (let
                                                                    (sign =
                                                                    (after typing/typeclass.ml(1511):53844-53877
                                                                    (apply
                                                                    (field 101
                                                                    (global Ctype!))
                                                                    typ)))
                                                                    (before typing/typeclass.ml(1512):53885-54229
                                                                    (let
                                                                    (mets =
                                                                    (after typing/typeclass.ml(1512):53896-53916
                                                                    (apply
                                                                    virtual_methods
                                                                    sign)))
                                                                    (before typing/typeclass.ml(1513):53924-54229
                                                                    (let
                                                                    (vals =
                                                                    (after typing/typeclass.ml(1514):53941-54054
                                                                    (apply
                                                                    (field 12
                                                                    (field 2
                                                                    (global Types!)))
                                                                    (function
                                                                    name
                                                                    param l
                                                                    (funct-body typing/typeclass.ml(1515):53959-54028
                                                                    (let
                                                                    (vr =a
                                                                    (field 1
                                                                    param))
                                                                    (before typing/typeclass.ml(1515):53990-54027
                                                                    (if
                                                                    (== vr
                                                                    0a)
                                                                    (before typing/typeclass.ml(1515):54011-54020
                                                                    (makeblock 0
                                                                    name l))
                                                                    (before typing/typeclass.ml(1515):54026-54027
                                                                    l))))))
                                                                    (field 1
                                                                    sign) 0a)))
                                                                    (before typing/typeclass.ml(1517):54062-54228
                                                                    (if
                                                                    (||
                                                                    (!= mets
                                                                    0a)
                                                                    (!= vals
                                                                    0a))
                                                                    (before typing/typeclass.ml(1518):54102-54228
                                                                    (raise
                                                                    (after typing/typeclass.ml(1518):54107-54228
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 10
                                                                    define_class
                                                                    0a mets
                                                                    vals)))))
                                                                    0a))))))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(1523):54254-56491
                                                                    (let
                                                                    (arity =[int]
                                                                    (after typing/typeclass.ml(1523):54266-54292
                                                                    (apply
                                                                    (field 103
                                                                    (global Ctype!))
                                                                    typ)))
                                                                    (before typing/typeclass.ml(1524):54298-56491
                                                                    (let
                                                                    (pub_meths =
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1526):54342-54415
                                                                    (apply
                                                                    (field 26
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(1526):54363-54415
                                                                    (apply
                                                                    (field 25
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(1526):54384-54414
                                                                    (apply
                                                                    (field 60
                                                                    (global Ctype!))
                                                                    env
                                                                    obj_ty))))))
                                                                    fields =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1528):54427-54472
                                                                    (after typing/typeclass.ml(1528):54427-54472
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1528):54436-54465
                                                                    (let
                                                                    (lab =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1528):54461-54464
                                                                    lab))))
                                                                    fields)))))
                                                                    (before typing/typeclass.ml(1532):54507-56491
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1532):54529-54560
                                                                    (apply
                                                                    (field 55
                                                                    (global Ctype!))
                                                                    params
                                                                    typ))
                                                                    typ' =a
                                                                    (field 1
                                                                    *match*)
                                                                    params' =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1533):54566-56491
                                                                    (let
                                                                    (cltydef =
                                                                    (makeblock 0
                                                                    params'
                                                                    (after typing/typeclass.ml(1534):54620-54635
                                                                    (apply
                                                                    class_body
                                                                    typ'))
                                                                    (makeblock 0
                                                                    obj_id)
                                                                    cty_variance
                                                                    (field 4
                                                                    cl)
                                                                    (field 5
                                                                    cl))
                                                                    clty =
                                                                    (makemutable 0
                                                                    params'
                                                                    typ'
                                                                    (makeblock 0
                                                                    obj_id)
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    cl))
                                                                    (if
                                                                    *match*
                                                                    (before typing/typeclass.ml(1547):55010-55043
                                                                    (makeblock 0
                                                                    (after typing/typeclass.ml(1547):55015-55043
                                                                    (apply
                                                                    (field 46
                                                                    (global Ctype!))
                                                                    0a
                                                                    constr_type))))
                                                                    (before typing/typeclass.ml(1546):54984-54988
                                                                    0a)))
                                                                    cty_variance
                                                                    (field 4
                                                                    cl)
                                                                    (field 5
                                                                    cl)))
                                                                    (before typing/typeclass.ml(1553):55137-56491
                                                                    (let
                                                                    (obj_abbr =
                                                                    (makeblock 0 (*,int,*,*,*,*,*,int,*,*,*,*)
                                                                    obj_params
                                                                    (after typing/typeclass.ml(1555):55201-55223
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    obj_params))
                                                                    0a 1a
                                                                    (makeblock 0
                                                                    obj_ty)
                                                                    (after typing/typeclass.ml(1559):55340-55384
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1559):55349-55373
                                                                    (before typing/typeclass.ml(1559):55359-55372
                                                                    (field 1
                                                                    (field 3
                                                                    (global Types!))))))
                                                                    obj_params))
                                                                    0a
                                                                    (field 38
                                                                    (global Btype!))
                                                                    (field 4
                                                                    cl) 0a 0a
                                                                    (field 4
                                                                    (global Types!))))
                                                                    (before typing/typeclass.ml(1568):55639-56491
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1569):55668-55730
                                                                    (apply
                                                                    (field 51
                                                                    (global Ctype!))
                                                                    0a params
                                                                    (after typing/typeclass.ml(1569):55709-55730
                                                                    (apply
                                                                    (field 102
                                                                    (global Ctype!))
                                                                    typ))))
                                                                    cl_ty =a
                                                                    (field 1
                                                                    *match*)
                                                                    cl_params =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1571):55738-56491
                                                                    (seq
                                                                    (after typing/typeclass.ml(1571):55738-55770
                                                                    (apply
                                                                    (field 33
                                                                    (global Ctype!))
                                                                    cl_ty))
                                                                    (before typing/typeclass.ml(1572):55774-56491
                                                                    (seq
                                                                    (after typing/typeclass.ml(1572):55774-55845
                                                                    (apply
                                                                    (field 31
                                                                    (global Ctype!))
                                                                    obj_id
                                                                    (after typing/typeclass.ml(1572):55803-55829
                                                                    (apply
                                                                    (field 30
                                                                    (global Ctype!))
                                                                    cl_ty))
                                                                    cl_params
                                                                    cl_ty))
                                                                    (before typing/typeclass.ml(1573):55849-56491
                                                                    (let
                                                                    (cl_abbr =
                                                                    (makeblock 0 (*,int,*,*,*,*,*,int,*,*,*,*)
                                                                    cl_params
                                                                    (after typing/typeclass.ml(1575):55911-55932
                                                                    (apply
                                                                    (field 0
                                                                    (global Stdlib__list!))
                                                                    cl_params))
                                                                    0a 1a
                                                                    (makeblock 0
                                                                    cl_ty)
                                                                    (after typing/typeclass.ml(1579):56048-56091
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1579):56057-56081
                                                                    (before typing/typeclass.ml(1579):56067-56080
                                                                    (field 1
                                                                    (field 3
                                                                    (global Types!))))))
                                                                    cl_params))
                                                                    0a
                                                                    (field 38
                                                                    (global Btype!))
                                                                    (field 4
                                                                    cl) 0a 0a
                                                                    (field 4
                                                                    (global Types!))))
                                                                    (before typing/typeclass.ml(1588):56346-56491
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    (makeblock 0 (*,*,*,*,*,*,*,*,*,*,int,*,*,*)
                                                                    cl id
                                                                    clty
                                                                    ty_id
                                                                    cltydef
                                                                    obj_id
                                                                    obj_abbr
                                                                    cl_id
                                                                    cl_abbr
                                                                    ci_params
                                                                    arity
                                                                    pub_meths
                                                                    (after typing/typeclass.ml(1589):56445-56468
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__list!))
                                                                    (field 0
                                                                    coercion_locs)))
                                                                    expr)
                                                                    res) env)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
                                         final_decl =
                                           (function env define_class param
                                             (funct-body typing/typeclass.ml(1592)<ghost>:56508-58742
                                               (let
                                                 (expr =a (field 13 param)
                                                  coe =a (field 12 param)
                                                  pub_meths =a
                                                    (field 11 param)
                                                  arity =a (field 10 param)
                                                  ci_params =a
                                                    (field 9 param)
                                                  cl_abbr =a (field 8 param)
                                                  cl_id =a (field 7 param)
                                                  obj_abbr =a (field 6 param)
                                                  obj_id =a (field 5 param)
                                                  cltydef =a (field 4 param)
                                                  ty_id =a (field 3 param)
                                                  clty =a (field 2 param)
                                                  id =a (field 1 param)
                                                  cl =a (field 0 param))
                                                 (before typing/typeclass.ml(1596):56644-58742
                                                   (seq
                                                     (try
                                                       (after typing/typeclass.ml(1596):56654-56700
                                                         (apply
                                                           (field 105
                                                             (global Ctype!))
                                                           env
                                                           (field 0 clty)))
                                                      with exn
                                                       (let
                                                         (tag =a
                                                            (field 0 exn))
                                                         (if
                                                           (== tag
                                                             (field 1
                                                               (global Ctype!)))
                                                           (let
                                                             (trace =a
                                                                (field 1 exn))
                                                             (before typing/typeclass.ml(1598):56733-56809
                                                               (raise
                                                                 (after typing/typeclass.ml(1598):56738-56809
                                                                   (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 19
                                                                    id clty
                                                                    trace))))))
                                                           (reraise exn))))
                                                     (before typing/typeclass.ml(1602):56860-58742
                                                       (seq
                                                         (let
                                                           (self_type =
                                                              (after typing/typeclass.ml(1603):56886-56915
                                                                (apply
                                                                  (field 102
                                                                    (global Ctype!))
                                                                  (field 1
                                                                    clty))))
                                                           (before typing/typeclass.ml(1604):56923-57228
                                                             (let
                                                               (*match* =
                                                                  (after typing/typeclass.ml(1605):56946-57030
                                                                    (apply
                                                                    (field 26
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(1606):56975-57030
                                                                    (apply
                                                                    (field 25
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(1606):56996-57029
                                                                    (apply
                                                                    (field 60
                                                                    (global Ctype!))
                                                                    env
                                                                    self_type))))))
                                                                methods =a
                                                                  (field 0
                                                                    *match*))
                                                               (before typing/typeclass.ml(1608):57042-57228
                                                                 (after typing/typeclass.ml(1608):57042-57228
                                                                   (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1608):57052-57220
                                                                    (let
                                                                    (kind =a
                                                                    (field 1
                                                                    param)
                                                                    lab =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1609):57079-57214
                                                                    (if
                                                                    (after typing/typeclass.ml(1609):57082-57100
                                                                    (caml_string_equal
                                                                    lab
                                                                    dummy_method))
                                                                    (before typing/typeclass.ml(1610):57114-57214
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1610):57120-57146
                                                                    (apply
                                                                    (field 13
                                                                    (global Btype!))
                                                                    kind)))
                                                                    (if
                                                                    (isint
                                                                    *match*)
                                                                    (before typing/typeclass.ml(1612):57212-57214
                                                                    0a)
                                                                    (let
                                                                    (r =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1611):57172-57196
                                                                    (after typing/typeclass.ml(1611):57172-57196
                                                                    (apply
                                                                    (field 65
                                                                    (global Btype!))
                                                                    r 1a)))))))
                                                                    0a)))))
                                                                    methods))))))
                                                         (before typing/typeclass.ml(1616):57239-58742
                                                           (seq
                                                             (after typing/typeclass.ml(1616):57239-57281
                                                               (apply
                                                                 (field 14
                                                                   (global Stdlib__list!))
                                                                 (field 39
                                                                   (global Ctype!))
                                                                 (field 0
                                                                   clty)))
                                                             (before typing/typeclass.ml(1617):57285-58742
                                                               (seq
                                                                 (after typing/typeclass.ml(1617):57285-57325
                                                                   (apply
                                                                    generalize_class_type
                                                                    1a
                                                                    (field 1
                                                                    clty)))
                                                                 (before typing/typeclass.ml(1618):57329-58742
                                                                   (seq
                                                                    (after typing/typeclass.ml(1618):57329-57371
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__option!))
                                                                    (field 39
                                                                    (global Ctype!))
                                                                    (field 3
                                                                    clty)))
                                                                    (before typing/typeclass.ml(1619):57375-58742
                                                                    (seq
                                                                    (after typing/typeclass.ml(1619):57375-57422
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (field 39
                                                                    (global Ctype!))
                                                                    (field 0
                                                                    obj_abbr)))
                                                                    (before typing/typeclass.ml(1620):57426-58742
                                                                    (seq
                                                                    (after typing/typeclass.ml(1620):57426-57478
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__option!))
                                                                    (field 39
                                                                    (global Ctype!))
                                                                    (field 4
                                                                    obj_abbr)))
                                                                    (before typing/typeclass.ml(1621):57482-58742
                                                                    (seq
                                                                    (after typing/typeclass.ml(1621):57482-57528
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (field 39
                                                                    (global Ctype!))
                                                                    (field 0
                                                                    cl_abbr)))
                                                                    (before typing/typeclass.ml(1622):57532-58742
                                                                    (seq
                                                                    (after typing/typeclass.ml(1622):57532-57583
                                                                    (apply
                                                                    (field 8
                                                                    (global Stdlib__option!))
                                                                    (field 39
                                                                    (global Ctype!))
                                                                    (field 4
                                                                    cl_abbr)))
                                                                    (before typing/typeclass.ml(1624):57588-58742
                                                                    (seq
                                                                    (if
                                                                    (not
                                                                    (after typing/typeclass.ml(1624):57595-57614
                                                                    (apply
                                                                    closed_class
                                                                    clty)))
                                                                    (before typing/typeclass.ml(1625):57624-57689
                                                                    (raise
                                                                    (after typing/typeclass.ml(1625):57629-57689
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 17
                                                                    id clty)))))
                                                                    0a)
                                                                    (before typing/typeclass.ml(1627):57694-58742
                                                                    (seq
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1628):57710-57796
                                                                    (apply
                                                                    (field 99
                                                                    (global Ctype!))
                                                                    (field 0
                                                                    clty)
                                                                    (after typing/typeclass.ml(1629):57751-57796
                                                                    (apply
                                                                    (field 101
                                                                    (global Ctype!))
                                                                    (field 1
                                                                    clty))))))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (reason =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1633):57851-58108
                                                                    (let
                                                                    (printer =
                                                                    (if
                                                                    define_class
                                                                    (before typing/typeclass.ml(1635):57902-57956
                                                                    (function
                                                                    ppf
                                                                    (funct-body typing/typeclass.ml(1635):57902-57956
                                                                    (before typing/typeclass.ml(1635):57918-57956
                                                                    (after typing/typeclass.ml(1635):57918-57956
                                                                    (apply
                                                                    (field 39
                                                                    (global Printtyp!))
                                                                    id ppf
                                                                    clty))))))
                                                                    (before typing/typeclass.ml(1636):57970-58028
                                                                    (function
                                                                    ppf
                                                                    (funct-body typing/typeclass.ml(1636):57970-58028
                                                                    (before typing/typeclass.ml(1636):57986-58028
                                                                    (after typing/typeclass.ml(1636):57986-58028
                                                                    (apply
                                                                    (field 41
                                                                    (global Printtyp!))
                                                                    id ppf
                                                                    cltydef))))))))
                                                                    (before typing/typeclass.ml(1638):58044-58108
                                                                    (raise
                                                                    (after typing/typeclass.ml(1638):58049-58108
                                                                    (makeblock 0
                                                                    Error
                                                                    (field 4
                                                                    cl) env
                                                                    (makeblock 16
                                                                    printer
                                                                    reason))))))))
                                                                    (before typing/typeclass.ml(1631):57823-57825
                                                                    0a)))
                                                                    (before typing/typeclass.ml(1640):58118-58742
                                                                    (makeblock 0 (*,*,*,*,*,*,*,*,*,int,*,*,*,*)
                                                                    id
                                                                    (field 2
                                                                    cl) clty
                                                                    ty_id
                                                                    cltydef
                                                                    obj_id
                                                                    obj_abbr
                                                                    cl_id
                                                                    cl_abbr
                                                                    arity
                                                                    pub_meths
                                                                    coe expr
                                                                    (makeblock 0
                                                                    (field 0
                                                                    cl)
                                                                    ci_params
                                                                    (field 2
                                                                    cl) id
                                                                    ty_id
                                                                    obj_id
                                                                    cl_id
                                                                    expr clty
                                                                    cltydef
                                                                    (field 4
                                                                    cl)
                                                                    (field 5
                                                                    cl)))))))))))))))))))))))))))))
                                         class_infos =
                                           (function define_class kind param
                                             param
                                             (funct-body typing/typeclass.ml(1660)<ghost>:58799-59212
                                               (let
                                                 (env =a (field 1 param)
                                                  res =a (field 0 param)
                                                  dummy_class =a
                                                    (field 10 param)
                                                  constr_type =a
                                                    (field 9 param)
                                                  cl_ty =a (field 8 param)
                                                  cl_params =a
                                                    (field 7 param)
                                                  cl_id =a (field 6 param)
                                                  obj_ty =a (field 5 param)
                                                  obj_params =a
                                                    (field 4 param)
                                                  obj_id =a (field 3 param)
                                                  ty_id =a (field 2 param)
                                                  id =a (field 1 param)
                                                  cl =a (field 0 param))
                                                 (before typing/typeclass.ml(1666):58950-59212
                                                   (after typing/typeclass.ml(1666):58950-59212
                                                     (apply
                                                       (field 10
                                                         (global Builtin_attributes!))
                                                       0a (field 5 cl)
                                                       (function param
                                                         (funct-body typing/typeclass.ml(1667):59005-59212
                                                           (before typing/typeclass.ml(1668):59023-59206
                                                             (after typing/typeclass.ml(1668):59023-59206
                                                               (apply
                                                                 class_infos
                                                                 define_class
                                                                 kind
                                                                 (makeblock 0
                                                                   cl id
                                                                   ty_id
                                                                   obj_id
                                                                   obj_params
                                                                   obj_ty
                                                                   cl_id
                                                                   cl_params
                                                                   cl_ty
                                                                   constr_type
                                                                   dummy_class)
                                                                 (makeblock 0
                                                                   res env))))))))))))
                                         extract_type_decls =
                                           (function param decls
                                             (funct-body typing/typeclass.ml(1676)<ghost>:59237-59352
                                               (let
                                                 (req =a (field 13 param)
                                                  cl_abbr =a (field 8 param)
                                                  obj_abbr =a (field 6 param)
                                                  obj_id =a (field 5 param)
                                                  cltydef =a (field 4 param)
                                                  clty =a (field 2 param))
                                                 (before typing/typeclass.ml(1677):59296-59352
                                                   (makeblock 0
                                                     (makeblock 0 obj_id
                                                       obj_abbr cl_abbr clty
                                                       cltydef req)
                                                     decls)))))
                                         merge_type_decls =
                                           (function decl param
                                             (funct-body typing/typeclass.ml(1679)<ghost>:59375-59463
                                               (let
                                                 (cltydef =a (field 3 param)
                                                  clty =a (field 2 param)
                                                  cl_abbr =a (field 1 param)
                                                  obj_abbr =a (field 0 param))
                                                 (before typing/typeclass.ml(1680):59419-59463
                                                   (let (init = decl)
                                                     (makeblock 0 (*,*,*,*,*,*,*,*,*,int,*,*,*,*)
                                                       (field 0 init)
                                                       (field 1 init) clty
                                                       (field 3 init) cltydef
                                                       (field 5 init)
                                                       obj_abbr
                                                       (field 7 init) cl_abbr
                                                       (field 9 init)
                                                       (field 10 init)
                                                       (field 11 init)
                                                       (field 12 init)
                                                       (field 13 init)))))))
                                         final_env =
                                           (function define_class env param
                                             (funct-body typing/typeclass.ml(1682)<ghost>:59479-59967
                                               (let
                                                 (cl_abbr =a (field 8 param)
                                                  cl_id =a (field 7 param)
                                                  obj_abbr =a (field 6 param)
                                                  obj_id =a (field 5 param)
                                                  cltydef =a (field 4 param)
                                                  ty_id =a (field 3 param)
                                                  clty =a (field 2 param)
                                                  id =a (field 0 param))
                                                 (before typing/typeclass.ml(1685):59611-59967
                                                   (after typing/typeclass.ml(1685):59611-59967
                                                     (apply
                                                       (field 48
                                                         (global Env!))
                                                       1a obj_id
                                                       (after typing/typeclass.ml(1686):59647-59695
                                                         (apply
                                                           (field 14
                                                             (global Subst!))
                                                           (field 0
                                                             (global Subst!))
                                                           obj_abbr))
                                                       (after typing/typeclass.ml(1686):59696-59967
                                                         (apply
                                                           (field 48
                                                             (global Env!))
                                                           1a cl_id
                                                           (after typing/typeclass.ml(1688):59735-59782
                                                             (apply
                                                               (field 14
                                                                 (global Subst!))
                                                               (field 0
                                                                 (global Subst!))
                                                               cl_abbr))
                                                           (after typing/typeclass.ml(1688):59783-59966
                                                             (apply
                                                               (field 54
                                                                 (global Env!))
                                                               ty_id
                                                               (after typing/typeclass.ml(1689):59808-59857
                                                                 (apply
                                                                   (field 17
                                                                    (global Subst!))
                                                                   (field 0
                                                                    (global Subst!))
                                                                   cltydef))
                                                               (if
                                                                 define_class
                                                                 (before typing/typeclass.ml(1691):59887-59953
                                                                   (after typing/typeclass.ml(1691):59887-59953
                                                                    (apply
                                                                    (field 53
                                                                    (global Env!))
                                                                    id
                                                                    (after typing/typeclass.ml(1691):59904-59949
                                                                    (apply
                                                                    (field 16
                                                                    (global Subst!))
                                                                    (field 0
                                                                    (global Subst!))
                                                                    clty))
                                                                    env)))
                                                                 (before typing/typeclass.ml(1692):59961-59964
                                                                   env))))))))))))
                                         check_coercions =
                                           (function env param
                                             (funct-body typing/typeclass.ml(1695)<ghost>:60055-61268
                                               (let
                                                 (req =a (field 13 param)
                                                  coe =a (field 11 param)
                                                  pub_meths =a
                                                    (field 10 param)
                                                  arity =a (field 9 param)
                                                  cl_abbr =a (field 8 param)
                                                  cl_id =a (field 7 param)
                                                  obj_abbr =a (field 6 param)
                                                  obj_id =a (field 5 param)
                                                  cltydef =a (field 4 param)
                                                  ty_id =a (field 3 param)
                                                  clty =a (field 2 param)
                                                  id_loc =a (field 1 param)
                                                  id =a (field 0 param))
                                                 (before typing/typeclass.ml(1697):60166-61268
                                                   (seq
                                                     (if coe
                                                       (let
                                                         (loc =a
                                                            (field 0 coe))
                                                         (before typing/typeclass.ml(1699):60218-60978
                                                           (let
                                                             (*match* =
                                                                (field 4
                                                                  cl_abbr)
                                                              *match* =
                                                                (field 4
                                                                  obj_abbr)
                                                              *match* =
                                                                *match*
                                                              *match* =
                                                                *match*)
                                                             (catch
                                                               (if *match*
                                                                 (if *match*
                                                                   (let
                                                                    (obj_ab =a
                                                                    (field 0
                                                                    *match*)
                                                                    cl_ab =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1702):60352-60665
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1703):60389-60448
                                                                    (apply
                                                                    (field 51
                                                                    (global Ctype!))
                                                                    0a
                                                                    (field 0
                                                                    cl_abbr)
                                                                    cl_ab))
                                                                    cl_ty =a
                                                                    (field 1
                                                                    *match*)
                                                                    cl_params =a
                                                                    (field 0
                                                                    *match*)
                                                                    *match* =
                                                                    (after typing/typeclass.ml(1705):60500-60561
                                                                    (apply
                                                                    (field 51
                                                                    (global Ctype!))
                                                                    0a
                                                                    (field 0
                                                                    obj_abbr)
                                                                    obj_ab))
                                                                    obj_ty =a
                                                                    (field 1
                                                                    *match*)
                                                                    obj_params =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1707):60589-60665
                                                                    (seq
                                                                    (after typing/typeclass.ml(1707):60589-60638
                                                                    (apply
                                                                    (field 22
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1707):60600-60617
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env))
                                                                    cl_params
                                                                    obj_params))
                                                                    (before typing/typeclass.ml(1708):60652-60665
                                                                    (let
                                                                    (obj_ty =a
                                                                    obj_ty
                                                                    cl_ty =a
                                                                    cl_ty
                                                                    obj_ty =
                                                                    obj_ty
                                                                    cl_ty =
                                                                    cl_ty)
                                                                    (before typing/typeclass.ml(1711):60709-60978
                                                                    (seq
                                                                    (try
                                                                    (after typing/typeclass.ml(1711):60719-60752
                                                                    (apply
                                                                    (field 85
                                                                    (global Ctype!))
                                                                    env cl_ty
                                                                    obj_ty
                                                                    0a))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 3
                                                                    (global Ctype!)))
                                                                    (let
                                                                    (tr2 =a
                                                                    (field 2
                                                                    exn)
                                                                    tr1 =a
                                                                    (field 1
                                                                    exn))
                                                                    (before typing/typeclass.ml(1713):60800-60863
                                                                    (raise
                                                                    (after typing/typeclass.ml(1713):60805-60863
                                                                    (makeblock 0
                                                                    (field 22
                                                                    (global Typecore!))
                                                                    loc env
                                                                    (makeblock 23
                                                                    tr1 tr2))))))
                                                                    (reraise
                                                                    exn))))
                                                                    (before typing/typeclass.ml(1715):60881-60978
                                                                    (if
                                                                    (not
                                                                    (after typing/typeclass.ml(1715):60888-60915
                                                                    (apply
                                                                    (field 28
                                                                    (global Ctype!))
                                                                    cl_ty)))
                                                                    (before typing/typeclass.ml(1716):60929-60978
                                                                    (raise
                                                                    (after typing/typeclass.ml(1716):60934-60978
                                                                    (makeblock 0
                                                                    Error loc
                                                                    env
                                                                    (makeblock 18
                                                                    obj_ty)))))
                                                                    0a)))))))))))
                                                                   (exit 241))
                                                                 (exit 241))
                                                              with (241)
                                                               (before typing/typeclass.ml(1709):60681-60693
                                                                 (raise
                                                                   (after typing/typeclass.ml(1709):60681-60693
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/typeclass.ml"
                                                                    1709 15]))))))))
                                                       (before typing/typeclass.ml(1697):60193-60195
                                                         0a))
                                                     (before typing/typeclass.ml(1718):60988-61268
                                                       (makeblock 0 (*,*,*,*,*,*,*,*,*,int,*,*)
                                                         id id_loc clty ty_id
                                                         cltydef obj_id
                                                         obj_abbr cl_id
                                                         cl_abbr arity
                                                         pub_meths req)))))))
                                         type_classes =
                                           (function define_class approx kind
                                             env cls
                                             (funct-body typing/typeclass.ml(1733)<ghost>:61322-62401
                                               (before typing/typeclass.ml(1734):61359-62401
                                                 (let
                                                   (scope =[int]
                                                      (after typing/typeclass.ml(1734):61371-61392
                                                        (apply
                                                          (field 16
                                                            (global Ctype!))
                                                          0a)))
                                                   (before typing/typeclass.ml(1735):61398-62401
                                                     (let
                                                       (cls =
                                                          (after typing/typeclass.ml(1736):61412-61691
                                                            (apply
                                                              (field 16
                                                                (global Stdlib__list!))
                                                              (function cl
                                                                (funct-body typing/typeclass.ml(1737):61427-61681
                                                                  (before typing/typeclass.ml(1738):61452-61680
                                                                    (makeblock 0
                                                                    cl
                                                                    (after typing/typeclass.ml(1739):61467-61509
                                                                    (apply
                                                                    (field 9
                                                                    (global Ident!))
                                                                    scope
                                                                    (field 0
                                                                    (field 2
                                                                    cl))))
                                                                    (after typing/typeclass.ml(1740):61521-61563
                                                                    (apply
                                                                    (field 9
                                                                    (global Ident!))
                                                                    scope
                                                                    (field 0
                                                                    (field 2
                                                                    cl))))
                                                                    (after typing/typeclass.ml(1741):61575-61617
                                                                    (apply
                                                                    (field 9
                                                                    (global Ident!))
                                                                    scope
                                                                    (field 0
                                                                    (field 2
                                                                    cl))))
                                                                    (after typing/typeclass.ml(1742):61629-61679
                                                                    (apply
                                                                    (field 9
                                                                    (global Ident!))
                                                                    scope
                                                                    (after typing/typeclass.ml(1742):61656-61679
                                                                    (apply
                                                                    (field 27
                                                                    (global Stdlib!))
                                                                    "#"
                                                                    (field 0
                                                                    (field 2
                                                                    cl))))))))))
                                                              cls)))
                                                       (before typing/typeclass.ml(1745):61699-62401
                                                         (seq
                                                           (after typing/typeclass.ml(1745):61699-61723
                                                             (apply
                                                               (field 9
                                                                 (global Ctype!))
                                                               0a))
                                                           (before typing/typeclass.ml(1746):61727-62401
                                                             (let
                                                               (*match* =
                                                                  (after typing/typeclass.ml(1747):61748-61810
                                                                    (apply
                                                                    (field 20
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1747):61763-61796
                                                                    (apply
                                                                    initial_env
                                                                    define_class
                                                                    approx))
                                                                    (makeblock 0
                                                                    0a env)
                                                                    cls))
                                                                env =a
                                                                  (field 1
                                                                    *match*)
                                                                res =a
                                                                  (field 0
                                                                    *match*))
                                                               (before typing/typeclass.ml(1749):61818-62401
                                                                 (let
                                                                   (*match* =
                                                                    (after typing/typeclass.ml(1750):61839-61900
                                                                    (apply
                                                                    (field 21
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1750):61855-61886
                                                                    (apply
                                                                    class_infos
                                                                    define_class
                                                                    kind))
                                                                    res
                                                                    (makeblock 0
                                                                    0a env)))
                                                                    env =a
                                                                    (field 1
                                                                    *match*)
                                                                    res =a
                                                                    (field 0
                                                                    *match*))
                                                                   (before typing/typeclass.ml(1752):61908-62401
                                                                    (seq
                                                                    (after typing/typeclass.ml(1752):61908-61924
                                                                    (apply
                                                                    (field 8
                                                                    (global Ctype!))
                                                                    0a))
                                                                    (before typing/typeclass.ml(1753):61928-62401
                                                                    (let
                                                                    (res =
                                                                    (after typing/typeclass.ml(1753):61938-61984
                                                                    (apply
                                                                    (field 18
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1753):61951-61980
                                                                    (apply
                                                                    final_decl
                                                                    env
                                                                    define_class))
                                                                    res)))
                                                                    (before typing/typeclass.ml(1754):61990-62401
                                                                    (let
                                                                    (decls =
                                                                    (after typing/typeclass.ml(1754):62002-62043
                                                                    (apply
                                                                    (field 21
                                                                    (global Stdlib__list!))
                                                                    extract_type_decls
                                                                    res 0a)))
                                                                    (before typing/typeclass.ml(1755):62049-62401
                                                                    (let
                                                                    (decls =
                                                                    (try
                                                                    (after typing/typeclass.ml(1756):62069-62115
                                                                    (apply
                                                                    (field 7
                                                                    (global Typedecl_variance!))
                                                                    env
                                                                    decls))
                                                                    with exn
                                                                    (let
                                                                    (tag =a
                                                                    (field 0
                                                                    exn))
                                                                    (if
                                                                    (== tag
                                                                    (field 3
                                                                    (global Typedecl_variance!)))
                                                                    (let
                                                                    (err =a
                                                                    (field 2
                                                                    exn)
                                                                    loc =a
                                                                    (field 1
                                                                    exn))
                                                                    (before typing/typeclass.ml(1758):62168-62218
                                                                    (raise
                                                                    (after typing/typeclass.ml(1758):62174-62218
                                                                    (makeblock 0
                                                                    (field 12
                                                                    (global Typedecl!))
                                                                    loc
                                                                    (makeblock 16
                                                                    err))))))
                                                                    (reraise
                                                                    exn)))))
                                                                    (before typing/typeclass.ml(1760):62226-62401
                                                                    (let
                                                                    (res =
                                                                    (after typing/typeclass.ml(1760):62236-62272
                                                                    (apply
                                                                    (field 23
                                                                    (global Stdlib__list!))
                                                                    merge_type_decls
                                                                    res
                                                                    decls)))
                                                                    (before typing/typeclass.ml(1761):62278-62401
                                                                    (let
                                                                    (env =
                                                                    (after typing/typeclass.ml(1761):62288-62335
                                                                    (apply
                                                                    (field 20
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1761):62303-62327
                                                                    (apply
                                                                    final_env
                                                                    define_class))
                                                                    env res)))
                                                                    (before typing/typeclass.ml(1762):62341-62401
                                                                    (let
                                                                    (res =
                                                                    (after typing/typeclass.ml(1762):62351-62385
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (after typing/typeclass.ml(1762):62360-62381
                                                                    (apply
                                                                    check_coercions
                                                                    env))
                                                                    res)))
                                                                    (before typing/typeclass.ml(1763):62391-62401
                                                                    (makeblock 0
                                                                    res env))))))))))))))))))))))))))))
                                         class_num = (makemutable 0 (int) 0)
                                         class_declaration =
                                           (function env sexpr
                                             (funct-body typing/typeclass.ml(1766)<ghost>:62447-62567
                                               (before typing/typeclass.ml(1767):62461-62567
                                                 (seq (+:=1 class_num)
                                                   (before typing/typeclass.ml(1768):62479-62567
                                                     (let
                                                       (expr =
                                                          (after typing/typeclass.ml(1768):62490-62541
                                                            (apply class_expr
                                                              (after typing/typeclass.ml(1768):62501-62527
                                                                (apply
                                                                  (field 9
                                                                    (global Stdlib__int!))
                                                                  (field 0
                                                                    class_num)))
                                                              env env sexpr)))
                                                       (before typing/typeclass.ml(1769):62547-62567
                                                         (makeblock 0 expr
                                                           (field 2 expr)))))))))
                                         class_description =
                                           (function env sexpr
                                             (funct-body typing/typeclass.ml(1771)<ghost>:62591-62665
                                               (before typing/typeclass.ml(1772):62605-62665
                                                 (let
                                                   (expr =
                                                      (after typing/typeclass.ml(1772):62616-62636
                                                        (apply class_type env
                                                          sexpr)))
                                                   (before typing/typeclass.ml(1773):62642-62665
                                                     (makeblock 0 expr
                                                       (field 1 expr)))))))
                                         class_declarations =
                                           (function env cls
                                             (funct-body typing/typeclass.ml(1775)<ghost>:62690-62971
                                               (before typing/typeclass.ml(1776):62702-62971
                                                 (let
                                                   (*match* =
                                                      (after typing/typeclass.ml(1777):62722-62784
                                                        (apply type_classes
                                                          1a
                                                          approx_declaration
                                                          class_declaration
                                                          env cls))
                                                    env =a (field 1 *match*)
                                                    info =a (field 0 *match*))
                                                   (before typing/typeclass.ml(1779):62792-62971
                                                     (let
                                                       (*match* =
                                                          (after typing/typeclass.ml(1780):62813-62906
                                                            (apply
                                                              (field 46
                                                                (global Stdlib__list!))
                                                              (after typing/typeclass.ml(1781):62830-62906
                                                                (apply
                                                                  (field 16
                                                                    (global Stdlib__list!))
                                                                  (function
                                                                    ci
                                                                    (funct-body typing/typeclass.ml(1782):62849-62891
                                                                    (before typing/typeclass.ml(1782):62860-62890
                                                                    (makeblock 0
                                                                    (field 0
                                                                    ci)
                                                                    (field 7
                                                                    (field 11
                                                                    ci))))))
                                                                  info))))
                                                        exprs =a
                                                          (field 1 *match*)
                                                        ids =a
                                                          (field 0 *match*))
                                                       (before typing/typeclass.ml(1785):62914-62971
                                                         (seq
                                                           (after typing/typeclass.ml(1785):62914-62958
                                                             (apply
                                                               (field 33
                                                                 (global Typecore!))
                                                               env ids exprs))
                                                           (before typing/typeclass.ml(1786):62962-62971
                                                             (makeblock 0
                                                               info env))))))))))
                                         class_descriptions =
                                           (function env cls
                                             (funct-body typing/typeclass.ml(1788)<ghost>:62996-63070
                                               (before typing/typeclass.ml(1789):63008-63070
                                                 (after typing/typeclass.ml(1789):63008-63070
                                                   (apply type_classes 1a
                                                     approx_description
                                                     class_description env
                                                     cls)))))
                                         class_type_declarations =
                                           (function env cls
                                             (funct-body typing/typeclass.ml(1791)<ghost>:63100-63590
                                               (before typing/typeclass.ml(1792):63112-63590
                                                 (let
                                                   (*match* =
                                                      (after typing/typeclass.ml(1793):63135-63198
                                                        (apply type_classes
                                                          0a
                                                          approx_description
                                                          class_description
                                                          env cls))
                                                    env =a (field 1 *match*)
                                                    decls =a
                                                      (field 0 *match*))
                                                   (before typing/typeclass.ml(1795):63206-63590
                                                     (makeblock 0
                                                       (after typing/typeclass.ml(1795):63207-63581
                                                         (apply
                                                           (field 16
                                                             (global Stdlib__list!))
                                                           (function decl
                                                             (funct-body typing/typeclass.ml(1796):63221-63570
                                                               (before typing/typeclass.ml(1797):63242-63569
                                                                 (makeblock 0
                                                                   (field 3
                                                                    decl)
                                                                   (field 1
                                                                    decl)
                                                                   (field 4
                                                                    decl)
                                                                   (field 5
                                                                    decl)
                                                                   (field 6
                                                                    decl)
                                                                   (field 7
                                                                    decl)
                                                                   (field 8
                                                                    decl)
                                                                   (field 11
                                                                    decl)))))
                                                           decls))
                                                       env)))))))
                                        (letrec
                                          (unify_parents
                                             (function env ty cl
                                               (funct-body typing/typeclass.ml(1808)<ghost>:63614-64144
                                                 (before typing/typeclass.ml(1809):63628-64144
                                                   (let
                                                     (*match* = (field 0 cl))
                                                     (catch
                                                       (catch
                                                         (catch
                                                           (switch* *match*
                                                            case tag 0:
                                                             (let
                                                               (p =a
                                                                  (field 0
                                                                    *match*))
                                                               (before typing/typeclass.ml(1811):63683-63928
                                                                 (try
                                                                   (let
                                                                    (decl =
                                                                    (after typing/typeclass.ml(1812):63712-63732
                                                                    (apply
                                                                    (field 16
                                                                    (global Env!))
                                                                    p env)))
                                                                    (before typing/typeclass.ml(1813):63744-63854
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1813):63758-63802
                                                                    (apply
                                                                    (field 34
                                                                    (global Ctype!))
                                                                    env
                                                                    (field 2
                                                                    decl)))
                                                                    body =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1814):63814-63854
                                                                    (after typing/typeclass.ml(1814):63814-63854
                                                                    (apply
                                                                    (field 66
                                                                    (global Ctype!))
                                                                    env ty
                                                                    (after typing/typeclass.ml(1814):63833-63854
                                                                    (apply
                                                                    (field 46
                                                                    (global Ctype!))
                                                                    0a body))))))))
                                                                  with _exn
                                                                   (if
                                                                    (== _exn
                                                                    (field 7
                                                                    (global Stdlib!)))
                                                                    (before typing/typeclass.ml(1816):63887-63889
                                                                    0a)
                                                                    (before typing/typeclass.ml(1817):63906-63918
                                                                    (raise
                                                                    (after typing/typeclass.ml(1817):63906-63918
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/typeclass.ml"
                                                                    1817 16]))))))))
                                                            case tag 1:
                                                             (let
                                                               (st =a
                                                                  (field 0
                                                                    *match*))
                                                               (before typing/typeclass.ml(1819):63953-63983
                                                                 (after typing/typeclass.ml(1819):63953-63983
                                                                   (apply
                                                                    unify_parents_struct
                                                                    env ty
                                                                    st))))
                                                            case tag 2:
                                                             (exit 267)
                                                            case tag 3:
                                                             (exit 268)
                                                            case tag 4:
                                                             (exit 267)
                                                            case tag 5:
                                                             (exit 268)
                                                            case tag 6:
                                                             (let
                                                               (cl =a
                                                                  (field 1
                                                                    *match*))
                                                               (exit 266 cl)))
                                                          with (267)
                                                           (let
                                                             (cl =a
                                                                (field 3
                                                                  *match*))
                                                             (exit 266 cl)))
                                                        with (268)
                                                         (let
                                                           (cl =a
                                                              (field 0
                                                                *match*))
                                                           (exit 266 cl)))
                                                      with (266 cl)
                                                       (before typing/typeclass.ml(1824):64121-64144
                                                         (after typing/typeclass.ml(1824):64121-64144
                                                           (apply
                                                             unify_parents
                                                             env ty cl))))))))
                                            unify_parents_struct
                                              (function env ty st
                                                (funct-body typing/typeclass.ml(1825)<ghost>:64170-64329
                                                  (before typing/typeclass.ml(1826):64184-64329
                                                    (after typing/typeclass.ml(1826):64184-64329
                                                      (apply
                                                        (field 14
                                                          (global Stdlib__list!))
                                                        (function param
                                                          (funct-body typing/typeclass.ml(1827):64198-64310
                                                            (let
                                                              (*match* =a
                                                                 (field 0
                                                                   param))
                                                              (switch *match*
                                                               case tag 0:
                                                                (let
                                                                  (cl =a
                                                                    (field 1
                                                                    *match*))
                                                                  (before typing/typeclass.ml(1829):64270-64293
                                                                    (after typing/typeclass.ml(1829):64270-64293
                                                                    (apply
                                                                    unify_parents
                                                                    env ty
                                                                    cl))))
                                                               default:
                                                                (before typing/typeclass.ml(1830):64307-64309
                                                                  0a)))))
                                                        (field 1 st)))))))
                                          (let
                                            (type_object =
                                               (function env loc s
                                                 (funct-body typing/typeclass.ml(1833)<ghost>:64347-64744
                                                   (before typing/typeclass.ml(1834):64361-64744
                                                     (seq (+:=1 class_num)
                                                       (before typing/typeclass.ml(1835):64379-64744
                                                         (let
                                                           (*match* =
                                                              (after typing/typeclass.ml(1836):64402-64463
                                                                (apply
                                                                  class_structure
                                                                  (after typing/typeclass.ml(1836):64418-64444
                                                                    (apply
                                                                    (field 9
                                                                    (global Stdlib__int!))
                                                                    (field 0
                                                                    class_num)))
                                                                  1a env env
                                                                  loc s))
                                                            sign =a
                                                              (field 1
                                                                *match*)
                                                            desc =a
                                                              (field 0
                                                                *match*))
                                                           (before typing/typeclass.ml(1837):64469-64744
                                                             (let
                                                               (sty =
                                                                  (after typing/typeclass.ml(1837):64479-64515
                                                                    (apply
                                                                    (field 60
                                                                    (global Ctype!))
                                                                    env
                                                                    (field 0
                                                                    sign))))
                                                               (before typing/typeclass.ml(1838):64521-64744
                                                                 (seq
                                                                   (after typing/typeclass.ml(1838):64521-64551
                                                                    (apply
                                                                    (field 33
                                                                    (global Ctype!))
                                                                    sty))
                                                                   (before typing/typeclass.ml(1839):64555-64744
                                                                    (let
                                                                    (*match* =
                                                                    (after typing/typeclass.ml(1839):64573-64619
                                                                    (apply
                                                                    (field 26
                                                                    (global Ctype!))
                                                                    (after typing/typeclass.ml(1839):64594-64619
                                                                    (apply
                                                                    (field 25
                                                                    (global Ctype!))
                                                                    sty))))
                                                                    fields =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/typeclass.ml(1840):64625-64744
                                                                    (let
                                                                    (meths =
                                                                    (after typing/typeclass.ml(1840):64637-64671
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    param
                                                                    (funct-body typing/typeclass.ml(1840):64646-64664
                                                                    (let
                                                                    (s =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1840):64662-64663
                                                                    s))))
                                                                    fields)))
                                                                    (before typing/typeclass.ml(1841):64677-64744
                                                                    (seq
                                                                    (after typing/typeclass.ml(1841):64677-64721
                                                                    (apply
                                                                    unify_parents_struct
                                                                    env
                                                                    (field 0
                                                                    sign)
                                                                    desc))
                                                                    (before typing/typeclass.ml(1842):64725-64744
                                                                    (makeblock 0
                                                                    desc sign
                                                                    meths))))))))))))))))))
                                             *match* =
                                               (setfield_ptr 0
                                                 (field 28
                                                   (global Typecore!))
                                                 type_object)
                                             approx_class =
                                               (function sdecl
                                                 (funct-body typing/typeclass.ml(1850)<ghost>:64921-65094
                                                   (before typing/typeclass.ml(1851):64931-65094
                                                     (let
                                                       (self' =
                                                          (after typing/typeclass.ml(1852):64968-64978
                                                            (apply
                                                              (field 2
                                                                (field 4
                                                                  (global Ast_helper!)))
                                                              0a 0a 0a)))
                                                       (before typing/typeclass.ml(1853):64984-65094
                                                         (let
                                                           (clty' =
                                                              (after typing/typeclass.ml(1853):64996-65057
                                                                (apply
                                                                  (field 3
                                                                    (field 21
                                                                    (global Ast_helper!)))
                                                                  (makeblock 0
                                                                    (field 1
                                                                    (field 3
                                                                    sdecl)))
                                                                  0a
                                                                  (after typing/typeclass.ml(1853):65039-65057
                                                                    (apply
                                                                    (field 0
                                                                    (field 26
                                                                    (global Ast_helper!)))
                                                                    self' 0a)))))
                                                           (before typing/typeclass.ml(1854):65063-65094
                                                             (let
                                                               (init = sdecl)
                                                               (makeblock 0
                                                                 (field 0
                                                                   init)
                                                                 (field 1
                                                                   init)
                                                                 (field 2
                                                                   init)
                                                                 clty'
                                                                 (field 4
                                                                   init)
                                                                 (field 5
                                                                   init))))))))))
                                             approx_class_declarations =
                                               (function env sdecls
                                                 (funct-body typing/typeclass.ml(1856)<ghost>:65126-65205
                                                   (before typing/typeclass.ml(1857):65141-65205
                                                     (field 0
                                                       (after typing/typeclass.ml(1857):65145-65205
                                                         (apply
                                                           class_type_declarations
                                                           env
                                                           (after typing/typeclass.ml(1857):65174-65204
                                                             (apply
                                                               (field 16
                                                                 (global Stdlib__list!))
                                                               approx_class
                                                               sdecls))))))))
                                             report_error =
                                               (function env ppf param
                                                 (funct-body typing/typeclass.ml(1865)<ghost>:65292-72295
                                                   (switch* param
                                                    case int 0:
                                                     (before typing/typeclass.ml(1867):65343-65394
                                                       (after typing/typeclass.ml(1867):65343-65394
                                                         (apply
                                                           (field 122
                                                             (global Stdlib__format!))
                                                           ppf
                                                           [0:
                                                            [11:
                                                             "A type parameter occurs several times"
                                                             0a]
                                                            "A type parameter occurs several times"])))
                                                    case tag 0:
                                                     (let
                                                       (trace =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(1869):65438-65653
                                                         (seq
                                                           (after typing/typeclass.ml(1869):65438-65495
                                                             (apply
                                                               (field 122
                                                                 (global Stdlib__format!))
                                                               ppf
                                                               [0:
                                                                [11:
                                                                 "The class constraints are not consistent."
                                                                 [17: 4a 0a]]
                                                                "The class constraints are not consistent.@."]))
                                                           (before typing/typeclass.ml(1870):65503-65653
                                                             (after typing/typeclass.ml(1870):65503-65653
                                                               (apply
                                                                 (field 45
                                                                   (global Printtyp!))
                                                                 ppf env
                                                                 trace 0a
                                                                 (function
                                                                   ppf
                                                                   (funct-body typing/typeclass.ml(1871):65559-65590
                                                                    (before typing/typeclass.ml(1871):65571-65589
                                                                    (after typing/typeclass.ml(1871):65571-65589
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "Type" 0a]
                                                                    "Type"])))))
                                                                 (function
                                                                   ppf
                                                                   (funct-body typing/typeclass.ml(1872):65599-65653
                                                                    (before typing/typeclass.ml(1872):65611-65652
                                                                    (after typing/typeclass.ml(1872):65611-65652
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "is not compatible with type"
                                                                    0a]
                                                                    "is not compatible with type"])))))))))))
                                                    case tag 1:
                                                     (let
                                                       (trace =a
                                                          (field 2 param)
                                                        m =a (field 1 param)
                                                        k =a (field 0 param))
                                                       (before typing/typeclass.ml(1874):65701-65903
                                                         (after typing/typeclass.ml(1874):65701-65903
                                                           (apply
                                                             (field 45
                                                               (global Printtyp!))
                                                             ppf env trace 0a
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(1875):65757-65823
                                                                 (before typing/typeclass.ml(1876):65785-65822
                                                                   (after typing/typeclass.ml(1876):65785-65822
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "The "
                                                                    [2:
                                                                    0a
                                                                    [12:
                                                                    ' '
                                                                    [2:
                                                                    0a
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "has type"
                                                                    0a]]]]]]
                                                                    "The %s %s@ has type"]
                                                                    k m)))))
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(1877):65832-65903
                                                                 (before typing/typeclass.ml(1878):65860-65902
                                                                   (after typing/typeclass.ml(1878):65860-65902
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "but is expected to have type"
                                                                    0a]
                                                                    "but is expected to have type"])))))))))
                                                    case tag 2:
                                                     (let
                                                       (clty =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(1880):65941-66063
                                                         (after typing/typeclass.ml(1880):65941-66063
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "This class expression is not a class structure; it has type"
                                                                [17:
                                                                 [0:
                                                                  "@ " 1 0]
                                                                 [15:
                                                                  [17: 0a 0a]]]]]
                                                              "@[This class expression is not a class structure; it has type@ %a@]"]
                                                             (field 37
                                                               (global Printtyp!))
                                                             clty))))
                                                    case tag 3:
                                                     (before typing/typeclass.ml(1884):66092-66181
                                                       (after typing/typeclass.ml(1884):66092-66181
                                                         (apply
                                                           (field 122
                                                             (global Stdlib__format!))
                                                           ppf
                                                           [0:
                                                            [11:
                                                             "This class expression is not a class function, it cannot be applied"
                                                             0a]
                                                            "This class expression is not a class function, it cannot be applied"])))
                                                    case tag 4:
                                                     (let
                                                       (l =a (field 0 param))
                                                       (before typing/typeclass.ml(1887):66215-66416
                                                         (let
                                                           (mark_label =
                                                              (function l
                                                                (funct-body typing/typeclass.ml(1887):66232-66339
                                                                  (if
                                                                    (isint l)
                                                                    (before typing/typeclass.ml(1888):66262-66273
                                                                    "out label")
                                                                    (before typing/typeclass.ml(1889):66290-66339
                                                                    (after typing/typeclass.ml(1889):66290-66339
                                                                    (apply
                                                                    (field 125
                                                                    (global Stdlib__format!))
                                                                    [0:
                                                                    [11:
                                                                    " label "
                                                                    [2:
                                                                    0a 0a]]
                                                                    " label %s"]
                                                                    (after typing/typeclass.ml(1889):66310-66339
                                                                    (apply
                                                                    (field 54
                                                                    (global Btype!))
                                                                    l)))))))))
                                                           (before typing/typeclass.ml(1890):66349-66416
                                                             (after typing/typeclass.ml(1890):66349-66416
                                                               (apply
                                                                 (field 122
                                                                   (global Stdlib__format!))
                                                                 ppf
                                                                 [0:
                                                                  [11:
                                                                   "This argument cannot be applied with"
                                                                   [2: 0a 0a]]
                                                                  "This argument cannot be applied with%s"]
                                                                 (after typing/typeclass.ml(1890):66402-66416
                                                                   (apply
                                                                    mark_label
                                                                    l))))))))
                                                    case tag 5:
                                                     (let
                                                       (ty =a (field 0 param))
                                                       (before typing/typeclass.ml(1894):66538-66705
                                                         (seq
                                                           (after typing/typeclass.ml(1894):66538-66570
                                                             (apply
                                                               (field 14
                                                                 (global Printtyp!))
                                                               ty))
                                                           (before typing/typeclass.ml(1895):66578-66705
                                                             (after typing/typeclass.ml(1895):66578-66705
                                                               (apply
                                                                 (field 122
                                                                   (global Stdlib__format!))
                                                                 ppf
                                                                 [0:
                                                                  [18:
                                                                   [1:
                                                                    [0:
                                                                    0a ""]]
                                                                   [2:
                                                                    0a
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [15:
                                                                    [17:
                                                                    0a 0a]]]]]
                                                                  "@[%s@ %a@]"]
                                                                 "This pattern cannot match self: it only matches values of type"
                                                                 (field 16
                                                                   (global Printtyp!))
                                                                 ty))))))
                                                    case tag 6:
                                                     (let
                                                       (cl =a (field 0 param))
                                                       (before typing/typeclass.ml(1899):66738-66828
                                                         (after typing/typeclass.ml(1899):66738-66828
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "The class"
                                                                [17:
                                                                 [0:
                                                                  "@ " 1 0]
                                                                 [15:
                                                                  [17:
                                                                   [0:
                                                                    "@ " 1 0]
                                                                   [11:
                                                                    "is not yet completely defined"
                                                                    [17:
                                                                    0a 0a]]]]]]]
                                                              "@[The class@ %a@ is not yet completely defined@]"]
                                                             (field 0
                                                               (global Printtyp!))
                                                             cl))))
                                                    case tag 7:
                                                     (let
                                                       (cl =a (field 0 param))
                                                       (before typing/typeclass.ml(1902):66866-66961
                                                         (after typing/typeclass.ml(1902):66866-66961
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "The class type"
                                                                [17:
                                                                 [0:
                                                                  "@ " 1 0]
                                                                 [15:
                                                                  [17:
                                                                   [0:
                                                                    "@ " 1 0]
                                                                   [11:
                                                                    "is not yet completely defined"
                                                                    [17:
                                                                    0a 0a]]]]]]]
                                                              "@[The class type@ %a@ is not yet completely defined@]"]
                                                             (field 0
                                                               (global Printtyp!))
                                                             cl))))
                                                    case tag 8:
                                                     (let
                                                       (expected =a
                                                          (field 2 param)
                                                        actual =a
                                                          (field 1 param)
                                                        abbrev =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(1906):67074-67432
                                                         (seq
                                                           (after typing/typeclass.ml(1906):67074-67135
                                                             (apply
                                                               (field 15
                                                                 (global Printtyp!))
                                                               (makeblock 0
                                                                 abbrev
                                                                 (makeblock 0
                                                                   actual
                                                                   (makeblock 0
                                                                    expected
                                                                    0a)))))
                                                           (before typing/typeclass.ml(1907):67143-67432
                                                             (after typing/typeclass.ml(1907):67143-67432
                                                               (apply
                                                                 (field 122
                                                                   (global Stdlib__format!))
                                                                 ppf
                                                                 [0:
                                                                  [18:
                                                                   [1:
                                                                    [0:
                                                                    0a ""]]
                                                                   [11:
                                                                    "The abbreviation"
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [15:
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "expands to type"
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [15:
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "but is used with type"
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [15:
                                                                    [17:
                                                                    0a 0a]]]]]]]]]]]]]
                                                                  "@[The abbreviation@ %a@ expands to type@ %a@ but is used with type@ %a@]"]
                                                                 (field 0
                                                                   (field 2
                                                                    (global Oprint!)))
                                                                 (after typing/typeclass.ml(1909):67264-67302
                                                                   (apply
                                                                    (field 35
                                                                    (global Printtyp!))
                                                                    0a
                                                                    abbrev))
                                                                 (field 0
                                                                   (field 2
                                                                    (global Oprint!)))
                                                                 (after typing/typeclass.ml(1910):67328-67366
                                                                   (apply
                                                                    (field 35
                                                                    (global Printtyp!))
                                                                    0a
                                                                    actual))
                                                                 (field 0
                                                                   (field 2
                                                                    (global Oprint!)))
                                                                 (after typing/typeclass.ml(1911):67392-67432
                                                                   (apply
                                                                    (field 35
                                                                    (global Printtyp!))
                                                                    0a
                                                                    expected))))))))
                                                    case tag 9:
                                                     (let
                                                       (trace =a
                                                          (field 1 param)
                                                        c =a (field 0 param))
                                                       (before typing/typeclass.ml(1913):67483-67691
                                                         (after typing/typeclass.ml(1913):67483-67691
                                                           (apply
                                                             (field 45
                                                               (global Printtyp!))
                                                             ppf env trace 0a
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(1914):67539-67618
                                                                 (before typing/typeclass.ml(1915):67567-67617
                                                                   (after typing/typeclass.ml(1915):67567-67617
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "The expression \"new "
                                                                    [2:
                                                                    0a
                                                                    [11:
                                                                    "\" has type"
                                                                    0a]]]
                                                                    "The expression \"new %s\" has type"]
                                                                    c)))))
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(1916):67627-67691
                                                                 (before typing/typeclass.ml(1917):67655-67690
                                                                   (after typing/typeclass.ml(1917):67655-67690
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "but is used with type"
                                                                    0a]
                                                                    "but is used with type"])))))))))
                                                    case tag 10:
                                                     (let
                                                       (vals =a
                                                          (field 3 param)
                                                        mets =a
                                                          (field 2 param)
                                                        imm =a
                                                          (field 1 param)
                                                        cl =a (field 0 param))
                                                       (before typing/typeclass.ml(1919):67741-68356
                                                         (let
                                                           (print_mets =
                                                              (function ppf
                                                                mets
                                                                (funct-body typing/typeclass.ml(1919)<ghost>:67756-67830
                                                                  (before typing/typeclass.ml(1920):67775-67830
                                                                    (after typing/typeclass.ml(1920):67775-67830
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (function
                                                                    met
                                                                    (funct-body typing/typeclass.ml(1920):67785-67825
                                                                    (before typing/typeclass.ml(1920):67802-67824
                                                                    (after typing/typeclass.ml(1920):67802-67824
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [2:
                                                                    0a 0a]]
                                                                    "@ %s"]
                                                                    met)))))
                                                                    mets))))))
                                                           (before typing/typeclass.ml(1921):67840-68356
                                                             (let
                                                               (missings =
                                                                  (let
                                                                    (*match* =
                                                                    mets
                                                                    *match* =
                                                                    vals)
                                                                    (if
                                                                    *match*
                                                                    (if
                                                                    *match*
                                                                    (before typing/typeclass.ml(1925):67960-67983
                                                                    "methods and variables")
                                                                    (before typing/typeclass.ml(1924):67935-67944
                                                                    "methods"))
                                                                    (before typing/typeclass.ml(1923):67904-67915
                                                                    "variables"))))
                                                               (before typing/typeclass.ml(1927):67999-68356
                                                                 (let
                                                                   (print_msg =
                                                                    (function
                                                                    ppf
                                                                    (funct-body typing/typeclass.ml(1927)<ghost>:68013-68216
                                                                    (before typing/typeclass.ml(1928):68027-68216
                                                                    (if imm
                                                                    (before typing/typeclass.ml(1928):68039-68088
                                                                    (after typing/typeclass.ml(1928):68039-68088
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "This object has virtual "
                                                                    [2:
                                                                    0a 0a]]
                                                                    "This object has virtual %s"]
                                                                    missings)))
                                                                    (before typing/typeclass.ml(1929):68102-68216
                                                                    (if cl
                                                                    (before typing/typeclass.ml(1929):68113-68155
                                                                    (after typing/typeclass.ml(1929):68113-68155
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "This class should be virtual"
                                                                    0a]
                                                                    "This class should be virtual"])))
                                                                    (before typing/typeclass.ml(1930):68169-68216
                                                                    (after typing/typeclass.ml(1930):68169-68216
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "This class type should be virtual"
                                                                    0a]
                                                                    "This class type should be virtual"]))))))))))
                                                                   (before typing/typeclass.ml(1932):68232-68356
                                                                    (after typing/typeclass.ml(1932):68232-68356
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [18:
                                                                    [1:
                                                                    [0:
                                                                    0a ""]]
                                                                    [16:
                                                                    [12:
                                                                    '.'
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [18:
                                                                    [1:
                                                                    [0:
                                                                    [11:
                                                                    "<2>" 0a]
                                                                    "<2>"]]
                                                                    [11:
                                                                    "The following "
                                                                    [2:
                                                                    0a
                                                                    [11:
                                                                    " are undefined :"
                                                                    [15:
                                                                    [17:
                                                                    0a
                                                                    [17:
                                                                    0a 0a]]]]]]]]]]]
                                                                    "@[%t.@ @[<2>The following %s are undefined :%a@]@]"]
                                                                    print_msg
                                                                    missings
                                                                    print_mets
                                                                    (after typing/typeclass.ml(1934):68343-68356
                                                                    (apply
                                                                    (field 36
                                                                    (global Stdlib!))
                                                                    mets
                                                                    vals))))))))))))
                                                    case tag 11:
                                                     (let
                                                       (provided =a
                                                          (field 2 param)
                                                        expected =a
                                                          (field 1 param)
                                                        lid =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(1936):68420-68606
                                                         (after typing/typeclass.ml(1936):68420-68606
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "The class constructor "
                                                                [15:
                                                                 [17:
                                                                  [0:
                                                                   "@ " 1 0]
                                                                  [11:
                                                                   "expects "
                                                                   [4:
                                                                    3a 0a 0a
                                                                    [11:
                                                                    " type argument(s),"
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "but is here applied to "
                                                                    [4:
                                                                    3a 0a 0a
                                                                    [11:
                                                                    " type argument(s)"
                                                                    [17:
                                                                    0a 0a]]]]]]]]]]]]
                                                              "@[The class constructor %a@ expects %i type argument(s),@ but is here applied to %i type argument(s)@]"]
                                                             (field 0
                                                               (global Printtyp!))
                                                             lid expected
                                                             provided))))
                                                    case tag 12:
                                                     (let
                                                       (trace =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(1941):68645-68856
                                                         (after typing/typeclass.ml(1941):68645-68856
                                                           (apply
                                                             (field 45
                                                               (global Printtyp!))
                                                             ppf env trace 0a
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(1942):68701-68762
                                                                 (before typing/typeclass.ml(1943):68729-68761
                                                                   (after typing/typeclass.ml(1943):68729-68761
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "The type parameter"
                                                                    0a]
                                                                    "The type parameter"])))))
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(1944):68771-68856
                                                                 (before typing/typeclass.ml(1945):68799-68855
                                                                   (after typing/typeclass.ml(1945):68799-68855
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "does not meet its constraint: it should be"
                                                                    0a]
                                                                    "does not meet its constraint: it should be"])))))))))
                                                    case tag 13:
                                                     (let
                                                       (cstrs =a
                                                          (field 2 param)
                                                        params =a
                                                          (field 1 param)
                                                        id =a (field 0 param))
                                                       (before typing/typeclass.ml(1947):68905-69248
                                                         (seq
                                                           (after typing/typeclass.ml(1947):68905-68955
                                                             (apply
                                                               (field 15
                                                                 (global Printtyp!))
                                                               (makeblock 0
                                                                 params
                                                                 (makeblock 0
                                                                   cstrs 0a))))
                                                           (before typing/typeclass.ml(1948):68963-69248
                                                             (after typing/typeclass.ml(1948):68963-69248
                                                               (apply
                                                                 (field 122
                                                                   (global Stdlib__format!))
                                                                 ppf
                                                                 [0:
                                                                  [18:
                                                                   [1:
                                                                    [0:
                                                                    0a ""]]
                                                                   [11:
                                                                    "The abbreviation "
                                                                    [15:
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "is used with parameters"
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [15:
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "which are incompatible with constraints"
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [15:
                                                                    [17:
                                                                    0a 0a]]]]]]]]]]]]
                                                                  "@[The abbreviation %a@ is used with parameters@ %a@ which are incompatible with constraints@ %a@]"]
                                                                 (field 1
                                                                   (global Printtyp!))
                                                                 id
                                                                 (field 0
                                                                   (field 2
                                                                    (global Oprint!)))
                                                                 (after typing/typeclass.ml(1952):69147-69185
                                                                   (apply
                                                                    (field 35
                                                                    (global Printtyp!))
                                                                    0a
                                                                    params))
                                                                 (field 0
                                                                   (field 2
                                                                    (global Oprint!)))
                                                                 (after typing/typeclass.ml(1953):69211-69248
                                                                   (apply
                                                                    (field 35
                                                                    (global Printtyp!))
                                                                    0a cstrs))))))))
                                                    case tag 14:
                                                     (let
                                                       (error =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(1955):69288-69323
                                                         (after typing/typeclass.ml(1955):69288-69323
                                                           (apply
                                                             (field 3
                                                               (global Includeclass!))
                                                             ppf error))))
                                                    case tag 15:
                                                     (let
                                                       (lab =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(1957):69353-69399
                                                         (after typing/typeclass.ml(1957):69353-69399
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [11:
                                                               "Unbound instance variable "
                                                               [2: 0a 0a]]
                                                              "Unbound instance variable %s"]
                                                             lab))))
                                                    case tag 16:
                                                     (let
                                                       (reason =a
                                                          (field 1 param)
                                                        printer =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(1959):69448-70304
                                                         (let
                                                           (print_common =
                                                              (function ppf
                                                                kind ty0 real
                                                                lab ty
                                                                (funct-body typing/typeclass.ml(1959)<ghost>:69465-69860
                                                                  (before typing/typeclass.ml(1960):69500-69860
                                                                    (let
                                                                    (ty1 =
                                                                    (if real
                                                                    (before typing/typeclass.ml(1961):69533-69536
                                                                    ty0)
                                                                    (before typing/typeclass.ml(1961):69542-69580
                                                                    (after typing/typeclass.ml(1961):69542-69580
                                                                    (apply
                                                                    (field 5
                                                                    (global Btype!))
                                                                    (makeblock 4
                                                                    ty0
                                                                    (makemutable 0
                                                                    0a)))))))
                                                                    (before typing/typeclass.ml(1962):69592-69860
                                                                    (seq
                                                                    (after typing/typeclass.ml(1962):69592-69631
                                                                    (apply
                                                                    (field 14
                                                                    (global Stdlib__list!))
                                                                    (field 13
                                                                    (global Printtyp!))
                                                                    (makeblock 0
                                                                    ty
                                                                    (makeblock 0
                                                                    ty1 0a))))
                                                                    (before typing/typeclass.ml(1963):69641-69860
                                                                    (after typing/typeclass.ml(1963):69641-69860
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "The "
                                                                    [2:
                                                                    0a
                                                                    [12:
                                                                    ' '
                                                                    [2:
                                                                    0a
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "has type"
                                                                    [17:
                                                                    [0:
                                                                    "@;<1 2>"
                                                                    1 2]
                                                                    [15:
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "where"
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [15:
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "is unbound"
                                                                    0a]]]]]]]]]]]]]]
                                                                    "The %s %s@ has type@;<1 2>%a@ where@ %a@ is unbound"]
                                                                    kind lab
                                                                    (field 0
                                                                    (field 2
                                                                    (global Oprint!)))
                                                                    (after typing/typeclass.ml(1966):69763-69797
                                                                    (apply
                                                                    (field 35
                                                                    (global Printtyp!))
                                                                    0a ty))
                                                                    (field 0
                                                                    (field 2
                                                                    (global Oprint!)))
                                                                    (after typing/typeclass.ml(1967):69825-69860
                                                                    (apply
                                                                    (field 35
                                                                    (global Printtyp!))
                                                                    0a ty0))))))))))))
                                                           (before typing/typeclass.ml(1969):69876-70304
                                                             (let
                                                               (print_reason =
                                                                  (function
                                                                    ppf param
                                                                    (funct-body typing/typeclass.ml(1969)<ghost>:69893-70117
                                                                    (switch* param
                                                                    case tag 0:
                                                                    (let
                                                                    (ty =a
                                                                    (field 3
                                                                    param)
                                                                    lab =a
                                                                    (field 2
                                                                    param)
                                                                    real =a
                                                                    (field 1
                                                                    param)
                                                                    ty0 =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1971):69966-70007
                                                                    (after typing/typeclass.ml(1971):69966-70007
                                                                    (apply
                                                                    print_common
                                                                    ppf
                                                                    "method"
                                                                    ty0 real
                                                                    lab ty))))
                                                                    case tag 1:
                                                                    (let
                                                                    (ty =a
                                                                    (field 3
                                                                    param)
                                                                    lab =a
                                                                    (field 2
                                                                    param)
                                                                    real =a
                                                                    (field 1
                                                                    param)
                                                                    ty0 =a
                                                                    (field 0
                                                                    param))
                                                                    (before typing/typeclass.ml(1973):70065-70117
                                                                    (after typing/typeclass.ml(1973):70065-70117
                                                                    (apply
                                                                    print_common
                                                                    ppf
                                                                    "instance variable"
                                                                    ty0 real
                                                                    lab ty))))))))
                                                               (before typing/typeclass.ml(1975):70133-70304
                                                                 (seq
                                                                   (after typing/typeclass.ml(1975):70133-70150
                                                                    (apply
                                                                    (field 12
                                                                    (global Printtyp!))
                                                                    0a))
                                                                   (before typing/typeclass.ml(1976):70158-70304
                                                                    (after typing/typeclass.ml(1976):70158-70304
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [18:
                                                                    [1:
                                                                    [0:
                                                                    [11:
                                                                    "<v>" 0a]
                                                                    "<v>"]]
                                                                    [18:
                                                                    [1:
                                                                    [0:
                                                                    0a ""]]
                                                                    [11:
                                                                    "Some type variables are unbound in this type:"
                                                                    [17:
                                                                    [0:
                                                                    "@;<1 2>"
                                                                    1 2]
                                                                    [16:
                                                                    [17:
                                                                    0a
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [18:
                                                                    [1:
                                                                    [0:
                                                                    0a ""]]
                                                                    [15:
                                                                    [17:
                                                                    0a
                                                                    [17:
                                                                    0a 0a]]]]]]]]]]]
                                                                    "@[<v>@[Some type variables are unbound in this type:@;<1 2>%t@]@ @[%a@]@]"]
                                                                    printer
                                                                    print_reason
                                                                    reason))))))))))
                                                    case tag 17:
                                                     (let
                                                       (clty =a
                                                          (field 1 param)
                                                        id =a (field 0 param))
                                                       (before typing/typeclass.ml(1981):70353-70517
                                                         (after typing/typeclass.ml(1981):70353-70517
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "The type of this class,"
                                                                [17:
                                                                 [0:
                                                                  "@ " 1 0]
                                                                 [15:
                                                                  [12:
                                                                   ','
                                                                   [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "contains type variables that cannot be generalized"
                                                                    [17:
                                                                    0a 0a]]]]]]]]
                                                              "@[The type of this class,@ %a,@ contains type variables that cannot be generalized@]"]
                                                             (after typing/typeclass.ml(1984):70481-70512
                                                               (apply
                                                                 (field 39
                                                                   (global Printtyp!))
                                                                 id))
                                                             clty))))
                                                    case tag 18:
                                                     (let
                                                       (ty =a (field 0 param))
                                                       (before typing/typeclass.ml(1986):70553-70747
                                                         (after typing/typeclass.ml(1986):70553-70747
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "The type of self cannot be coerced to"
                                                                [17:
                                                                 [0:
                                                                  "@ " 1 0]
                                                                 [11:
                                                                  "the type of the current class:"
                                                                  [17:
                                                                   [0:
                                                                    "@ " 1 0]
                                                                   [15:
                                                                    [12:
                                                                    '.'
                                                                    [17:
                                                                    4a
                                                                    [11:
                                                                    "Some occurrences are contravariant"
                                                                    [17:
                                                                    0a 0a]]]]]]]]]]
                                                              "@[The type of self cannot be coerced to@ the type of the current class:@ %a.@.Some occurrences are contravariant@]"]
                                                             (field 20
                                                               (global Printtyp!))
                                                             ty))))
                                                    case tag 19:
                                                     (let
                                                       (trace =a
                                                          (field 2 param)
                                                        clty =a
                                                          (field 1 param)
                                                        id =a (field 0 param))
                                                       (before typing/typeclass.ml(1992):70807-71172
                                                         (after typing/typeclass.ml(1992):70807-71172
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "The type of this class,"
                                                                [17:
                                                                 [0:
                                                                  "@ " 1 0]
                                                                 [15:
                                                                  [12:
                                                                   ','
                                                                   [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "contains non-collapsible conjunctive types in constraints."
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [16:
                                                                    [17:
                                                                    0a 0a]]]]]]]]]]
                                                              "@[The type of this class,@ %a,@ contains non-collapsible conjunctive types in constraints.@ %t@]"]
                                                             (after typing/typeclass.ml(1995):70947-70978
                                                               (apply
                                                                 (field 39
                                                                   (global Printtyp!))
                                                                 id))
                                                             clty
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(1996):70992-71172
                                                                 (before typing/typeclass.ml(1996):71004-71162
                                                                   (after typing/typeclass.ml(1996):71004-71162
                                                                    (apply
                                                                    (field 45
                                                                    (global Printtyp!))
                                                                    ppf env
                                                                    trace 0a
                                                                    (function
                                                                    ppf
                                                                    (funct-body typing/typeclass.ml(1997):71064-71095
                                                                    (before typing/typeclass.ml(1997):71076-71094
                                                                    (after typing/typeclass.ml(1997):71076-71094
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "Type" 0a]
                                                                    "Type"])))))
                                                                    (function
                                                                    ppf
                                                                    (funct-body typing/typeclass.ml(1998):71108-71162
                                                                    (before typing/typeclass.ml(1998):71120-71161
                                                                    (after typing/typeclass.ml(1998):71120-71161
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "is not compatible with type"
                                                                    0a]
                                                                    "is not compatible with type"]))))))))))))))
                                                    case tag 20:
                                                     (let
                                                       (trace =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(2001):71209-71417
                                                         (after typing/typeclass.ml(2001):71209-71417
                                                           (apply
                                                             (field 45
                                                               (global Printtyp!))
                                                             ppf env trace 0a
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(2002):71265-71344
                                                                 (before typing/typeclass.ml(2003):71293-71343
                                                                   (after typing/typeclass.ml(2003):71293-71343
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "This object is expected to have type"
                                                                    0a]
                                                                    "This object is expected to have type"])))))
                                                             (function ppf
                                                               (funct-body typing/typeclass.ml(2004):71353-71417
                                                                 (before typing/typeclass.ml(2005):71381-71416
                                                                   (after typing/typeclass.ml(2005):71381-71416
                                                                    (apply
                                                                    (field 122
                                                                    (global Stdlib__format!))
                                                                    ppf
                                                                    [0:
                                                                    [11:
                                                                    "but actually has type"
                                                                    0a]
                                                                    "but actually has type"])))))))))
                                                    case tag 21:
                                                     (let
                                                       (mut =a
                                                          (field 1 param))
                                                       (before typing/typeclass.ml(2007):71463-71682
                                                         (catch
                                                           (if (== mut 0a)
                                                             (before typing/typeclass.ml(2008):71512-71534
                                                               (let
                                                                 (mut2 =
                                                                    "immutable"
                                                                  mut1 =
                                                                    "mutable")
                                                                 (exit 279
                                                                   mut2 mut1)))
                                                             (before typing/typeclass.ml(2009):71548-71570
                                                               (let
                                                                 (mut2 =
                                                                    "mutable"
                                                                  mut1 =
                                                                    "immutable")
                                                                 (exit 279
                                                                   mut2 mut1))))
                                                          with (279 mut2 mut1)
                                                           (before typing/typeclass.ml(2010):71580-71682
                                                             (after typing/typeclass.ml(2010):71580-71682
                                                               (apply
                                                                 (field 122
                                                                   (global Stdlib__format!))
                                                                 ppf
                                                                 [0:
                                                                  [18:
                                                                   [1:
                                                                    [0:
                                                                    0a ""]]
                                                                   [11:
                                                                    "The instance variable is "
                                                                    [2:
                                                                    0a
                                                                    [12:
                                                                    ';'
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "it cannot be redefined as "
                                                                    [2:
                                                                    0a
                                                                    [17:
                                                                    0a 0a]]]]]]]]
                                                                  "@[The instance variable is %s;@ it cannot be redefined as %s@]"]
                                                                 mut1 mut2))))))
                                                    case tag 22:
                                                     (let
                                                       (name =a
                                                          (field 1 param)
                                                        kind =a
                                                          (field 0 param))
                                                       (stringswitch name
                                                        case "":
                                                         (before typing/typeclass.ml(2014):71718-71813
                                                           (after typing/typeclass.ml(2014):71718-71813
                                                             (apply
                                                               (field 122
                                                                 (global Stdlib__format!))
                                                               ppf
                                                               [0:
                                                                [18:
                                                                 [1:
                                                                  [0: 0a ""]]
                                                                 [11:
                                                                  "This inheritance does not override any method"
                                                                  [17:
                                                                   [0:
                                                                    "@ " 1 0]
                                                                   [2:
                                                                    0a
                                                                    [17:
                                                                    0a 0a]]]]]
                                                                "@[This inheritance does not override any method@ %s@]"]
                                                               "instance variable")))
                                                        default:
                                                         (before typing/typeclass.ml(2017):71854-71921
                                                           (after typing/typeclass.ml(2017):71854-71921
                                                             (apply
                                                               (field 122
                                                                 (global Stdlib__format!))
                                                               ppf
                                                               [0:
                                                                [18:
                                                                 [1:
                                                                  [0: 0a ""]]
                                                                 [11:
                                                                  "The "
                                                                  [2:
                                                                   0a
                                                                   [11:
                                                                    " `"
                                                                    [2:
                                                                    0a
                                                                    [12:
                                                                    '\''
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "has no previous definition"
                                                                    [17:
                                                                    0a 0a]]]]]]]]]
                                                                "@[The %s `%s'@ has no previous definition@]"]
                                                               kind name)))))
                                                    case tag 23:
                                                     (let
                                                       (name =a
                                                          (field 1 param)
                                                        kind =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(2019):71958-72058
                                                         (after typing/typeclass.ml(2019):71958-72058
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "The "
                                                                [2:
                                                                 0a
                                                                 [11:
                                                                  " `"
                                                                  [2:
                                                                   0a
                                                                   [12:
                                                                    '\''
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "has multiple definitions in this object"
                                                                    [17:
                                                                    0a 0a]]]]]]]]]
                                                              "@[The %s `%s'@ has multiple definitions in this object@]"]
                                                             kind name))))
                                                    case tag 24:
                                                     (let
                                                       (self =a
                                                          (field 0 param))
                                                       (before typing/typeclass.ml(2022):72093-72295
                                                         (after typing/typeclass.ml(2022):72093-72295
                                                           (apply
                                                             (field 122
                                                               (global Stdlib__format!))
                                                             ppf
                                                             [0:
                                                              [18:
                                                               [1:
                                                                [0: 0a ""]]
                                                               [11:
                                                                "Cannot close type of object literal:"
                                                                [17:
                                                                 [0:
                                                                  "@ " 1 0]
                                                                 [15:
                                                                  [17:
                                                                   [0:
                                                                    "@," 0 0]
                                                                   [11:
                                                                    "it has been unified with the self type of a class that is not yet"
                                                                    [17:
                                                                    [0:
                                                                    "@ " 1 0]
                                                                    [11:
                                                                    "completely defined."
                                                                    [17:
                                                                    0a 0a]]]]]]]]]
                                                              "@[Cannot close type of object literal:@ %a@,it has been unified with the self type of a class that is not yet@ completely defined.@]"]
                                                             (field 20
                                                               (global Printtyp!))
                                                             self)))))))
                                             report_error =
                                               (function env ppf err
                                                 (funct-body typing/typeclass.ml(2028)<ghost>:72314-72413
                                                   (before typing/typeclass.ml(2029):72330-72413
                                                     (after typing/typeclass.ml(2029):72330-72413
                                                       (apply
                                                         (field 9
                                                           (global Printtyp!))
                                                         1a env
                                                         (function param
                                                           (funct-body typing/typeclass.ml(2030):72377-72413
                                                             (before typing/typeclass.ml(2030):72388-72412
                                                               (after typing/typeclass.ml(2030):72388-72412
                                                                 (apply
                                                                   report_error
                                                                   env ppf
                                                                   err))))))))))
                                             *match* =
                                               (after typing/typeclass.ml(2033):72426-72650
                                                 (apply
                                                   (field 46
                                                     (global Location!))
                                                   (function param
                                                     (funct-body typing/typeclass.ml(2034):72461-72650
                                                       (let
                                                         (tag =a
                                                            (field 0 param))
                                                         (if (== tag Error)
                                                           (let
                                                             (err =a
                                                                (field 3
                                                                  param)
                                                              env =a
                                                                (field 2
                                                                  param)
                                                              loc =a
                                                                (field 1
                                                                  param))
                                                             (before typing/typeclass.ml(2036):72512-72572
                                                               (makeblock 0
                                                                 (after typing/typeclass.ml(2036):72517-72572
                                                                   (apply
                                                                    (field 44
                                                                    (global Location!))
                                                                    (makeblock 0
                                                                    loc) 0a
                                                                    (after typing/typeclass.ml(2036):72549-72567
                                                                    (apply
                                                                    report_error
                                                                    env))
                                                                    err)))))
                                                           (let
                                                             (tag =a
                                                                (field 0
                                                                  param))
                                                             (if
                                                               (== tag
                                                                 Error_forward)
                                                               (let
                                                                 (err =a
                                                                    (field 1
                                                                    param))
                                                                 (before typing/typeclass.ml(2038):72610-72618
                                                                   (makeblock 0
                                                                    err)))
                                                               (before typing/typeclass.ml(2040):72640-72644
                                                                 0a))))))))))
                                            (pseudo _none_(0)<ghost>:-1--1
                                              (makeblock 0 class_declarations
                                                class_descriptions
                                                class_type_declarations
                                                approx_class_declarations
                                                virtual_methods Error
                                                Error_forward report_error
                                                type_open_descr))))))))))))))))))))))))
