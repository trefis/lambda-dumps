(setglobal Subst!
  (let
    (identity =
       (makeblock 0 (field 0 (field 13 (global Path!)))
         (field 0 (field 13 (global Path!)))
         (field 0 (field 6 (global Ident!))) 0a)
     add_type_path =
       (function id p s
         (funct-body typing/subst.ml(41)<ghost>:1553-1613
           (before typing/subst.ml(41):1562-1613
             (let (init = s)
               (makeblock 0
                 (after typing/subst.ml(41):1579-1611
                   (apply (field 3 (field 13 (global Path!))) id
                     (makeblock 0 p) (field 0 s)))
                 (field 1 init) (field 2 init) (field 3 init))))))
     add_type =
       (function id p s
         (funct-body typing/subst.ml(42)<ghost>:1627-1665
           (before typing/subst.ml(42):1636-1665
             (after typing/subst.ml(42):1636-1665
               (apply add_type_path (makeblock 0 id) p s)))))
     add_type_function =
       (function id params body s
         (funct-body typing/subst.ml(44)<ghost>:1689-1787
           (before typing/subst.ml(45):1712-1787
             (let (init = s)
               (makeblock 0
                 (after typing/subst.ml(45):1729-1785
                   (apply (field 3 (field 13 (global Path!))) id
                     (makeblock 1 params body) (field 0 s)))
                 (field 1 init) (field 2 init) (field 3 init))))))
     add_module_path =
       (function id p s
         (funct-body typing/subst.ml(47)<ghost>:1809-1866
           (before typing/subst.ml(47):1818-1866
             (let (init = s)
               (makeblock 0 (field 0 init)
                 (after typing/subst.ml(47):1837-1864
                   (apply (field 3 (field 13 (global Path!))) id p
                     (field 1 s)))
                 (field 2 init) (field 3 init))))))
     add_module =
       (function id p s
         (funct-body typing/subst.ml(48)<ghost>:1882-1922
           (before typing/subst.ml(48):1891-1922
             (after typing/subst.ml(48):1891-1922
               (apply add_module_path (makeblock 0 id) p s)))))
     add_modtype =
       (function id ty s
         (funct-body typing/subst.ml(50)<ghost>:1940-2002
           (before typing/subst.ml(50):1950-2002
             (let (init = s)
               (makeblock 0 (field 0 init) (field 1 init)
                 (after typing/subst.ml(50):1970-2000
                   (apply (field 3 (field 6 (global Ident!))) id ty
                     (field 2 s)))
                 (field 3 init))))))
     for_saving =
       (function s
         (funct-body typing/subst.ml(52)<ghost>:2019-2051
           (before typing/subst.ml(52):2023-2051
             (let (init = s)
               (makeblock 0 (field 0 init) (field 1 init) (field 2 init) 1a)))))
     loc =
       (function s x
         (funct-body typing/subst.ml(54)<ghost>:2061-2136
           (before typing/subst.ml(55):2069-2136
             (if
               (&& (field 3 s) (not (field 0 (field 129 (global Clflags!)))))
               (before typing/subst.ml(55):2116-2129
                 (field 0 (global Location!)))
               (before typing/subst.ml(55):2135-2136 x)))))
     remove_loc =
       (let (init = (field 0 (global Ast_mapper!)))
         (makeblock 0 (field 0 init) (field 1 init) (field 2 init)
           (field 3 init) (field 4 init) (field 5 init) (field 6 init)
           (field 7 init) (field 8 init) (field 9 init) (field 10 init)
           (field 11 init) (field 12 init) (field 13 init) (field 14 init)
           (field 15 init) (field 16 init) (field 17 init) (field 18 init)
           (field 19 init) (field 20 init)
           (function _this _loc
             (funct-body typing/subst.ml(59):2214-2247
               (before typing/subst.ml(59):2233-2246
                 (field 0 (global Location!)))))
           (field 22 init) (field 23 init) (field 24 init) (field 25 init)
           (field 26 init) (field 27 init) (field 28 init) (field 29 init)
           (field 30 init) (field 31 init) (field 32 init) (field 33 init)
           (field 34 init) (field 35 init) (field 36 init) (field 37 init)
           (field 38 init) (field 39 init) (field 40 init) (field 41 init)
           (field 42 init) (field 43 init)))
     is_not_doc =
       (function param
         (funct-body typing/subst.ml(61):2267-2555
           (let (*match* =a (field 0 param) *match* =a (field 0 *match*))
             (catch
               (stringswitch *match*
                case "doc": (before typing/subst.ml(64):2472-2477 0a)
                case "ocaml.doc": (before typing/subst.ml(62):2339-2344 0a)
                case "ocaml.text": (before typing/subst.ml(63):2409-2414 0a)
                case "text": (before typing/subst.ml(65):2536-2541 0a)
                default: (exit 1))
              with (1) (before typing/subst.ml(66):2551-2555 1a)))))
     attrs =
       (function s x
         (funct-body typing/subst.ml(68)<ghost>:2567-2792
           (before typing/subst.ml(69):2575-2792
             (let
               (x =
                  (if
                    (&& (field 3 s)
                      (not (field 0 (field 128 (global Clflags!)))))
                    (before typing/subst.ml(71):2640-2664
                      (after typing/subst.ml(71):2640-2664
                        (apply (field 35 (global Stdlib__list!)) is_not_doc
                          x)))
                    (before typing/subst.ml(72):2674-2675 x)))
               (before typing/subst.ml(74):2685-2792
                 (if
                   (&& (field 3 s)
                     (not (field 0 (field 129 (global Clflags!)))))
                   (before typing/subst.ml(75):2736-2781
                     (after typing/subst.ml(75):2736-2781
                       (apply (field 1 remove_loc) remove_loc x)))
                   (before typing/subst.ml(76):2791-2792 x))))))))
    (letrec
      (module_path
         (function s path
           (funct-body typing/subst.ml(78)<ghost>:2814-3046
             (before typing/subst.ml(79):2825-3046
               (try
                 (after typing/subst.ml(79):2829-2857
                   (apply (field 26 (field 13 (global Path!))) path
                     (field 1 s)))
                with exn
                 (if (== exn (field 7 (global Stdlib!)))
                   (before typing/subst.ml(81):2882-3046
                     (switch* path
                      case tag 0: (before typing/subst.ml(82):2916-2920 path)
                      case tag 1:
                       (let (n =a (field 1 path) p =a (field 0 path))
                         (before typing/subst.ml(84):2948-2972
                           (makeblock 1
                             (after typing/subst.ml(84):2953-2968
                               (apply module_path s p))
                             n)))
                      case tag 2:
                       (let (p2 =a (field 1 path) p1 =a (field 0 path))
                         (before typing/subst.ml(86):3004-3046
                           (makeblock 2
                             (after typing/subst.ml(86):3011-3027
                               (apply module_path s p1))
                             (after typing/subst.ml(86):3029-3045
                               (apply module_path s p2)))))))
                   (reraise exn)))))))
      (let
        (modtype_path =
           (function s p
             (funct-body typing/subst.ml(88)<ghost>:3065-3376
               (switch* p
                case tag 0:
                 (let (id =a (field 0 p))
                   (before typing/subst.ml(90):3106-3272
                     (try
                       (let
                         (*match* =
                            (after typing/subst.ml(91):3130-3158
                              (apply (field 26 (field 6 (global Ident!))) id
                                (field 2 s))))
                         (switch *match*
                          case tag 0:
                           (let (p =a (field 0 *match*))
                             (before typing/subst.ml(92):3191-3192 p))
                          default:
                           (before typing/subst.ml(93):3210-3242
                             (after typing/subst.ml(93):3210-3242
                               (apply (field 0 (global Misc!))
                                 "Subst.modtype_path")))))
                      with exn
                       (if (== exn (field 7 (global Stdlib!)))
                         (before typing/subst.ml(94):3267-3268 p)
                         (reraise exn)))))
                case tag 1:
                 (let (n =a (field 1 p) p =a (field 0 p))
                   (before typing/subst.ml(96):3297-3321
                     (makeblock 1
                       (after typing/subst.ml(96):3302-3317
                         (apply module_path s p))
                       n)))
                case tag 2:
                 (before typing/subst.ml(98):3344-3376
                   (after typing/subst.ml(98):3344-3376
                     (apply (field 0 (global Misc!)) "Subst.modtype_path"))))))
         type_path =
           (function s path
             (funct-body typing/subst.ml(100)<ghost>:3392-3675
               (before typing/subst.ml(101):3403-3675
                 (catch
                   (try
                     (exit 5
                       (after typing/subst.ml(101):3409-3435
                         (apply (field 26 (field 13 (global Path!))) path
                           (field 0 s))))
                    with exn
                     (if (== exn (field 7 (global Stdlib!)))
                       (before typing/subst.ml(105):3525-3675
                         (switch* path
                          case tag 0:
                           (before typing/subst.ml(106):3560-3564 path)
                          case tag 1:
                           (let (n =a (field 1 path) p =a (field 0 path))
                             (before typing/subst.ml(108):3594-3618
                               (makeblock 1
                                 (after typing/subst.ml(108):3599-3614
                                   (apply module_path s p))
                                 n)))
                          case tag 2:
                           (before typing/subst.ml(110):3646-3675
                             (after typing/subst.ml(110):3646-3675
                               (apply (field 0 (global Misc!))
                                 "Subst.type_path")))))
                       (reraise exn)))
                  with (5 val)
                   (switch* val
                    case tag 0:
                     (let (p =a (field 0 val))
                       (before typing/subst.ml(102):3455-3456 p))
                    case tag 1:
                     (before typing/subst.ml(103):3480-3492
                       (raise
                         (after typing/subst.ml(103):3480-3492
                           (makeblock 0 (global Assert_failure!)
                             [0: "typing/subst.ml" 103 23])))))))))
         type_path =
           (function s p
             (funct-body typing/subst.ml(112)<ghost>:3691-3907
               (before typing/subst.ml(113):3699-3907
                 (let
                   (*match* =
                      (after typing/subst.ml(113):3705-3730
                        (apply (field 11 (global Path!)) p)))
                   (switch* *match*
                    case tag 0:
                     (let (p =a (field 0 *match*))
                       (before typing/subst.ml(114):3753-3766
                         (after typing/subst.ml(114):3753-3766
                           (apply type_path s p))))
                    case tag 1:
                     (let (cstr =a (field 1 *match*) p =a (field 0 *match*))
                       (before typing/subst.ml(117):3880-3907
                         (makeblock 1
                           (after typing/subst.ml(117):3885-3900
                             (apply module_path s p))
                           cstr)))
                    case tag 2:
                     (before typing/subst.ml(116):3845-3858
                       (after typing/subst.ml(116):3845-3858
                         (apply type_path s p)))
                    case tag 3:
                     (let
                       (cstr =a (field 1 *match*)
                        ty_path =a (field 0 *match*))
                       (before typing/subst.ml(115):3795-3826
                         (makeblock 1
                           (after typing/subst.ml(115):3800-3819
                             (apply type_path s ty_path))
                           cstr))))))))
         to_subst_by_type_function =
           (function s p
             (funct-body typing/subst.ml(119)<ghost>:3939-4062
               (before typing/subst.ml(120):3947-4062
                 (catch
                   (try
                     (exit 7
                       (after typing/subst.ml(120):3953-3976
                         (apply (field 26 (field 13 (global Path!))) p
                           (field 0 s))))
                    with exn
                     (if (== exn (field 7 (global Stdlib!)))
                       (before typing/subst.ml(123):4057-4062 0a)
                       (reraise exn)))
                  with (7 val)
                   (switch* val
                    case tag 0: (before typing/subst.ml(121):3996-4001 0a)
                    case tag 1: (before typing/subst.ml(122):4025-4029 1a))))))
         new_id = (makemutable 0 (int) -1)
         reset_for_saving =
           (function param
             (funct-body typing/subst.ml(128)<ghost>:4152-4169
               (before typing/subst.ml(128):4157-4169
                 (setfield_imm 0 new_id -1))))
         newpersty =
           (function desc
             (funct-body typing/subst.ml(130)<ghost>:4185-4282
               (before typing/subst.ml(131):4194-4282
                 (seq (+:=-1 new_id)
                   (before typing/subst.ml(132):4209-4282
                     (makemutable 0 (*,int,int,int) desc
                       (field 3 (global Btype!)) (field 38 (global Btype!))
                       (field 0 new_id)))))))
         tvar_none = [0: 0a]
         tunivar_none = [9: 0a]
         norm =
           (function d
             (funct-body typing/subst.ml(137):4424-4503
               (catch
                 (switch d
                  case tag 0:
                   (let (*match* =a (field 0 d))
                     (if *match* (exit 9)
                       (before typing/subst.ml(138):4450-4459 tvar_none)))
                  case tag 9:
                   (let (*match* =a (field 0 d))
                     (if *match* (exit 9)
                       (before typing/subst.ml(139):4480-4492 tunivar_none)))
                  default: (exit 9))
                with (9) (before typing/subst.ml(140):4502-4503 d))))
         ctype_apply_env_empty =
           (makemutable 0
             (function param
               (funct-body typing/subst.ml(142):4537-4560
                 (before typing/subst.ml(142):4547-4559
                   (raise
                     (after typing/subst.ml(142):4547-4559
                       (makeblock 0 (global Assert_failure!)
                         [0: "typing/subst.ml" 142 42]))))))))
        (letrec
          (typexp
             (function copy_scope s ty
               (funct-body typing/subst.ml(145)<ghost>:4619-8869
                 (before typing/subst.ml(146):4639-8869
                   (let
                     (ty =
                        (after typing/subst.ml(146):4648-4655
                          (apply (field 12 (global Btype!)) ty)))
                     (before typing/subst.ml(147):4661-8869
                       (let (desc = (field 0 ty))
                         (catch
                           (catch
                             (switch desc
                              case tag 0: (exit 19)
                              case tag 5:
                               (let (k =a (field 1 desc) m =a (field 0 desc))
                                 (before typing/subst.ml(160):5035-5144
                                   (if
                                     (&& (not (field 3 s))
                                       (&&
                                         (after typing/subst.ml(160):5055-5071
                                           (caml_string_equal m
                                             (field 10 (global Btype!))))
                                         (&&
                                           (!=
                                             (after typing/subst.ml(161):5081-5098
                                               (apply
                                                 (field 13 (global Btype!))
                                                 k))
                                             1a)
                                           (<
                                             (field 1
                                               (after typing/subst.ml(161):5113-5122
                                                 (apply
                                                   (field 12 (global Btype!))
                                                   ty)))
                                             (field 3 (global Btype!))))))
                                     (before typing/subst.ml(163):5222-5224
                                       ty)
                                     (exit 20))))
                              case tag 7:
                               (let (ty =a (field 0 desc))
                                 (before typing/subst.ml(159):4999-5001 ty))
                              case tag 9: (exit 19)
                              default: (exit 20))
                            with (20)
                             (before typing/subst.ml(169):5346-8869
                               (let (desc = (field 0 ty))
                                 (before typing/subst.ml(170):5372-8869
                                   (seq
                                     (after typing/subst.ml(170):5372-5409
                                       (apply
                                         (field 0 (field 37 (global Btype!)))
                                         copy_scope ty desc))
                                     (before typing/subst.ml(171):5415-8869
                                       (let
                                         (tm =
                                            (after typing/subst.ml(171):5424-5438
                                              (apply
                                                (field 23 (global Btype!))
                                                ty)))
                                         (before typing/subst.ml(172):5446-8869
                                           (let
                                             (has_fixed_row =
                                                (&&
                                                  (not
                                                    (after typing/subst.ml(173):5476-5491
                                                      (apply
                                                        (field 9
                                                          (global Btype!))
                                                        ty)))
                                                  (after typing/subst.ml(173):5495-5530
                                                    (apply
                                                      (field 26
                                                        (global Btype!))
                                                      0a tm))))
                                             (before typing/subst.ml(175):5560-8869
                                               (let
                                                 (ty' =
                                                    (if (field 3 s)
                                                      (before typing/subst.ml(175):5591-5612
                                                        (after typing/subst.ml(175):5591-5612
                                                          (apply newpersty
                                                            [0: 0a])))
                                                      (before typing/subst.ml(175):5618-5630
                                                        (after typing/subst.ml(175):5618-5630
                                                          (apply
                                                            (field 6
                                                              (global Btype!))
                                                            0a 0a)))))
                                                 (before typing/subst.ml(176):5638-8869
                                                   (seq
                                                     (setfield_ptr 0 ty
                                                       (makeblock 7 ty'))
                                                     (before typing/subst.ml(177):5665-8869
                                                       (seq
                                                         (setfield_ptr 0 ty'
                                                           (if has_fixed_row
                                                             (before typing/subst.ml(179):5719-5946
                                                               (let
                                                                 (*match* =
                                                                    (field 0
                                                                    tm))
                                                                 (catch
                                                                   (switch *match*
                                                                    case tag 3:
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*))
                                                                    (switch* *match*
                                                                    case tag 0:
                                                                    (exit 18)
                                                                    case tag 1:
                                                                    (let
                                                                    (tl =a
                                                                    (field 1
                                                                    *match*)
                                                                    i =a
                                                                    (field 1
                                                                    *match*)
                                                                    m =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/subst.ml(181):5810-5918
                                                                    (let
                                                                    (i' =
                                                                    (after typing/subst.ml(181):5819-5855
                                                                    (apply
                                                                    (field 3
                                                                    (global Stdlib__string!))
                                                                    i 0
                                                                    (-
                                                                    (string.length
                                                                    i) 4))))
                                                                    (before typing/subst.ml(182):5871-5918
                                                                    (makeblock 3
                                                                    (after typing/subst.ml(182):5879-5903
                                                                    (apply
                                                                    type_path
                                                                    s
                                                                    (makeblock 1
                                                                    m i')))
                                                                    tl
                                                                    (makemutable 0
                                                                    0a))))))
                                                                    case tag 2:
                                                                    (exit 18)))
                                                                    default:
                                                                    (exit 18))
                                                                  with (18)
                                                                   (before typing/subst.ml(183):5934-5946
                                                                    (raise
                                                                    (after typing/subst.ml(183):5934-5946
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/subst.ml"
                                                                    183 15])))))))
                                                             (before typing/subst.ml(184):5958-8850
                                                               (catch
                                                                 (switch desc
                                                                  case tag 3:
                                                                   (let
                                                                    (args =a
                                                                    (field 1
                                                                    desc)
                                                                    p =a
                                                                    (field 0
                                                                    desc))
                                                                    (before typing/subst.ml(186):6021-6370
                                                                    (let
                                                                    (args =
                                                                    (after typing/subst.ml(186):6032-6067
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (after typing/subst.ml(186):6041-6062
                                                                    (apply
                                                                    typexp
                                                                    copy_scope
                                                                    s)) args)))
                                                                    (before typing/subst.ml(187):6080-6370
                                                                    (catch
                                                                    (try
                                                                    (exit 10
                                                                    (after typing/subst.ml(187):6092-6115
                                                                    (apply
                                                                    (field 26
                                                                    (field 13
                                                                    (global Path!)))
                                                                    p
                                                                    (field 0
                                                                    s))))
                                                                    with exn
                                                                    (if
                                                                    (== exn
                                                                    (field 7
                                                                    (global Stdlib!)))
                                                                    (before typing/subst.ml(188):6155-6193
                                                                    (makeblock 3
                                                                    (after typing/subst.ml(188):6163-6176
                                                                    (apply
                                                                    type_path
                                                                    s p))
                                                                    args
                                                                    (makemutable 0
                                                                    0a)))
                                                                    (reraise
                                                                    exn)))
                                                                    with (10 val)
                                                                    (switch* val
                                                                    case tag 0:
                                                                    (before typing/subst.ml(189):6215-6253
                                                                    (makeblock 3
                                                                    (after typing/subst.ml(189):6223-6236
                                                                    (apply
                                                                    type_path
                                                                    s p))
                                                                    args
                                                                    (makemutable 0
                                                                    0a)))
                                                                    case tag 1:
                                                                    (let
                                                                    (body =a
                                                                    (field 1
                                                                    val)
                                                                    params =a
                                                                    (field 0
                                                                    val))
                                                                    (before typing/subst.ml(191):6311-6357
                                                                    (field 0
                                                                    (after typing/subst.ml(191):6311-6352
                                                                    (apply
                                                                    (field 0
                                                                    ctype_apply_env_empty)
                                                                    params
                                                                    body
                                                                    args)))))))))))
                                                                  case tag 4:
                                                                   (let
                                                                    (name =a
                                                                    (field 1
                                                                    desc)
                                                                    t1 =a
                                                                    (field 0
                                                                    desc))
                                                                    (before typing/subst.ml(196):6516-6859
                                                                    (let
                                                                    (t1' =
                                                                    (after typing/subst.ml(196):6526-6548
                                                                    (apply
                                                                    typexp
                                                                    copy_scope
                                                                    s t1)))
                                                                    (before typing/subst.ml(197):6562-6859
                                                                    (let
                                                                    (name' =
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    name))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*)
                                                                    tl =a
                                                                    (field 1
                                                                    *match*)
                                                                    p =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/subst.ml(201):6676-6811
                                                                    (if
                                                                    (after typing/subst.ml(201):6679-6708
                                                                    (apply
                                                                    to_subst_by_type_function
                                                                    s p))
                                                                    (before typing/subst.ml(202):6730-6734
                                                                    0a)
                                                                    (before typing/subst.ml(203):6756-6811
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    (after typing/subst.ml(203):6762-6775
                                                                    (apply
                                                                    type_path
                                                                    s p))
                                                                    (after typing/subst.ml(203):6777-6810
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (after typing/subst.ml(203):6786-6807
                                                                    (apply
                                                                    typexp
                                                                    copy_scope
                                                                    s)) tl))))))))
                                                                    (before typing/subst.ml(199):6625-6629
                                                                    0a))))
                                                                    (before typing/subst.ml(205):6835-6859
                                                                    (makeblock 4
                                                                    t1'
                                                                    (makemutable 0
                                                                    name'))))))))
                                                                  case tag 5:
                                                                   (let
                                                                    (t2 =a
                                                                    (field 3
                                                                    desc)
                                                                    kind =a
                                                                    (field 1
                                                                    desc))
                                                                    (before typing/subst.ml(245):8721-8751
                                                                    (if
                                                                    (==
                                                                    (after typing/subst.ml(245):8721-8741
                                                                    (apply
                                                                    (field 13
                                                                    (global Btype!))
                                                                    kind))
                                                                    1a)
                                                                    (before typing/subst.ml(246):8765-8795
                                                                    (makeblock 6
                                                                    (after typing/subst.ml(246):8771-8795
                                                                    (apply
                                                                    typexp
                                                                    copy_scope
                                                                    s t2))))
                                                                    (exit 17))))
                                                                  case tag 8:
                                                                   (let
                                                                    (row =a
                                                                    (field 0
                                                                    desc))
                                                                    (before typing/subst.ml(207):6894-8677
                                                                    (let
                                                                    (row =
                                                                    (after typing/subst.ml(207):6904-6916
                                                                    (apply
                                                                    (field 15
                                                                    (global Btype!))
                                                                    row)))
                                                                    (before typing/subst.ml(208):6930-8677
                                                                    (let
                                                                    (more =
                                                                    (after typing/subst.ml(208):6941-6958
                                                                    (apply
                                                                    (field 12
                                                                    (global Btype!))
                                                                    (field 1
                                                                    row))))
                                                                    (before typing/subst.ml(211):7099-8677
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    more))
                                                                    (catch
                                                                    (switch *match*
                                                                    case tag 7:
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*)
                                                                    *match* =o
                                                                    (field 0
                                                                    *match*))
                                                                    (switch *match*
                                                                    case tag 2:
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (*match* =a
                                                                    (field 1
                                                                    *match*))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (*match* =a
                                                                    (field 1
                                                                    *match*))
                                                                    (if
                                                                    *match*
                                                                    (exit 16)
                                                                    (let
                                                                    (ty2 =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/subst.ml(214):7248-7328
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    ty
                                                                    (makeblock 7
                                                                    ty2))
                                                                    (before typing/subst.ml(215):7319-7328
                                                                    (makeblock 6
                                                                    ty2)))))))
                                                                    (exit 16)))
                                                                    (exit 16)))
                                                                    default:
                                                                    (exit 16)))
                                                                    default:
                                                                    (exit 16))
                                                                    with (16)
                                                                    (before typing/subst.ml(217):7360-8663
                                                                    (let
                                                                    (dup =
                                                                    (||
                                                                    (field 3
                                                                    s)
                                                                    (||
                                                                    (==
                                                                    (field 1
                                                                    more)
                                                                    (field 3
                                                                    (global Btype!)))
                                                                    (||
                                                                    (after typing/subst.ml(218):7432-7446
                                                                    (apply
                                                                    (field 20
                                                                    (global Btype!))
                                                                    row))
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    more))
                                                                    (catch
                                                                    (switch *match*
                                                                    case tag 3:
                                                                    (before typing/subst.ml(219):7500-7504
                                                                    1a)
                                                                    default:
                                                                    (exit 15))
                                                                    with (15)
                                                                    (before typing/subst.ml(219):7512-7517
                                                                    0a)))))))
                                                                    (before typing/subst.ml(221):7590-8663
                                                                    (let
                                                                    (more' =
                                                                    (let
                                                                    (*match* =
                                                                    (field 0
                                                                    more))
                                                                    (catch
                                                                    (catch
                                                                    (switch *match*
                                                                    case int 0:
                                                                    (exit 12)
                                                                    case tag 0:
                                                                    (exit 13)
                                                                    case tag 3:
                                                                    (exit 12)
                                                                    case tag 7:
                                                                    (let
                                                                    (ty =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/subst.ml(223):7670-7672
                                                                    ty))
                                                                    case tag 9:
                                                                    (exit 13)
                                                                    default:
                                                                    (before typing/subst.ml(229):8015-8027
                                                                    (raise
                                                                    (after typing/subst.ml(229):8015-8027
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "typing/subst.ml"
                                                                    229 23])))))
                                                                    with (12)
                                                                    (before typing/subst.ml(224):7711-7735
                                                                    (after typing/subst.ml(224):7711-7735
                                                                    (apply
                                                                    typexp
                                                                    copy_scope
                                                                    s more))))
                                                                    with (13)
                                                                    (before typing/subst.ml(226):7796-7991
                                                                    (seq
                                                                    (after typing/subst.ml(226):7796-7840
                                                                    (apply
                                                                    (field 0
                                                                    (field 37
                                                                    (global Btype!)))
                                                                    copy_scope
                                                                    more
                                                                    (field 0
                                                                    more)))
                                                                    (before typing/subst.ml(227):7862-7991
                                                                    (if
                                                                    (field 3
                                                                    s)
                                                                    (before typing/subst.ml(227):7883-7909
                                                                    (after typing/subst.ml(227):7883-7909
                                                                    (apply
                                                                    newpersty
                                                                    (after typing/subst.ml(227):7893-7909
                                                                    (apply
                                                                    norm
                                                                    (field 0
                                                                    more))))))
                                                                    (before typing/subst.ml(228):7935-7991
                                                                    (if
                                                                    (&& dup
                                                                    (after typing/subst.ml(228):7945-7957
                                                                    (apply
                                                                    (field 7
                                                                    (global Btype!))
                                                                    more)))
                                                                    (before typing/subst.ml(228):7963-7981
                                                                    (after typing/subst.ml(228):7963-7981
                                                                    (apply
                                                                    (field 5
                                                                    (global Btype!))
                                                                    (field 0
                                                                    more))))
                                                                    (before typing/subst.ml(228):7987-7991
                                                                    more))))))))))
                                                                    (before typing/subst.ml(232):8117-8663
                                                                    (seq
                                                                    (setfield_ptr 0
                                                                    more
                                                                    (makeblock 7
                                                                    (after typing/subst.ml(232):8136-8165
                                                                    (apply
                                                                    (field 5
                                                                    (global Btype!))
                                                                    (makeblock 2
                                                                    (makeblock 0
                                                                    more'
                                                                    (makeblock 0
                                                                    ty' 0a)))))))
                                                                    (before typing/subst.ml(234):8219-8663
                                                                    (let
                                                                    (row =
                                                                    (after typing/subst.ml(235):8245-8300
                                                                    (apply
                                                                    (field 35
                                                                    (global Btype!))
                                                                    (after typing/subst.ml(235):8254-8275
                                                                    (apply
                                                                    typexp
                                                                    copy_scope
                                                                    s)) 1a
                                                                    row
                                                                    (not dup)
                                                                    more')))
                                                                    (before typing/subst.ml(236):8318-8663
                                                                    (let
                                                                    (*match* =
                                                                    (field 5
                                                                    row))
                                                                    (if
                                                                    *match*
                                                                    (let
                                                                    (*match* =a
                                                                    (field 0
                                                                    *match*)
                                                                    tl =a
                                                                    (field 1
                                                                    *match*)
                                                                    p =a
                                                                    (field 0
                                                                    *match*))
                                                                    (before typing/subst.ml(238):8391-8608
                                                                    (makeblock 8
                                                                    (let
                                                                    (init =
                                                                    row)
                                                                    (makeblock 0
                                                                    (field 0
                                                                    init)
                                                                    (field 1
                                                                    init)
                                                                    (field 2
                                                                    init)
                                                                    (field 3
                                                                    init)
                                                                    (field 4
                                                                    init)
                                                                    (if
                                                                    (after typing/subst.ml(239):8462-8491
                                                                    (apply
                                                                    to_subst_by_type_function
                                                                    s p))
                                                                    (before typing/subst.ml(240):8535-8539
                                                                    0a)
                                                                    (before typing/subst.ml(241):8583-8607
                                                                    (makeblock 0
                                                                    (makeblock 0
                                                                    (after typing/subst.ml(241):8589-8602
                                                                    (apply
                                                                    type_path
                                                                    s p)) tl)))))))))
                                                                    (before typing/subst.ml(243):8651-8663
                                                                    (makeblock 8
                                                                    row)))))))))))))))))))))
                                                                  case tag 11:
                                                                   (let
                                                                    (tl =a
                                                                    (field 2
                                                                    desc)
                                                                    n =a
                                                                    (field 1
                                                                    desc)
                                                                    p =a
                                                                    (field 0
                                                                    desc))
                                                                    (before typing/subst.ml(194):6411-6475
                                                                    (makeblock 11
                                                                    (after typing/subst.ml(194):6420-6436
                                                                    (apply
                                                                    modtype_path
                                                                    s p)) n
                                                                    (after typing/subst.ml(194):6441-6474
                                                                    (apply
                                                                    (field 16
                                                                    (global Stdlib__list!))
                                                                    (after typing/subst.ml(194):6450-6471
                                                                    (apply
                                                                    typexp
                                                                    copy_scope
                                                                    s)) tl)))))
                                                                  default:
                                                                   (exit 17))
                                                                with (17)
                                                                 (before typing/subst.ml(247):8809-8850
                                                                   (after typing/subst.ml(247):8809-8850
                                                                    (apply
                                                                    (field 34
                                                                    (global Btype!))
                                                                    0a
                                                                    (after typing/subst.ml(247):8824-8845
                                                                    (apply
                                                                    typexp
                                                                    copy_scope
                                                                    s)) desc)))))))
                                                         (before typing/subst.ml(249):8866-8869
                                                           ty'))))))))))))))))
                          with (19)
                           (before typing/subst.ml(149):4720-4975
                             (if (|| (field 3 s) (< (field 3 ty) 0))
                               (before typing/subst.ml(150):4762-4961
                                 (let
                                   (ty' =
                                      (if (field 3 s)
                                        (before typing/subst.ml(151):4803-4824
                                          (after typing/subst.ml(151):4803-4824
                                            (apply newpersty
                                              (after typing/subst.ml(151):4813-4824
                                                (apply norm desc)))))
                                        (before typing/subst.ml(152):4840-4860
                                          (after typing/subst.ml(152):4840-4860
                                            (apply (field 4 (global Btype!))
                                              (field 1 ty) desc)))))
                                   (before typing/subst.ml(154):4880-4961
                                     (seq
                                       (after typing/subst.ml(154):4880-4917
                                         (apply
                                           (field 0
                                             (field 37 (global Btype!)))
                                           copy_scope ty desc))
                                       (before typing/subst.ml(155):4927-4961
                                         (seq
                                           (setfield_ptr 0 ty
                                             (makeblock 7 ty'))
                                           (before typing/subst.ml(156):4958-4961
                                             ty')))))))
                               (before typing/subst.ml(157):4973-4975 ty)))))))))))
          (let
            (type_expr =
               (function s ty
                 (funct-body typing/subst.ml(255)<ghost>:8984-9055
                   (before typing/subst.ml(256):8993-9055
                     (after typing/subst.ml(256):8993-9055
                       (apply (field 2 (field 37 (global Btype!)))
                         (function copy_scope
                           (funct-body typing/subst.ml(256):9013-9055
                             (before typing/subst.ml(256):9032-9054
                               (after typing/subst.ml(256):9032-9054
                                 (apply typexp copy_scope s ty))))))))))
             label_declaration =
               (function copy_scope s l
                 (funct-body typing/subst.ml(258)<ghost>:9079-9274
                   (before typing/subst.ml(259):9098-9274
                     (makeblock 0 (field 0 l) (field 1 l)
                       (after typing/subst.ml(262):9166-9195
                         (apply typexp copy_scope s (field 2 l)))
                       (after typing/subst.ml(263):9210-9224
                         (apply loc s (field 3 l)))
                       (after typing/subst.ml(264):9246-9269
                         (apply attrs s (field 4 l)))))))
             constructor_arguments =
               (function copy_scope s param
                 (funct-body typing/subst.ml(267)<ghost>:9302-9482
                   (switch* param
                    case tag 0:
                     (let (l =a (field 0 param))
                       (before typing/subst.ml(269):9352-9397
                         (makeblock 0
                           (after typing/subst.ml(269):9363-9397
                             (apply (field 16 (global Stdlib__list!))
                               (after typing/subst.ml(269):9373-9394
                                 (apply typexp copy_scope s))
                               l)))))
                    case tag 1:
                     (let (l =a (field 0 param))
                       (before typing/subst.ml(271):9425-9482
                         (makeblock 1
                           (after typing/subst.ml(271):9437-9482
                             (apply (field 16 (global Stdlib__list!))
                               (after typing/subst.ml(271):9447-9479
                                 (apply label_declaration copy_scope s))
                               l))))))))
             constructor_declaration =
               (function copy_scope s c
                 (funct-body typing/subst.ml(273)<ghost>:9512-9747
                   (before typing/subst.ml(274):9531-9747
                     (makeblock 0 (field 0 c)
                       (after typing/subst.ml(276):9568-9612
                         (apply constructor_arguments copy_scope s
                           (field 1 c)))
                       (after typing/subst.ml(277):9627-9668
                         (apply (field 6 (global Stdlib__option!))
                           (after typing/subst.ml(277):9638-9659
                             (apply typexp copy_scope s))
                           (field 2 c)))
                       (after typing/subst.ml(278):9683-9697
                         (apply loc s (field 3 c)))
                       (after typing/subst.ml(279):9719-9742
                         (apply attrs s (field 4 c)))))))
             type_declaration' =
               (function copy_scope s decl
                 (funct-body typing/subst.ml(282)<ghost>:9771-10725
                   (before typing/subst.ml(283):9793-10725
                     (makeblock 0 (*,int,*,*,*,*,*,int,*,*,*,*)
                       (after typing/subst.ml(283):9809-9856
                         (apply (field 16 (global Stdlib__list!))
                           (after typing/subst.ml(283):9818-9839
                             (apply typexp copy_scope s))
                           (field 0 decl)))
                       (field 1 decl)
                       (let (*match* = (field 2 decl))
                         (switch* *match*
                          case int 0:
                           (before typing/subst.ml(287):9971-9984 0a)
                          case int 1:
                           (before typing/subst.ml(292):10225-10234 1a)
                          case tag 0:
                           (let
                             (rep =a (field 1 *match*)
                              lbls =a (field 0 *match*))
                             (before typing/subst.ml(291):10138-10203
                               (makeblock 0
                                 (after typing/subst.ml(291):10151-10197
                                   (apply (field 16 (global Stdlib__list!))
                                     (after typing/subst.ml(291):10160-10192
                                       (apply label_declaration copy_scope s))
                                     lbls))
                                 rep)))
                          case tag 1:
                           (let (cstrs =a (field 0 *match*))
                             (before typing/subst.ml(289):10025-10093
                               (makeblock 1
                                 (after typing/subst.ml(289):10038-10093
                                   (apply (field 16 (global Stdlib__list!))
                                     (after typing/subst.ml(289):10048-10086
                                       (apply constructor_declaration
                                         copy_scope s))
                                     cstrs)))))))
                       (field 3 decl)
                       (let (*match* = (field 4 decl))
                         (if *match*
                           (let (ty =a (field 0 *match*))
                             (before typing/subst.ml(298):10360-10388
                               (makeblock 0
                                 (after typing/subst.ml(298):10364-10388
                                   (apply typexp copy_scope s ty)))))
                           (before typing/subst.ml(297):10334-10338 0a)))
                       (field 5 decl) 0a (field 38 (global Btype!))
                       (after typing/subst.ml(304):10569-10588
                         (apply loc s (field 8 decl)))
                       (after typing/subst.ml(305):10612-10640
                         (apply attrs s (field 9 decl)))
                       (field 10 decl) (field 11 decl)))))
             type_declaration =
               (function s decl
                 (funct-body typing/subst.ml(310)<ghost>:10748-10834
                   (before typing/subst.ml(311):10759-10834
                     (after typing/subst.ml(311):10759-10834
                       (apply (field 2 (field 37 (global Btype!)))
                         (function copy_scope
                           (funct-body typing/subst.ml(311):10779-10834
                             (before typing/subst.ml(311):10798-10833
                               (after typing/subst.ml(311):10798-10833
                                 (apply type_declaration' copy_scope s decl))))))))))
             class_signature =
               (function copy_scope s sign
                 (funct-body typing/subst.ml(313)<ghost>:10856-11207
                   (before typing/subst.ml(314):10878-11207
                     (makeblock 0
                       (after typing/subst.ml(314):10892-10926
                         (apply typexp copy_scope s (field 0 sign)))
                       (after typing/subst.ml(316):10950-11035
                         (apply (field 32 (field 2 (global Types!)))
                           (function param
                             (funct-body typing/subst.ml(317):10967-11020
                               (let
                                 (t =a (field 2 param)
                                  v =a (field 1 param)
                                  m =a (field 0 param))
                                 (before typing/subst.ml(317):10990-11019
                                   (makeblock 0 m v
                                     (after typing/subst.ml(317):10997-11018
                                       (apply typexp copy_scope s t)))))))
                           (field 1 sign)))
                       (field 2 sign)
                       (after typing/subst.ml(320):11094-11202
                         (apply (field 16 (global Stdlib__list!))
                           (function param
                             (funct-body typing/subst.ml(321):11111-11178
                               (let
                                 (tl =a (field 1 param) p =a (field 0 param))
                                 (before typing/subst.ml(321):11127-11177
                                   (makeblock 0
                                     (after typing/subst.ml(321):11128-11141
                                       (apply type_path s p))
                                     (after typing/subst.ml(321):11143-11176
                                       (apply
                                         (field 16 (global Stdlib__list!))
                                         (after typing/subst.ml(321):11152-11173
                                           (apply typexp copy_scope s))
                                         tl)))))))
                           (field 3 sign))))))))
            (letrec
              (class_type
                 (function copy_scope s param
                   (funct-body typing/subst.ml(325)<ghost>:11228-11637
                     (switch* param
                      case tag 0:
                       (let
                         (cty =a (field 2 param)
                          tyl =a (field 1 param)
                          p =a (field 0 param))
                         (before typing/subst.ml(327):11290-11452
                           (let
                             (p' =
                                (after typing/subst.ml(327):11299-11312
                                  (apply type_path s p)))
                             (before typing/subst.ml(328):11322-11452
                               (let
                                 (tyl' =
                                    (after typing/subst.ml(328):11333-11367
                                      (apply
                                        (field 16 (global Stdlib__list!))
                                        (after typing/subst.ml(328):11342-11363
                                          (apply typexp copy_scope s))
                                        tyl)))
                                 (before typing/subst.ml(329):11377-11452
                                   (let
                                     (cty' =
                                        (after typing/subst.ml(329):11388-11415
                                          (apply class_type copy_scope s cty)))
                                     (before typing/subst.ml(330):11425-11452
                                       (makeblock 0 p' tyl' cty')))))))))
                      case tag 1:
                       (let (sign =a (field 0 param))
                         (before typing/subst.ml(332):11485-11534
                           (makeblock 1
                             (after typing/subst.ml(332):11499-11534
                               (apply class_signature copy_scope s sign)))))
                      case tag 2:
                       (let
                         (cty =a (field 2 param)
                          ty =a (field 1 param)
                          l =a (field 0 param))
                         (before typing/subst.ml(334):11571-11637
                           (makeblock 2 l
                             (after typing/subst.ml(334):11585-11607
                               (apply typexp copy_scope s ty))
                             (after typing/subst.ml(334):11609-11636
                               (apply class_type copy_scope s cty)))))))))
              (let
                (class_declaration' =
                   (function copy_scope s decl
                     (funct-body typing/subst.ml(336)<ghost>:11662-12102
                       (before typing/subst.ml(337):11684-12102
                         (makemutable 0
                           (after typing/subst.ml(337):11699-11745
                             (apply (field 16 (global Stdlib__list!))
                               (after typing/subst.ml(337):11708-11729
                                 (apply typexp copy_scope s))
                               (field 0 decl)))
                           (after typing/subst.ml(339):11800-11837
                             (apply class_type copy_scope s (field 1 decl)))
                           (after typing/subst.ml(340):11854-11879
                             (apply type_path s (field 2 decl)))
                           (let (*match* = (field 3 decl))
                             (if *match*
                               (let (ty =a (field 0 *match*))
                                 (before typing/subst.ml(344):11974-12003
                                   (makeblock 0
                                     (after typing/subst.ml(344):11979-12003
                                       (apply typexp copy_scope s ty)))))
                               (before typing/subst.ml(343):11950-11954 0a)))
                           (field 4 decl)
                           (after typing/subst.ml(346):12029-12047
                             (apply loc s (field 5 decl)))
                           (after typing/subst.ml(347):12070-12097
                             (apply attrs s (field 6 decl)))))))
                 class_declaration =
                   (function s decl
                     (funct-body typing/subst.ml(350)<ghost>:12126-12213
                       (before typing/subst.ml(351):12137-12213
                         (after typing/subst.ml(351):12137-12213
                           (apply (field 2 (field 37 (global Btype!)))
                             (function copy_scope
                               (funct-body typing/subst.ml(351):12157-12213
                                 (before typing/subst.ml(351):12176-12212
                                   (after typing/subst.ml(351):12176-12212
                                     (apply class_declaration' copy_scope s
                                       decl))))))))))
                 cltype_declaration' =
                   (function copy_scope s decl
                     (funct-body typing/subst.ml(353)<ghost>:12239-12557
                       (before typing/subst.ml(354):12261-12557
                         (makeblock 0
                           (after typing/subst.ml(354):12277-12324
                             (apply (field 16 (global Stdlib__list!))
                               (after typing/subst.ml(354):12286-12307
                                 (apply typexp copy_scope s))
                               (field 0 decl)))
                           (after typing/subst.ml(356):12382-12420
                             (apply class_type copy_scope s (field 1 decl)))
                           (after typing/subst.ml(357):12438-12464
                             (apply type_path s (field 2 decl)))
                           (field 3 decl)
                           (after typing/subst.ml(358):12481-12500
                             (apply loc s (field 4 decl)))
                           (after typing/subst.ml(359):12524-12552
                             (apply attrs s (field 5 decl)))))))
                 cltype_declaration =
                   (function s decl
                     (funct-body typing/subst.ml(362)<ghost>:12582-12670
                       (before typing/subst.ml(363):12593-12670
                         (after typing/subst.ml(363):12593-12670
                           (apply (field 2 (field 37 (global Btype!)))
                             (function copy_scope
                               (funct-body typing/subst.ml(363):12613-12670
                                 (before typing/subst.ml(363):12632-12669
                                   (after typing/subst.ml(363):12632-12669
                                     (apply cltype_declaration' copy_scope s
                                       decl))))))))))
                 class_type =
                   (function s cty
                     (funct-body typing/subst.ml(365)<ghost>:12687-12764
                       (before typing/subst.ml(366):12697-12764
                         (after typing/subst.ml(366):12697-12764
                           (apply (field 2 (field 37 (global Btype!)))
                             (function copy_scope
                               (funct-body typing/subst.ml(366):12717-12764
                                 (before typing/subst.ml(366):12736-12763
                                   (after typing/subst.ml(366):12736-12763
                                     (apply class_type copy_scope s cty))))))))))
                 value_description' =
                   (function copy_scope s descr
                     (funct-body typing/subst.ml(368)<ghost>:12789-12982
                       (before typing/subst.ml(369):12812-12982
                         (makeblock 0
                           (after typing/subst.ml(369):12825-12859
                             (apply typexp copy_scope s (field 0 descr)))
                           (field 1 descr)
                           (after typing/subst.ml(371):12906-12925
                             (apply loc s (field 2 descr)))
                           (after typing/subst.ml(372):12948-12976
                             (apply attrs s (field 3 descr)))))))
                 value_description =
                   (function s descr
                     (funct-body typing/subst.ml(375)<ghost>:13006-13095
                       (before typing/subst.ml(376):13018-13095
                         (after typing/subst.ml(376):13018-13095
                           (apply (field 2 (field 37 (global Btype!)))
                             (function copy_scope
                               (funct-body typing/subst.ml(376):13038-13095
                                 (before typing/subst.ml(376):13057-13094
                                   (after typing/subst.ml(376):13057-13094
                                     (apply value_description' copy_scope s
                                       descr))))))))))
                 extension_constructor' =
                   (function copy_scope s ext
                     (funct-body typing/subst.ml(378)<ghost>:13124-13554
                       (before typing/subst.ml(379):13145-13554
                         (makeblock 0
                           (after typing/subst.ml(379):13163-13192
                             (apply type_path s (field 0 ext)))
                           (after typing/subst.ml(380):13216-13266
                             (apply (field 16 (global Stdlib__list!))
                               (after typing/subst.ml(380):13225-13246
                                 (apply typexp copy_scope s))
                               (field 1 ext)))
                           (after typing/subst.ml(381):13283-13330
                             (apply constructor_arguments copy_scope s
                               (field 2 ext)))
                           (after typing/subst.ml(382):13351-13400
                             (apply (field 6 (global Stdlib__option!))
                               (after typing/subst.ml(382):13362-13383
                                 (apply typexp copy_scope s))
                               (field 3 ext)))
                           (field 4 ext)
                           (if (field 3 s)
                             (before typing/subst.ml(385):13521-13534
                               (field 0 (global Location!)))
                             (before typing/subst.ml(385):13540-13551
                               (field 5 ext)))
                           (after typing/subst.ml(384):13458-13484
                             (apply attrs s (field 6 ext)))))))
                 extension_constructor =
                   (function s ext
                     (funct-body typing/subst.ml(387)<ghost>:13582-13675
                       (before typing/subst.ml(388):13592-13675
                         (after typing/subst.ml(388):13592-13675
                           (apply (field 2 (field 37 (global Btype!)))
                             (function copy_scope
                               (funct-body typing/subst.ml(389):13616-13675
                                 (before typing/subst.ml(389):13635-13674
                                   (after typing/subst.ml(389):13635-13674
                                     (apply extension_constructor' copy_scope
                                       s ext))))))))))
                 rename_bound_idents =
                   (function scoping s sg
                     (funct-body typing/subst.ml(396)<ghost>:13760-15624
                       (before typing/subst.ml(397):13777-15624
                         (let
                           (rename =
                              (if (isint scoping)
                                (if scoping
                                  (before typing/subst.ml(401):13923-13935
                                    (field 13 (global Ident!)))
                                  (before typing/subst.ml(400):13849-13902
                                    (function id
                                      (funct-body typing/subst.ml(400):13849-13902
                                        (before typing/subst.ml(400):13860-13901
                                          (after typing/subst.ml(400):13860-13901
                                            (apply (field 9 (global Ident!))
                                              (after typing/subst.ml(400):13881-13891
                                                (apply
                                                  (field 22 (global Ident!))
                                                  id))
                                              (after typing/subst.ml(400):13892-13901
                                                (apply
                                                  (field 14 (global Ident!))
                                                  id)))))))))
                                (let (scope =a (field 0 scoping))
                                  (before typing/subst.ml(402):13959-14001
                                    (function id
                                      (funct-body typing/subst.ml(402):13959-14001
                                        (before typing/subst.ml(402):13970-14000
                                          (after typing/subst.ml(402):13970-14000
                                            (apply (field 9 (global Ident!))
                                              scope
                                              (after typing/subst.ml(402):13991-14000
                                                (apply
                                                  (field 14 (global Ident!))
                                                  id)))))))))))
                           (before typing/subst.ml(404):14009-15624
                             (letrec
                               (rename_bound_idents
                                  (function s sg param
                                    (funct-body typing/subst.ml(404)<ghost>:14037-15589
                                      (if param
                                        (let (*match* =a (field 0 param))
                                          (switch* *match*
                                           case tag 0:
                                            (let
                                              (rest =a (field 1 param)
                                               vis =a (field 2 *match*)
                                               vd =a (field 1 *match*)
                                               id =a (field 0 *match*))
                                              (before typing/subst.ml(440):15349-15444
                                                (let
                                                  (id' =
                                                     (after typing/subst.ml(440):15359-15374
                                                       (apply
                                                         (field 13
                                                           (global Ident!))
                                                         id)))
                                                  (before typing/subst.ml(441):15386-15444
                                                    (after typing/subst.ml(441):15386-15444
                                                      (apply
                                                        rename_bound_idents s
                                                        (makeblock 0
                                                          (makeblock 0 id' vd
                                                            vis)
                                                          sg)
                                                        rest))))))
                                           case tag 1:
                                            (let
                                              (rest =a (field 1 param)
                                               vis =a (field 3 *match*)
                                               rs =a (field 2 *match*)
                                               td =a (field 1 *match*)
                                               id =a (field 0 *match*))
                                              (before typing/subst.ml(407):14122-14271
                                                (let
                                                  (id' =
                                                     (after typing/subst.ml(407):14132-14141
                                                       (apply rename id)))
                                                  (before typing/subst.ml(408):14153-14271
                                                    (after typing/subst.ml(408):14153-14271
                                                      (apply
                                                        rename_bound_idents
                                                        (after typing/subst.ml(409):14183-14211
                                                          (apply add_type id
                                                            (makeblock 0 id')
                                                            s))
                                                        (makeblock 0
                                                          (makeblock 1 id' td
                                                            rs vis)
                                                          sg)
                                                        rest))))))
                                           case tag 2:
                                            (let
                                              (rest =a (field 1 param)
                                               vis =a (field 3 *match*)
                                               es =a (field 2 *match*)
                                               ec =a (field 1 *match*)
                                               id =a (field 0 *match*))
                                              (before typing/subst.ml(443):15498-15589
                                                (let
                                                  (id' =
                                                     (after typing/subst.ml(443):15508-15517
                                                       (apply rename id)))
                                                  (before typing/subst.ml(444):15529-15589
                                                    (after typing/subst.ml(444):15529-15589
                                                      (apply
                                                        rename_bound_idents s
                                                        (makeblock 0
                                                          (makeblock 2 id' ec
                                                            es vis)
                                                          sg)
                                                        rest))))))
                                           case tag 3:
                                            (let
                                              (rest =a (field 1 param)
                                               vis =a (field 4 *match*)
                                               rs =a (field 3 *match*)
                                               md =a (field 2 *match*)
                                               pres =a (field 1 *match*)
                                               id =a (field 0 *match*))
                                              (before typing/subst.ml(413):14331-14491
                                                (let
                                                  (id' =
                                                     (after typing/subst.ml(413):14341-14350
                                                       (apply rename id)))
                                                  (before typing/subst.ml(414):14362-14491
                                                    (after typing/subst.ml(414):14362-14491
                                                      (apply
                                                        rename_bound_idents
                                                        (after typing/subst.ml(415):14392-14422
                                                          (apply add_module
                                                            id
                                                            (makeblock 0 id')
                                                            s))
                                                        (makeblock 0
                                                          (makeblock 3 id'
                                                            pres md rs vis)
                                                          sg)
                                                        rest))))))
                                           case tag 4:
                                            (let
                                              (rest =a (field 1 param)
                                               vis =a (field 2 *match*)
                                               mtd =a (field 1 *match*)
                                               id =a (field 0 *match*))
                                              (before typing/subst.ml(419):14543-14706
                                                (let
                                                  (id' =
                                                     (after typing/subst.ml(419):14553-14562
                                                       (apply rename id)))
                                                  (before typing/subst.ml(420):14574-14706
                                                    (after typing/subst.ml(420):14574-14706
                                                      (apply
                                                        rename_bound_idents
                                                        (after typing/subst.ml(421):14604-14646
                                                          (apply add_modtype
                                                            id
                                                            (makeblock 0
                                                              (makeblock 0
                                                                id'))
                                                            s))
                                                        (makeblock 0
                                                          (makeblock 4 id'
                                                            mtd vis)
                                                          sg)
                                                        rest))))))
                                           case tag 5:
                                            (let
                                              (rest =a (field 1 param)
                                               vis =a (field 3 *match*)
                                               rs =a (field 2 *match*)
                                               cd =a (field 1 *match*)
                                               id =a (field 0 *match*))
                                              (before typing/subst.ml(426):14818-14968
                                                (let
                                                  (id' =
                                                     (after typing/subst.ml(426):14828-14837
                                                       (apply rename id)))
                                                  (before typing/subst.ml(427):14849-14968
                                                    (after typing/subst.ml(427):14849-14968
                                                      (apply
                                                        rename_bound_idents
                                                        (after typing/subst.ml(428):14879-14907
                                                          (apply add_type id
                                                            (makeblock 0 id')
                                                            s))
                                                        (makeblock 0
                                                          (makeblock 5 id' cd
                                                            rs vis)
                                                          sg)
                                                        rest))))))
                                           case tag 6:
                                            (let
                                              (rest =a (field 1 param)
                                               vis =a (field 3 *match*)
                                               rs =a (field 2 *match*)
                                               ctd =a (field 1 *match*)
                                               id =a (field 0 *match*))
                                              (before typing/subst.ml(433):15086-15242
                                                (let
                                                  (id' =
                                                     (after typing/subst.ml(433):15096-15105
                                                       (apply rename id)))
                                                  (before typing/subst.ml(434):15117-15242
                                                    (after typing/subst.ml(434):15117-15242
                                                      (apply
                                                        rename_bound_idents
                                                        (after typing/subst.ml(435):15147-15175
                                                          (apply add_type id
                                                            (makeblock 0 id')
                                                            s))
                                                        (makeblock 0
                                                          (makeblock 6 id'
                                                            ctd rs vis)
                                                          sg)
                                                        rest))))))))
                                        (before typing/subst.ml(405):14065-14070
                                          (makeblock 0 sg s))))))
                               (before typing/subst.ml(446):15597-15624
                                 (after typing/subst.ml(446):15597-15624
                                   (apply rename_bound_idents s 0a sg))))))))))
                (letrec
                  (modtype
                     (function scoping s mty
                       (funct-body typing/subst.ml(448)<ghost>:15642-16268
                         (switch* mty
                          case tag 0:
                           (let (p =a (field 0 mty))
                             (before typing/subst.ml(450):15695-15945
                               (switch* p
                                case tag 0:
                                 (let (id =a (field 0 p))
                                   (before typing/subst.ml(452):15745-15809
                                     (try
                                       (after typing/subst.ml(452):15755-15783
                                         (apply
                                           (field 26
                                             (field 6 (global Ident!)))
                                           id (field 2 s)))
                                      with exn
                                       (if
                                         (== exn (field 7 (global Stdlib!)))
                                         (before typing/subst.ml(452):15802-15805
                                           mty)
                                         (reraise exn)))))
                                case tag 1:
                                 (let (n =a (field 1 p) p =a (field 0 p))
                                   (before typing/subst.ml(454):15842-15877
                                     (makeblock 0
                                       (makeblock 1
                                         (after typing/subst.ml(454):15857-15872
                                           (apply module_path s p))
                                         n))))
                                case tag 2:
                                 (before typing/subst.ml(456):15908-15935
                                   (after typing/subst.ml(456):15908-15935
                                     (apply (field 0 (global Misc!))
                                       "Subst.modtype"))))))
                          case tag 1:
                           (let (sg =a (field 0 mty))
                             (before typing/subst.ml(459):15976-16013
                               (makeblock 1
                                 (after typing/subst.ml(459):15989-16013
                                   (apply signature scoping s sg)))))
                          case tag 2:
                           (let
                             (res =a (field 2 mty)
                              arg =a (field 1 mty)
                              id =a (field 0 mty))
                             (before typing/subst.ml(461):16053-16215
                               (let
                                 (id' =
                                    (after typing/subst.ml(461):16063-16078
                                      (apply (field 13 (global Ident!)) id)))
                                 (before typing/subst.ml(462):16088-16215
                                   (makeblock 2 id'
                                     (after typing/subst.ml(462):16105-16139
                                       (apply
                                         (field 6 (global Stdlib__option!))
                                         (after typing/subst.ml(462):16116-16135
                                           (apply modtype scoping s))
                                         arg))
                                     (after typing/subst.ml(463):16164-16214
                                       (apply modtype scoping
                                         (after typing/subst.ml(463):16180-16210
                                           (apply add_module id
                                             (makeblock 0 id') s))
                                         res)))))))
                          case tag 3:
                           (let (p =a (field 0 mty))
                             (before typing/subst.ml(465):16241-16268
                               (makeblock 3
                                 (after typing/subst.ml(465):16251-16268
                                   (apply module_path s p))))))))
                    signature
                      (function scoping s sg
                        (funct-body typing/subst.ml(467)<ghost>:16284-16692
                          (before typing/subst.ml(471):16473-16692
                            (let
                              (*match* =
                                 (after typing/subst.ml(471):16489-16521
                                   (apply rename_bound_idents scoping s sg))
                               s' =a (field 1 *match*)
                               sg' =a (field 0 *match*))
                              (before typing/subst.ml(473):16589-16692
                                (after typing/subst.ml(473):16589-16692
                                  (apply (field 2 (field 37 (global Btype!)))
                                    (function copy_scope
                                      (funct-body typing/subst.ml(473):16609-16692
                                        (before typing/subst.ml(474):16632-16688
                                          (after typing/subst.ml(474):16632-16688
                                            (apply
                                              (field 18
                                                (global Stdlib__list!))
                                              (after typing/subst.ml(474):16645-16684
                                                (apply signature_item'
                                                  copy_scope scoping s'))
                                              sg'))))))))))))
                    signature_item'
                      (function copy_scope scoping s comp
                        (funct-body typing/subst.ml(478)<ghost>:16715-17454
                          (before typing/subst.ml(479):16745-17454
                            (switch* comp
                             case tag 0:
                              (let
                                (vis =a (field 2 comp)
                                 d =a (field 1 comp)
                                 id =a (field 0 comp))
                                (before typing/subst.ml(481):16796-16849
                                  (makeblock 0 id
                                    (after typing/subst.ml(481):16810-16843
                                      (apply value_description' copy_scope s
                                        d))
                                    vis)))
                             case tag 1:
                              (let
                                (vis =a (field 3 comp)
                                 rs =a (field 2 comp)
                                 d =a (field 1 comp)
                                 id =a (field 0 comp))
                                (before typing/subst.ml(483):16888-16943
                                  (makeblock 1 id
                                    (after typing/subst.ml(483):16901-16933
                                      (apply type_declaration' copy_scope s
                                        d))
                                    rs vis)))
                             case tag 2:
                              (let
                                (vis =a (field 3 comp)
                                 es =a (field 2 comp)
                                 ext =a (field 1 comp)
                                 id =a (field 0 comp))
                                (before typing/subst.ml(485):16986-17050
                                  (makeblock 2 id
                                    (after typing/subst.ml(485):17001-17040
                                      (apply extension_constructor'
                                        copy_scope s ext))
                                    es vis)))
                             case tag 3:
                              (let
                                (vis =a (field 4 comp)
                                 rs =a (field 3 comp)
                                 d =a (field 2 comp)
                                 pres =a (field 1 comp)
                                 id =a (field 0 comp))
                                (before typing/subst.ml(487):17097-17158
                                  (makeblock 3 id pres
                                    (after typing/subst.ml(487):17118-17148
                                      (apply module_declaration scoping s d))
                                    rs vis)))
                             case tag 4:
                              (let
                                (vis =a (field 2 comp)
                                 d =a (field 1 comp)
                                 id =a (field 0 comp))
                                (before typing/subst.ml(489):17196-17249
                                  (makeblock 4 id
                                    (after typing/subst.ml(489):17212-17243
                                      (apply modtype_declaration scoping s d))
                                    vis)))
                             case tag 5:
                              (let
                                (vis =a (field 3 comp)
                                 rs =a (field 2 comp)
                                 d =a (field 1 comp)
                                 id =a (field 0 comp))
                                (before typing/subst.ml(491):17289-17346
                                  (makeblock 5 id
                                    (after typing/subst.ml(491):17303-17336
                                      (apply class_declaration' copy_scope s
                                        d))
                                    rs vis)))
                             case tag 6:
                              (let
                                (vis =a (field 3 comp)
                                 rs =a (field 2 comp)
                                 d =a (field 1 comp)
                                 id =a (field 0 comp))
                                (before typing/subst.ml(493):17391-17454
                                  (makeblock 6 id
                                    (after typing/subst.ml(493):17410-17444
                                      (apply cltype_declaration' copy_scope s
                                        d))
                                    rs vis)))))))
                    signature_item
                      (function s comp
                        (funct-body typing/subst.ml(495)<ghost>:17475-17559
                          (before typing/subst.ml(496):17486-17559
                            (after typing/subst.ml(496):17486-17559
                              (apply (field 2 (field 37 (global Btype!)))
                                (function copy_scope
                                  (funct-body typing/subst.ml(496):17506-17559
                                    (before typing/subst.ml(496):17525-17558
                                      (after typing/subst.ml(496):17525-17558
                                        (apply signature_item' copy_scope s
                                          comp))))))))))
                    module_declaration
                      (function scoping s decl
                        (funct-body typing/subst.ml(498)<ghost>:17584-17734
                          (before typing/subst.ml(499):17603-17734
                            (makeblock 0
                              (after typing/subst.ml(500):17619-17649
                                (apply modtype scoping s (field 0 decl)))
                              (after typing/subst.ml(501):17671-17697
                                (apply attrs s (field 1 decl)))
                              (after typing/subst.ml(502):17712-17729
                                (apply loc s (field 2 decl)))))))
                    modtype_declaration
                      (function scoping s decl
                        (funct-body typing/subst.ml(505)<ghost>:17760-17930
                          (before typing/subst.ml(506):17780-17930
                            (makeblock 0
                              (after typing/subst.ml(507):17797-17841
                                (apply (field 6 (global Stdlib__option!))
                                  (after typing/subst.ml(507):17808-17827
                                    (apply modtype scoping s))
                                  (field 0 decl)))
                              (after typing/subst.ml(508):17864-17891
                                (apply attrs s (field 1 decl)))
                              (after typing/subst.ml(509):17907-17925
                                (apply loc s (field 2 decl))))))))
                  (let
                    (merge_tbls =
                       (function f m1 m2
                         (funct-body typing/subst.ml(516)<ghost>:18044-18121
                           (before typing/subst.ml(517):18056-18121
                             (after typing/subst.ml(517):18056-18121
                               (apply (field 12 (field 6 (global Ident!)))
                                 (function k d accu
                                   (funct-body typing/subst.ml(517):18071-18115
                                     (before typing/subst.ml(517):18088-18114
                                       (after typing/subst.ml(517):18088-18114
                                         (apply
                                           (field 3
                                             (field 6 (global Ident!)))
                                           k
                                           (after typing/subst.ml(517):18104-18109
                                             (apply f d))
                                           accu)))))
                                 m1 m2)))))
                     merge_path_maps =
                       (function f m1 m2
                         (funct-body typing/subst.ml(519)<ghost>:18143-18218
                           (before typing/subst.ml(520):18155-18218
                             (after typing/subst.ml(520):18155-18218
                               (apply (field 12 (field 13 (global Path!)))
                                 (function k d accu
                                   (funct-body typing/subst.ml(520):18169-18212
                                     (before typing/subst.ml(520):18186-18211
                                       (after typing/subst.ml(520):18186-18211
                                         (apply
                                           (field 3
                                             (field 13 (global Path!)))
                                           k
                                           (after typing/subst.ml(520):18201-18206
                                             (apply f d))
                                           accu)))))
                                 m1 m2)))))
                     type_replacement =
                       (function s param
                         (funct-body typing/subst.ml(522)<ghost>:18241-18449
                           (switch* param
                            case tag 0:
                             (let (p =a (field 0 param))
                               (before typing/subst.ml(523):18268-18288
                                 (makeblock 0
                                   (after typing/subst.ml(523):18273-18288
                                     (apply type_path s p)))))
                            case tag 1:
                             (let
                               (body =a (field 1 param)
                                params =a (field 0 param))
                               (before typing/subst.ml(525):18332-18449
                                 (let
                                   (params =
                                      (after typing/subst.ml(525):18345-18374
                                        (apply
                                          (field 16 (global Stdlib__list!))
                                          (after typing/subst.ml(525):18354-18367
                                            (apply type_expr s))
                                          params)))
                                   (before typing/subst.ml(526):18383-18449
                                     (let
                                       (body =
                                          (after typing/subst.ml(526):18394-18410
                                            (apply type_expr s body)))
                                       (before typing/subst.ml(527):18419-18449
                                         (makeblock 1 params body))))))))))
                     compose =
                       (function s1 s2
                         (funct-body typing/subst.ml(532)<ghost>:18553-18821
                           (before typing/subst.ml(533):18563-18821
                             (makeblock 0
                               (after typing/subst.ml(533):18573-18628
                                 (apply merge_path_maps
                                   (after typing/subst.ml(533):18589-18610
                                     (apply type_replacement s2))
                                   (field 0 s1) (field 0 s2)))
                               (after typing/subst.ml(534):18644-18698
                                 (apply merge_path_maps
                                   (after typing/subst.ml(534):18660-18676
                                     (apply module_path s2))
                                   (field 1 s1) (field 1 s2)))
                               (after typing/subst.ml(535):18715-18767
                                 (apply merge_tbls
                                   (after typing/subst.ml(535):18726-18743
                                     (apply modtype 0a s2))
                                   (field 2 s1) (field 2 s2)))
                               (|| (field 3 s1) (field 3 s2)))))))
                    (pseudo _none_(0)<ghost>:-1--1
                      (makeblock 0 identity add_type add_type_path
                        add_type_function add_module add_module_path
                        add_modtype for_saving reset_for_saving module_path
                        type_path type_expr class_type value_description
                        type_declaration extension_constructor
                        class_declaration cltype_declaration modtype
                        signature signature_item modtype_declaration
                        module_declaration compose ctype_apply_env_empty))))))))))))
