(setglobal Unbox_free_vars_of_closures!
  (let
    (pass_name = "unbox-free-vars-of-closures"
     *match* =
       (after middle_end/flambda/unbox_free_vars_of_closures.ml(23):1327-1359
         (apply (field 0 (global Pass_wrapper!)) pass_name))
     add_lifted_projections_around_set_of_closures =
       (function set_of_closures existing_inner_to_outer_vars benefit
         definitions_indexed_by_new_inner_vars
         (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(28)<ghost>:1527-2909
           (before middle_end/flambda/unbox_free_vars_of_closures.ml(30):1632-2909
             (let
               (body =
                  (after middle_end/flambda/unbox_free_vars_of_closures.ml(31):1647-1768
                    (apply (field 11 (global Flambda_utils!))
                      (field 70 (global Internal_variable_names!))
                      (makeblock 5 set_of_closures))))
               (before middle_end/flambda/unbox_free_vars_of_closures.ml(34):1776-2909
                 (after middle_end/flambda/unbox_free_vars_of_closures.ml(34):1776-2909
                   (apply (field 12 (field 7 (global Variable!)))
                     (function new_inner_var projection param
                       (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(34):1794-2847
                         (let
                           (benefit =a (field 1 param)
                            expr =a (field 0 param))
                           (before middle_end/flambda/unbox_free_vars_of_closures.ml(36):1878-2846
                             (let
                               (find_outer_var =
                                  (function inner_var
                                    (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(36)<ghost>:1897-2354
                                      (before middle_end/flambda/unbox_free_vars_of_closures.ml(37):1917-2354
                                        (catch
                                          (try
                                            (exit 1
                                              (after middle_end/flambda/unbox_free_vars_of_closures.ml(38):1933-1989
                                                (apply
                                                  (field 26
                                                    (field 7
                                                      (global Variable!)))
                                                  inner_var
                                                  existing_inner_to_outer_vars)))
                                           with exn
                                            (if
                                              (== exn
                                                (field 7 (global Stdlib!)))
                                              (before middle_end/flambda/unbox_free_vars_of_closures.ml(42):2110-2354
                                                (after middle_end/flambda/unbox_free_vars_of_closures.ml(42):2110-2354
                                                  (apply
                                                    (field 1 (global Misc!))
                                                    [0:
                                                     [11:
                                                      "(UFV) find_outer_var: expected "
                                                      [15:
                                                       [11:
                                                        " to be in [existing_inner_to_outer_vars], but it is not.  (The projection was: "
                                                        [15: [12: ')' 0a]]]]]
                                                     "(UFV) find_outer_var: expected %a to be in [existing_inner_to_outer_vars], but it is not.  (The projection was: %a)"]
                                                    (field 5
                                                      (global Variable!))
                                                    inner_var
                                                    (field 11
                                                      (global Projection!))
                                                    projection)))
                                              (reraise exn)))
                                         with (1 outer_var)
                                          (before middle_end/flambda/unbox_free_vars_of_closures.ml(40):2053-2066
                                            (field 0 outer_var)))))))
                               (before middle_end/flambda/unbox_free_vars_of_closures.ml(48):2370-2846
                                 (let
                                   (benefit =
                                      (after middle_end/flambda/unbox_free_vars_of_closures.ml(48):2384-2419
                                        (apply
                                          (field 15
                                            (field 3 (global Inlining_cost!)))
                                          projection benefit)))
                                   (before middle_end/flambda/unbox_free_vars_of_closures.ml(49):2429-2846
                                     (let
                                       (named =
                                          (let
                                            (projection =
                                               (after middle_end/flambda/unbox_free_vars_of_closures.ml(53):2597-2656
                                                 (apply
                                                   (field 16
                                                     (global Projection!))
                                                   projection find_outer_var)))
                                            (before middle_end/flambda/unbox_free_vars_of_closures.ml(55):2676-2720
                                              (after middle_end/flambda/unbox_free_vars_of_closures.ml(55):2676-2720
                                                (apply
                                                  (field 34
                                                    (global Flambda_utils!))
                                                  projection)))))
                                       (before middle_end/flambda/unbox_free_vars_of_closures.ml(57):2736-2846
                                         (let
                                           (expr =
                                              (after middle_end/flambda/unbox_free_vars_of_closures.ml(58):2755-2815
                                                (apply
                                                  (field 11
                                                    (global Flambda!))
                                                  (after middle_end/flambda/unbox_free_vars_of_closures.ml(58):2774-2804
                                                    (apply find_outer_var
                                                      new_inner_var))
                                                  named expr)))
                                           (before middle_end/flambda/unbox_free_vars_of_closures.ml(60):2831-2846
                                             (makeblock 0 expr benefit)))))))))))))
                     definitions_indexed_by_new_inner_vars
                     (makeblock 0 body benefit))))))))
     run =
       (function env set_of_closures
         (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(64)<ghost>:2919-7377
           (before middle_end/flambda/unbox_free_vars_of_closures.ml(65):2973-7377
             (if (not (field 0 (field 137 (global Clflags!))))
               (before middle_end/flambda/unbox_free_vars_of_closures.ml(66):3026-3030
                 0a)
               (before middle_end/flambda/unbox_free_vars_of_closures.ml(68):3042-7377
                 (let
                   (*match* =
                      (let
                        (all_existing_definitions =
                           (after middle_end/flambda/unbox_free_vars_of_closures.ml(70):3161-3534
                             (apply (field 12 (field 7 (global Variable!)))
                               (function _inner_var outer_var
                                 all_existing_definitions
                                 (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(70):3179-3467
                                   (before middle_end/flambda/unbox_free_vars_of_closures.ml(72):3286-3466
                                     (let (*match* = (field 1 outer_var))
                                       (if *match*
                                         (let
                                           (projection =a (field 0 *match*))
                                           (before middle_end/flambda/unbox_free_vars_of_closures.ml(75):3412-3466
                                             (after middle_end/flambda/unbox_free_vars_of_closures.ml(75):3412-3466
                                               (apply
                                                 (field 3
                                                   (field 12
                                                     (global Projection!)))
                                                 projection
                                                 all_existing_definitions))))
                                         (before middle_end/flambda/unbox_free_vars_of_closures.ml(73):3340-3364
                                           all_existing_definitions))))))
                               (field 1 set_of_closures)
                               (field 0 (field 12 (global Projection!))))))
                        (before middle_end/flambda/unbox_free_vars_of_closures.ml(79):3550-6237
                          (after middle_end/flambda/unbox_free_vars_of_closures.ml(79):3550-6237
                            (apply (field 35 (global Flambda_iterators!))
                              set_of_closures
                              (makeblock 0
                                (field 0 (field 7 (global Variable!)))
                                all_existing_definitions
                                (field 1 set_of_closures) 0a)
                              (function param function_decl result
                                (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(82):3735-6237
                                  (before middle_end/flambda/unbox_free_vars_of_closures.ml(83):3786-6236
                                    (let
                                      (extracted =
                                         (after middle_end/flambda/unbox_free_vars_of_closures.ml(84):3814-3929
                                           (apply
                                             (field 0
                                               (global Extract_projections!))
                                             env (field 1 set_of_closures)
                                             function_decl)))
                                      (before middle_end/flambda/unbox_free_vars_of_closures.ml(87):3953-6236
                                        (after middle_end/flambda/unbox_free_vars_of_closures.ml(87):3953-6236
                                          (apply
                                            (field 14
                                              (field 12 (global Projection!)))
                                            (function projection result
                                              (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(87):3973-6195
                                                (let
                                                  (additional_free_vars =a
                                                     (field 2 result)
                                                   all_existing_definitions_including_added_ones =a
                                                     (field 1 result)
                                                   definitions_indexed_by_new_inner_vars =a
                                                     (field 0 result))
                                                  (before middle_end/flambda/unbox_free_vars_of_closures.ml(98):4646-6194
                                                    (if
                                                      (after middle_end/flambda/unbox_free_vars_of_closures.ml(98):4649-4740
                                                        (apply
                                                          (field 2
                                                            (field 12
                                                              (global Projection!)))
                                                          projection
                                                          all_existing_definitions_including_added_ones))
                                                      (before middle_end/flambda/unbox_free_vars_of_closures.ml(100):4760-4806
                                                        result)
                                                      (before middle_end/flambda/unbox_free_vars_of_closures.ml(102):4812-6194
                                                        (let
                                                          (projecting_from =
                                                             (after middle_end/flambda/unbox_free_vars_of_closures.ml(106):5056-5093
                                                               (apply
                                                                 (field 15
                                                                   (global Projection!))
                                                                 projection)))
                                                          (before middle_end/flambda/unbox_free_vars_of_closures.ml(107):5113-6176
                                                            (let
                                                              (new_inner_var =
                                                                 (after middle_end/flambda/unbox_free_vars_of_closures.ml(107):5133-5164
                                                                   (apply
                                                                    (field 11
                                                                    (global Variable!))
                                                                    0a
                                                                    projecting_from)))
                                                              (before middle_end/flambda/unbox_free_vars_of_closures.ml(108):5184-6176
                                                                (let
                                                                  (new_outer_var =
                                                                    (after middle_end/flambda/unbox_free_vars_of_closures.ml(108):5204-5235
                                                                    (apply
                                                                    (field 11
                                                                    (global Variable!))
                                                                    0a
                                                                    projecting_from)))
                                                                  (before middle_end/flambda/unbox_free_vars_of_closures.ml(109):5255-6176
                                                                    (let
                                                                    (definitions_indexed_by_new_inner_vars =
                                                                    (after middle_end/flambda/unbox_free_vars_of_closures.ml(110):5317-5416
                                                                    (apply
                                                                    (field 3
                                                                    (field 7
                                                                    (global Variable!)))
                                                                    new_inner_var
                                                                    projection
                                                                    definitions_indexed_by_new_inner_vars)))
                                                                    (before middle_end/flambda/unbox_free_vars_of_closures.ml(113):5452-6176
                                                                    (let
                                                                    (all_existing_definitions_including_added_ones =
                                                                    (after middle_end/flambda/unbox_free_vars_of_closures.ml(114):5522-5617
                                                                    (apply
                                                                    (field 3
                                                                    (field 12
                                                                    (global Projection!)))
                                                                    projection
                                                                    all_existing_definitions_including_added_ones)))
                                                                    (before middle_end/flambda/unbox_free_vars_of_closures.ml(117):5653-6176
                                                                    (let
                                                                    (new_outer_var =
                                                                    (makeblock 0
                                                                    new_outer_var
                                                                    (makeblock 0
                                                                    projection)))
                                                                    (before middle_end/flambda/unbox_free_vars_of_closures.ml(122):5844-6176
                                                                    (let
                                                                    (additional_free_vars =
                                                                    (after middle_end/flambda/unbox_free_vars_of_closures.ml(123):5889-5974
                                                                    (apply
                                                                    (field 3
                                                                    (field 7
                                                                    (global Variable!)))
                                                                    new_inner_var
                                                                    new_outer_var
                                                                    additional_free_vars)))
                                                                    (before middle_end/flambda/unbox_free_vars_of_closures.ml(126):6010-6176
                                                                    (makeblock 0
                                                                    definitions_indexed_by_new_inner_vars
                                                                    all_existing_definitions_including_added_ones
                                                                    additional_free_vars
                                                                    1a)))))))))))))))))))))
                                            extracted result)))))))))))
                    done_something =a (field 3 *match*)
                    free_vars =a (field 2 *match*)
                    definitions_indexed_by_new_inner_vars =a
                      (field 0 *match*))
                   (before middle_end/flambda/unbox_free_vars_of_closures.ml(134):6249-7377
                     (if (not done_something)
                       (before middle_end/flambda/unbox_free_vars_of_closures.ml(135):6282-6286
                         0a)
                       (before middle_end/flambda/unbox_free_vars_of_closures.ml(139):6421-7377
                         (let
                           (num_free_vars_before =[int]
                              (after middle_end/flambda/unbox_free_vars_of_closures.ml(140):6456-6503
                                (apply
                                  (field 17 (field 7 (global Variable!)))
                                  (field 1 set_of_closures))))
                           (before middle_end/flambda/unbox_free_vars_of_closures.ml(142):6519-7377
                             (let
                               (num_free_vars_after =[int]
                                  (after middle_end/flambda/unbox_free_vars_of_closures.ml(143):6553-6584
                                    (apply
                                      (field 17 (field 7 (global Variable!)))
                                      free_vars)))
                               (before middle_end/flambda/unbox_free_vars_of_closures.ml(145):6600-7377
                                 (seq
                                   (if
                                     (after middle_end/flambda/unbox_free_vars_of_closures.ml(145):6607-6651
                                       (apply
                                         (field 3
                                           (global Int_replace_polymorphic_compare!))
                                         num_free_vars_after
                                         num_free_vars_before))
                                     0a
                                     (raise
                                       (after middle_end/flambda/unbox_free_vars_of_closures.ml(145):6600-6651
                                         (makeblock 0
                                           (global Assert_failure!)
                                           [0:
                                            "middle_end/flambda/unbox_free_vars_of_closures.ml"
                                            145 6]))))
                                   (before middle_end/flambda/unbox_free_vars_of_closures.ml(147):6709-7377
                                     (if
                                       (after middle_end/flambda/unbox_free_vars_of_closures.ml(147):6712-6758
                                         (apply
                                           (field 3
                                             (global Int_replace_polymorphic_compare!))
                                           num_free_vars_after
                                           (* 2 num_free_vars_before)))
                                       (before middle_end/flambda/unbox_free_vars_of_closures.ml(148):6772-6776
                                         0a)
                                       (before middle_end/flambda/unbox_free_vars_of_closures.ml(150):6796-7377
                                         (let
                                           (set_of_closures =
                                              (after middle_end/flambda/unbox_free_vars_of_closures.ml(151):6828-7078
                                                (apply
                                                  (field 23
                                                    (global Flambda!))
                                                  (field 0 set_of_closures)
                                                  free_vars
                                                  (field 2 set_of_closures)
                                                  (field 3 set_of_closures))))
                                           (before middle_end/flambda/unbox_free_vars_of_closures.ml(157):7098-7377
                                             (let
                                               (*match* =
                                                  (after middle_end/flambda/unbox_free_vars_of_closures.ml(158):7128-7337
                                                    (apply
                                                      add_lifted_projections_around_set_of_closures
                                                      set_of_closures
                                                      (field 1
                                                        set_of_closures)
                                                      (field 0
                                                        (field 3
                                                          (global Inlining_cost!)))
                                                      definitions_indexed_by_new_inner_vars))
                                                benefit =a (field 1 *match*)
                                                expr =a (field 0 *match*))
                                               (before middle_end/flambda/unbox_free_vars_of_closures.ml(163):7357-7377
                                                 (makeblock 0
                                                   (makeblock 0 expr benefit)))))))))))))))))))))))
     run =
       (function env set_of_closures
         (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(165)<ghost>:7387-7682
           (before middle_end/flambda/unbox_free_vars_of_closures.ml(166):7413-7682
             (after middle_end/flambda/unbox_free_vars_of_closures.ml(166):7413-7682
               (apply (field 1 (global Pass_wrapper!))
                 (after middle_end/flambda/unbox_free_vars_of_closures.ml(166):7446-7488
                   (apply
                     (field 4 (field 0 (global Inline_and_simplify_aux!)))
                     env))
                 pass_name
                 (function param
                   (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(170):7645-7682
                     (before middle_end/flambda/unbox_free_vars_of_closures.ml(170):7656-7681
                       (after middle_end/flambda/unbox_free_vars_of_closures.ml(170):7656-7681
                         (apply run env set_of_closures)))))
                 set_of_closures (field 36 (global Flambda!))
                 (function ppf param
                   (funct-body middle_end/flambda/unbox_free_vars_of_closures.ml(169):7592-7637
                     (let (expr =a (field 0 param))
                       (before middle_end/flambda/unbox_free_vars_of_closures.ml(169):7614-7636
                         (after middle_end/flambda/unbox_free_vars_of_closures.ml(169):7614-7636
                           (apply (field 26 (global Flambda!)) ppf expr))))))))))))
    (pseudo _none_(0)<ghost>:-1--1 (makeblock 0 run))))
