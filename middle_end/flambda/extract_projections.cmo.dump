(setglobal Extract_projections!
  (let
    (known_valid_projections =
       (function env projections which_variables
         (funct-body middle_end/flambda/extract_projections.ml(34)<ghost>:1790-3607
           (before middle_end/flambda/extract_projections.ml(35):1829-3607
             (after middle_end/flambda/extract_projections.ml(35):1829-3607
               (apply (field 17 (field 12 (global Projection!)))
                 (function projection
                   (funct-body middle_end/flambda/extract_projections.ml(35):1851-3591
                     (before middle_end/flambda/extract_projections.ml(36):1876-3590
                       (let
                         (from =
                            (after middle_end/flambda/extract_projections.ml(36):1887-1924
                              (apply (field 15 (global Projection!))
                                projection)))
                         (before middle_end/flambda/extract_projections.ml(37):1934-3590
                           (let
                             (outer_var =
                                (catch
                                  (try
                                    (exit 1
                                      (after middle_end/flambda/extract_projections.ml(38):1964-2002
                                        (apply
                                          (field 26
                                            (field 7 (global Variable!)))
                                          from which_variables)))
                                   with exn
                                    (if (== exn (field 7 (global Stdlib!)))
                                      (before middle_end/flambda/extract_projections.ml(39):2041-2053
                                        (raise
                                          (after middle_end/flambda/extract_projections.ml(39):2041-2053
                                            (makeblock 0
                                              (global Assert_failure!)
                                              [0:
                                               "middle_end/flambda/extract_projections.ml"
                                               39 33]))))
                                      (reraise exn)))
                                 with (1 outer_var)
                                  (before middle_end/flambda/extract_projections.ml(41):2114-2172
                                    (after middle_end/flambda/extract_projections.ml(41):2114-2172
                                      (apply (field 9 (global Freshening!))
                                        (after middle_end/flambda/extract_projections.ml(41):2140-2158
                                          (apply
                                            (field 24
                                              (field 0
                                                (global Inline_and_simplify_aux!)))
                                            env))
                                        (field 0 outer_var))))))
                             (before middle_end/flambda/extract_projections.ml(43):2188-3590
                               (let
                                 (approx =
                                    (after middle_end/flambda/extract_projections.ml(43):2201-2225
                                      (apply
                                        (field 8
                                          (field 0
                                            (global Inline_and_simplify_aux!)))
                                        env outer_var)))
                                 (before middle_end/flambda/extract_projections.ml(44):2235-3590
                                   (switch* projection
                                    case tag 0:
                                     (let
                                       (project_var =a (field 0 projection))
                                       (before middle_end/flambda/extract_projections.ml(46):2300-2581
                                         (let
                                           (*match* =
                                              (after middle_end/flambda/extract_projections.ml(46):2312-2345
                                                (apply
                                                  (field 62
                                                    (global Simple_value_approx!))
                                                  approx)))
                                           (if *match*
                                             (let
                                               (value_set_of_closures =a
                                                  (field 3 *match*))
                                               (before middle_end/flambda/extract_projections.ml(49):2457-2544
                                                 (after middle_end/flambda/extract_projections.ml(49):2457-2544
                                                   (apply
                                                     (field 2
                                                       (field 7
                                                         (global Var_within_closure!)))
                                                     (field 2 project_var)
                                                     (field 1
                                                       value_set_of_closures)))))
                                             (before middle_end/flambda/extract_projections.ml(51):2564-2569
                                               0a)))))
                                    case tag 1:
                                     (let
                                       (project_closure =a
                                          (field 0 projection))
                                       (before middle_end/flambda/extract_projections.ml(54):2633-2929
                                         (let
                                           (*match* =
                                              (after middle_end/flambda/extract_projections.ml(54):2645-2693
                                                (apply
                                                  (field 60
                                                    (global Simple_value_approx!))
                                                  approx)))
                                           (if *match*
                                             (let
                                               (value_set_of_closures =a
                                                  (field 1 *match*))
                                               (before middle_end/flambda/extract_projections.ml(56):2755-2892
                                                 (after middle_end/flambda/extract_projections.ml(56):2755-2892
                                                   (apply
                                                     (field 2
                                                       (field 6
                                                         (global Variable!)))
                                                     (after middle_end/flambda/extract_projections.ml(56):2772-2818
                                                       (apply
                                                         (field 10
                                                           (global Closure_id!))
                                                         (field 1
                                                           project_closure)))
                                                     (after middle_end/flambda/extract_projections.ml(57):2831-2892
                                                       (apply
                                                         (field 46
                                                           (field 7
                                                             (global Variable!)))
                                                         (field 3
                                                           (field 0
                                                             value_set_of_closures))))))))
                                             (before middle_end/flambda/extract_projections.ml(58):2912-2917
                                               0a)))))
                                    case tag 2:
                                     (let (move =a (field 0 projection))
                                       (before middle_end/flambda/extract_projections.ml(61):2982-3385
                                         (let
                                           (*match* =
                                              (after middle_end/flambda/extract_projections.ml(61):2994-3027
                                                (apply
                                                  (field 62
                                                    (global Simple_value_approx!))
                                                  approx)))
                                           (if *match*
                                             (let
                                               (value_closure =a
                                                  (field 0 *match*))
                                               (before middle_end/flambda/extract_projections.ml(66):3291-3348
                                                 (after middle_end/flambda/extract_projections.ml(66):3291-3348
                                                   (apply
                                                     (field 1
                                                       (global Closure_id!))
                                                     (field 1 value_closure)
                                                     (field 1 move)))))
                                             (before middle_end/flambda/extract_projections.ml(67):3368-3373
                                               0a)))))
                                    case tag 3:
                                     (let
                                       (field_index =a (field 0 projection))
                                       (before middle_end/flambda/extract_projections.ml(70):3428-3590
                                         (let
                                           (*match* =
                                              (after middle_end/flambda/extract_projections.ml(70):3434-3465
                                                (apply
                                                  (field 57
                                                    (global Simple_value_approx!))
                                                  approx)))
                                           (if *match*
                                             (let
                                               (fields =a (field 1 *match*))
                                               (before middle_end/flambda/extract_projections.ml(73):3537-3590
                                                 (&&
                                                   (after middle_end/flambda/extract_projections.ml(73):3537-3553
                                                     (apply
                                                       (field 5
                                                         (global Int_replace_polymorphic_compare!))
                                                       field_index 0))
                                                   (after middle_end/flambda/extract_projections.ml(73):3557-3590
                                                     (apply
                                                       (field 2
                                                         (global Int_replace_polymorphic_compare!))
                                                       field_index
                                                       (array.length[addr]
                                                         fields))))))
                                             (before middle_end/flambda/extract_projections.ml(71):3490-3495
                                               0a)))))))))))))))
                 projections))))))
    (letrec
      (analyse_expr
         (function which_variables expr
           (funct-body middle_end/flambda/extract_projections.ml(76)<ghost>:3630-7481
             (before middle_end/flambda/extract_projections.ml(77):3656-7481
               (let
                 (projections =
                    (makemutable 0 (field 0 (field 12 (global Projection!)))))
                 (before middle_end/flambda/extract_projections.ml(78):3704-7481
                   (let
                     (used_which_variables =
                        (makemutable 0
                          (field 0 (field 6 (global Variable!)))))
                     (before middle_end/flambda/extract_projections.ml(79):3759-7481
                       (let
                         (check_free_variable =
                            (function var
                              (funct-body middle_end/flambda/extract_projections.ml(79)<ghost>:3783-3924
                                (before middle_end/flambda/extract_projections.ml(80):3793-3924
                                  (if
                                    (after middle_end/flambda/extract_projections.ml(80):3796-3832
                                      (apply
                                        (field 2
                                          (field 7 (global Variable!)))
                                        var which_variables))
                                    (before middle_end/flambda/extract_projections.ml(80):3838-3924
                                      (setfield_ptr 0 used_which_variables
                                        (after middle_end/flambda/extract_projections.ml(81):3874-3916
                                          (apply
                                            (field 3
                                              (field 6 (global Variable!)))
                                            var
                                            (field 0 used_which_variables)))))
                                    0a)))))
                         (before middle_end/flambda/extract_projections.ml(84):3932-7481
                           (let
                             (for_expr =
                                (function expr
                                  (funct-body middle_end/flambda/extract_projections.ml(84)<ghost>:3945-4985
                                    (before middle_end/flambda/extract_projections.ml(85):3973-4985
                                      (catch
                                        (catch
                                          (catch
                                            (switch expr
                                             case tag 0:
                                              (let (var =a (field 0 expr))
                                                (exit 10 var))
                                             case tag 2:
                                              (let
                                                (*match* =a (field 0 expr)
                                                 var =a (field 1 *match*))
                                                (exit 10 var))
                                             case tag 4:
                                              (before middle_end/flambda/extract_projections.ml(93):4373-4375
                                                0a)
                                             case tag 5:
                                              (let
                                                (*match* =a (field 0 expr)
                                                 args =a (field 3 *match*)
                                                 obj =a (field 2 *match*)
                                                 meth =a (field 1 *match*))
                                                (before middle_end/flambda/extract_projections.ml(95):4419-4516
                                                  (seq
                                                    (after middle_end/flambda/extract_projections.ml(95):4419-4443
                                                      (apply
                                                        check_free_variable
                                                        meth))
                                                    (before middle_end/flambda/extract_projections.ml(96):4451-4516
                                                      (seq
                                                        (after middle_end/flambda/extract_projections.ml(96):4451-4474
                                                          (apply
                                                            check_free_variable
                                                            obj))
                                                        (before middle_end/flambda/extract_projections.ml(97):4482-4516
                                                          (after middle_end/flambda/extract_projections.ml(97):4482-4516
                                                            (apply
                                                              (field 14
                                                                (global Stdlib__list!))
                                                              check_free_variable
                                                              args))))))))
                                             case tag 6:
                                              (let
                                                (*match* =a (field 0 expr)
                                                 new_value =a
                                                   (field 1 *match*))
                                                (before middle_end/flambda/extract_projections.ml(99):4556-4585
                                                  (after middle_end/flambda/extract_projections.ml(99):4556-4585
                                                    (apply
                                                      check_free_variable
                                                      new_value))))
                                             case tag 7: (exit 13)
                                             case tag 8: (exit 13)
                                             case tag 9: (exit 13)
                                             case tag 10:
                                              (let (args =a (field 1 expr))
                                                (before middle_end/flambda/extract_projections.ml(105):4742-4776
                                                  (after middle_end/flambda/extract_projections.ml(105):4742-4776
                                                    (apply
                                                      (field 14
                                                        (global Stdlib__list!))
                                                      check_free_variable
                                                      args))))
                                             case tag 14:
                                              (let
                                                (*match* =a (field 0 expr)
                                                 to_value =a
                                                   (field 2 *match*)
                                                 from_value =a
                                                   (field 1 *match*))
                                                (before middle_end/flambda/extract_projections.ml(107):4824-4890
                                                  (seq
                                                    (after middle_end/flambda/extract_projections.ml(107):4824-4854
                                                      (apply
                                                        check_free_variable
                                                        from_value))
                                                    (before middle_end/flambda/extract_projections.ml(108):4862-4890
                                                      (after middle_end/flambda/extract_projections.ml(108):4862-4890
                                                        (apply
                                                          check_free_variable
                                                          to_value))))))
                                             default: (exit 12))
                                           with (13)
                                            (let
                                              (var =a (field 0 expr)
                                               var = var)
                                              (before middle_end/flambda/extract_projections.ml(103):4680-4703
                                                (after middle_end/flambda/extract_projections.ml(103):4680-4703
                                                  (apply check_free_variable
                                                    var)))))
                                         with (10 var)
                                          (before middle_end/flambda/extract_projections.ml(88):4054-4077
                                            (after middle_end/flambda/extract_projections.ml(88):4054-4077
                                              (apply check_free_variable var))))
                                       with (12)
                                        (before middle_end/flambda/extract_projections.ml(110):4983-4985
                                          0a))))))
                             (before middle_end/flambda/extract_projections.ml(112):4993-7481
                               (let
                                 (for_named =
                                    (function named
                                      (funct-body middle_end/flambda/extract_projections.ml(112)<ghost>:5007-7291
                                        (before middle_end/flambda/extract_projections.ml(113):5037-7291
                                          (catch
                                            (switch named
                                             case tag 5:
                                              (let
                                                (set_of_closures =a
                                                   (field 0 named))
                                                (before middle_end/flambda/extract_projections.ml(132):5894-7044
                                                  (let
                                                    (aliasing_free_vars =
                                                       (after middle_end/flambda/extract_projections.ml(133):5927-6085
                                                         (apply
                                                           (field 15
                                                             (field 7
                                                               (global Variable!)))
                                                           (function param
                                                             spec_to
                                                             (funct-body middle_end/flambda/extract_projections.ml(133):5947-6049
                                                               (before middle_end/flambda/extract_projections.ml(134):6004-6048
                                                                 (after middle_end/flambda/extract_projections.ml(134):6004-6048
                                                                   (apply
                                                                    (field 2
                                                                    (field 7
                                                                    (global Variable!)))
                                                                    (field 0
                                                                    spec_to)
                                                                    which_variables)))))
                                                           (field 1
                                                             set_of_closures))))
                                                    (before middle_end/flambda/extract_projections.ml(137):6101-7044
                                                      (let
                                                        (aliasing_specialised_args =
                                                           (after middle_end/flambda/extract_projections.ml(138):6141-6306
                                                             (apply
                                                               (field 15
                                                                 (field 7
                                                                   (global Variable!)))
                                                               (function
                                                                 param
                                                                 spec_to
                                                                 (funct-body middle_end/flambda/extract_projections.ml(138):6161-6263
                                                                   (before middle_end/flambda/extract_projections.ml(139):6218-6262
                                                                    (after middle_end/flambda/extract_projections.ml(139):6218-6262
                                                                    (apply
                                                                    (field 2
                                                                    (field 7
                                                                    (global Variable!)))
                                                                    (field 0
                                                                    spec_to)
                                                                    which_variables)))))
                                                               (field 2
                                                                 set_of_closures))))
                                                        (before middle_end/flambda/extract_projections.ml(142):6322-7044
                                                          (let
                                                            (aliasing_vars =
                                                               (after middle_end/flambda/extract_projections.ml(143):6350-6432
                                                                 (apply
                                                                   (field 40
                                                                    (field 7
                                                                    (global Variable!)))
                                                                   0a 0a
                                                                   aliasing_free_vars
                                                                   aliasing_specialised_args)))
                                                            (before middle_end/flambda/extract_projections.ml(146):6448-7044
                                                              (if
                                                                (not
                                                                  (after middle_end/flambda/extract_projections.ml(146):6455-6492
                                                                    (apply
                                                                    (field 1
                                                                    (field 7
                                                                    (global Variable!)))
                                                                    aliasing_vars)))
                                                                (before middle_end/flambda/extract_projections.ml(146):6498-7044
                                                                  (after middle_end/flambda/extract_projections.ml(146):6498-7044
                                                                    (apply
                                                                    (field 11
                                                                    (field 7
                                                                    (global Variable!)))
                                                                    (function
                                                                    param
                                                                    fun_decl
                                                                    (funct-body middle_end/flambda/extract_projections.ml(147):6530-6988
                                                                    (before middle_end/flambda/extract_projections.ml(149):6667-6987
                                                                    (let
                                                                    (*match* =
                                                                    (after middle_end/flambda/extract_projections.ml(150):6693-6750
                                                                    (apply
                                                                    analyse_expr
                                                                    aliasing_vars
                                                                    (field 2
                                                                    fun_decl)))
                                                                    used =a
                                                                    (field 1
                                                                    *match*))
                                                                    (before middle_end/flambda/extract_projections.ml(152):6774-6987
                                                                    (after middle_end/flambda/extract_projections.ml(152):6774-6987
                                                                    (apply
                                                                    (field 13
                                                                    (field 6
                                                                    (global Variable!)))
                                                                    (function
                                                                    var
                                                                    (funct-body middle_end/flambda/extract_projections.ml(152):6792-6970
                                                                    (before middle_end/flambda/extract_projections.ml(153):6816-6969
                                                                    (catch
                                                                    (try
                                                                    (exit 3
                                                                    (after middle_end/flambda/extract_projections.ml(153):6822-6857
                                                                    (apply
                                                                    (field 26
                                                                    (field 7
                                                                    (global Variable!)))
                                                                    var
                                                                    aliasing_vars)))
                                                                    with exn
                                                                    (if
                                                                    (== exn
                                                                    (field 7
                                                                    (global Stdlib!)))
                                                                    (before middle_end/flambda/extract_projections.ml(154):6900-6912
                                                                    (raise
                                                                    (after middle_end/flambda/extract_projections.ml(154):6900-6912
                                                                    (makeblock 0
                                                                    (global Assert_failure!)
                                                                    [0:
                                                                    "middle_end/flambda/extract_projections.ml"
                                                                    154 37]))))
                                                                    (reraise
                                                                    exn)))
                                                                    with (3 spec_to)
                                                                    (before middle_end/flambda/extract_projections.ml(155):6938-6969
                                                                    (after middle_end/flambda/extract_projections.ml(155):6938-6969
                                                                    (apply
                                                                    check_free_variable
                                                                    (field 0
                                                                    spec_to))))))))
                                                                    used)))))))
                                                                    (field 3
                                                                    (field 0
                                                                    set_of_closures)))))
                                                                0a)))))))))
                                             case tag 6:
                                              (let
                                                (project_closure =a
                                                   (field 0 named))
                                                (before middle_end/flambda/extract_projections.ml(119):5291-5365
                                                  (if
                                                    (after middle_end/flambda/extract_projections.ml(119):5291-5365
                                                      (apply
                                                        (field 2
                                                          (field 7
                                                            (global Variable!)))
                                                        (field 0
                                                          project_closure)
                                                        which_variables))
                                                    (before middle_end/flambda/extract_projections.ml(121):5375-5463
                                                      (setfield_ptr 0
                                                        projections
                                                        (after middle_end/flambda/extract_projections.ml(122):5398-5463
                                                          (apply
                                                            (field 3
                                                              (field 12
                                                                (global Projection!)))
                                                            (makeblock 1
                                                              project_closure)
                                                            (field 0
                                                              projections)))))
                                                    (exit 8))))
                                             case tag 7:
                                              (let (move =a (field 0 named))
                                                (before middle_end/flambda/extract_projections.ml(124):5516-5561
                                                  (if
                                                    (after middle_end/flambda/extract_projections.ml(124):5516-5561
                                                      (apply
                                                        (field 2
                                                          (field 7
                                                            (global Variable!)))
                                                        (field 0 move)
                                                        which_variables))
                                                    (before middle_end/flambda/extract_projections.ml(125):5571-5660
                                                      (setfield_ptr 0
                                                        projections
                                                        (after middle_end/flambda/extract_projections.ml(126):5594-5660
                                                          (apply
                                                            (field 3
                                                              (field 12
                                                                (global Projection!)))
                                                            (makeblock 2
                                                              move)
                                                            (field 0
                                                              projections)))))
                                                    (exit 8))))
                                             case tag 8:
                                              (let
                                                (project_var =a
                                                   (field 0 named))
                                                (before middle_end/flambda/extract_projections.ml(115):5097-5149
                                                  (if
                                                    (after middle_end/flambda/extract_projections.ml(115):5097-5149
                                                      (apply
                                                        (field 2
                                                          (field 7
                                                            (global Variable!)))
                                                        (field 0 project_var)
                                                        which_variables))
                                                    (before middle_end/flambda/extract_projections.ml(116):5159-5239
                                                      (setfield_ptr 0
                                                        projections
                                                        (after middle_end/flambda/extract_projections.ml(117):5182-5239
                                                          (apply
                                                            (field 3
                                                              (field 12
                                                                (global Projection!)))
                                                            (makeblock 0
                                                              project_var)
                                                            (field 0
                                                              projections)))))
                                                    (exit 8))))
                                             case tag 9:
                                              (let
                                                (*match* =a (field 0 named))
                                                (catch
                                                  (switch *match*
                                                   case tag 2:
                                                    (let
                                                      (*match* =a
                                                         (field 1 named))
                                                      (if *match*
                                                        (let
                                                          (*match* =a
                                                             (field 1
                                                               *match*))
                                                          (if *match*
                                                            (exit 9)
                                                            (let
                                                              (var =a
                                                                 (field 0
                                                                   *match*)
                                                               field_index =a
                                                                 (field 0
                                                                   *match*))
                                                              (before middle_end/flambda/extract_projections.ml(128):5719-5755
                                                                (if
                                                                  (after middle_end/flambda/extract_projections.ml(128):5719-5755
                                                                    (apply
                                                                    (field 2
                                                                    (field 7
                                                                    (global Variable!)))
                                                                    var
                                                                    which_variables))
                                                                  (before middle_end/flambda/extract_projections.ml(129):5765-5846
                                                                    (setfield_ptr 0
                                                                    projections
                                                                    (after middle_end/flambda/extract_projections.ml(130):5788-5846
                                                                    (apply
                                                                    (field 3
                                                                    (field 12
                                                                    (global Projection!)))
                                                                    (makeblock 3 (int,*)
                                                                    field_index
                                                                    var)
                                                                    (field 0
                                                                    projections)))))
                                                                  (exit 9))))))
                                                        (exit 9)))
                                                   default: (exit 9))
                                                 with (9)
                                                  (let
                                                    (vars =a (field 1 named))
                                                    (before middle_end/flambda/extract_projections.ml(160):7078-7112
                                                      (after middle_end/flambda/extract_projections.ml(160):7078-7112
                                                        (apply
                                                          (field 14
                                                            (global Stdlib__list!))
                                                          check_free_variable
                                                          vars))))))
                                             default: (exit 8))
                                           with (8)
                                            (before middle_end/flambda/extract_projections.ml(164):7289-7291
                                              0a))))))
                                 (before middle_end/flambda/extract_projections.ml(166):7299-7481
                                   (seq
                                     (after middle_end/flambda/extract_projections.ml(166):7299-7354
                                       (apply
                                         (field 7
                                           (global Flambda_iterators!))
                                         for_expr for_named expr))
                                     (before middle_end/flambda/extract_projections.ml(167):7358-7481
                                       (let
                                         (projections = (field 0 projections))
                                         (before middle_end/flambda/extract_projections.ml(168):7394-7481
                                           (let
                                             (used_which_variables =
                                                (field 0
                                                  used_which_variables))
                                             (before middle_end/flambda/extract_projections.ml(169):7448-7481
                                               (makeblock 0 projections
                                                 used_which_variables)))))))))))))))))))))
      (let
        (from_function_decl =
           (function env which_variables function_decl
             (funct-body middle_end/flambda/extract_projections.ml(171)<ghost>:7506-8494
               (before middle_end/flambda/extract_projections.ml(173):7586-8494
                 (let
                   (*match* =
                      (after middle_end/flambda/extract_projections.ml(174):7630-7678
                        (apply analyse_expr which_variables
                          (field 2 function_decl)))
                    used_which_variables =a (field 1 *match*)
                    projections =a (field 0 *match*))
                   (before middle_end/flambda/extract_projections.ml(179):7861-8494
                     (let
                       (projections =
                          (after middle_end/flambda/extract_projections.ml(180):7883-7941
                            (apply known_valid_projections env projections
                              which_variables)))
                       (before middle_end/flambda/extract_projections.ml(187):8302-8494
                         (after middle_end/flambda/extract_projections.ml(187):8302-8494
                           (apply (field 17 (field 12 (global Projection!)))
                             (function projection
                               (funct-body middle_end/flambda/extract_projections.ml(187):8324-8478
                                 (before middle_end/flambda/extract_projections.ml(188):8349-8477
                                   (let
                                     (projecting_from =
                                        (after middle_end/flambda/extract_projections.ml(188):8371-8408
                                          (apply
                                            (field 15 (global Projection!))
                                            projection)))
                                     (before middle_end/flambda/extract_projections.ml(189):8418-8477
                                       (not
                                         (after middle_end/flambda/extract_projections.ml(189):8422-8477
                                           (apply
                                             (field 2
                                               (field 6 (global Variable!)))
                                             projecting_from
                                             used_which_variables))))))))
                             projections))))))))))
        (pseudo _none_(0)<ghost>:-1--1 (makeblock 0 from_function_decl))))))
